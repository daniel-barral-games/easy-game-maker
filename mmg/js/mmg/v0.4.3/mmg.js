var EasyGameMakerLibrary=function(e){var t={};function i(o){if(t[o])return t[o].exports;var n=t[o]={i:o,l:!1,exports:{}};return e[o].call(n.exports,n,n.exports,i),n.l=!0,n.exports}return i.m=e,i.c=t,i.d=function(e,t,o){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(i.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(o,n,function(t){return e[t]}.bind(null,n));return o},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=34)}([function(module,exports,__webpack_require__){"use strict";exports.__esModule=!0;var ObjectSelectorDefinition_1=__webpack_require__(10),ObjectSelectorType_1=__webpack_require__(2),Shape_1=__webpack_require__(17),Color_1=__webpack_require__(1),RenderType_1=__webpack_require__(3),BackgroundType_1=__webpack_require__(5),EventActionType_1=__webpack_require__(6),AudioSourceType_1=__webpack_require__(7),BlockType_1=__webpack_require__(8),Util=function(){function Util(){}return Util.prototype.formatBytes=function(e,t){if(void 0===t&&(t=2),0===e)return"0 Bytes";var i=t<0?0:t,o=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,o)).toFixed(i))+" "+["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][o]},Util.prototype.resizeImage=function(e,t,i,o){var n=this,s=new Image;s.onload=function(){var e=s.naturalWidth,r=s.naturalHeight,a=n.getMiniatureSize(e,r,t,i),l=document.createElement("canvas");l.width=a.width,l.height=a.height,l.getContext("2d").drawImage(s,0,0,a.width,a.height);var u=l.toDataURL("image/png");o(u)},s.src=e},Util.prototype.getMiniatureSize=function(e,t,i,o){return e<=i&&t<=o?{width:e,height:t}:e/i>t/o?{width:i,height:t*(i/e)}:{width:e*(o/t),height:o}},Util.prototype.getKeyCodesByDirection=function(e,t){if("ARROW_KEYS"==t){if("UP"==e)return["ArrowUp"];if("DOWN"==e)return["ArrowDown"];if("LEFT"==e)return["ArrowLeft"];if("RIGHT"==e)return["ArrowRight"]}else if("WASD_KEYS"==t){if("UP"==e)return["KeyW"];if("DOWN"==e)return["KeyS"];if("LEFT"==e)return["KeyA"];if("RIGHT"==e)return["KeyD"]}else if("ARROW_KEYS_OR_WASD_KEYS"==t){if("UP"==e)return["ArrowUp","KeyW"];if("DOWN"==e)return["ArrowDown","KeyS"];if("LEFT"==e)return["ArrowLeft","KeyA"];if("RIGHT"==e)return["ArrowRight","KeyD"]}return null},Util.prototype.listAudios=function(e,t){for(var i=new Set,o=0;o<e.levels.length;o++){var n=e.levels[o];this.listAudiosByVisualScript(n.scriptOnAnimationFrame,t).forEach((function(e){i.add(e)})),this.listAudiosByVisualScript(n.scriptOnLevelStart,t).forEach((function(e){i.add(e)}))}return i},Util.prototype.listAudiosByVisualScript=function(e,t){for(var i=new Set,o=e.blocks,n=0;n<o.length;n++){var s=o[n];this.listAudiosByBlock(s,t).forEach((function(e){i.add(e)}))}return i},Util.prototype.listAudiosByBlock=function(e,t){var i=new Set;if(e.blockType==BlockType_1.default.ACTION){var o=e.actionBlock.action;o.type.code==EventActionType_1.default.PLAY_AUDIO.code&&(o.audio.audioSourceType==AudioSourceType_1.default.UPLOAD&&t==AudioSourceType_1.default.UPLOAD?i.add(o.audio.customAudio.uid):o.audio.audioSourceType==AudioSourceType_1.default.LIBRARY&&t==AudioSourceType_1.default.LIBRARY&&i.add(o.audio.audioPath))}else if(e.blockType==BlockType_1.default.CONDITION)for(var n=e.conditionBlock.ifBlocks,s=0;s<n.length;s++){var r=n[s];this.listAudiosByBlock(r,t).forEach((function(e){i.add(e)}))}else if(e.blockType==BlockType_1.default.LOOP){var a=e.loopBlock.blocks;for(s=0;s<a.length;s++){var l=a[s];this.listAudiosByBlock(l,t).forEach((function(e){i.add(e)}))}}return i},Util.prototype.listImageIds=function(e){for(var t=new Set,i=0;i<e.customObjectTypes.length;i++){var o=e.customObjectTypes[i];o.renderType==RenderType_1.default.IMAGE&&t.add(o.image.imageId)}for(i=0;i<e.levels.length;i++){(n=e.levels[i]).backgroundType==BackgroundType_1.default.IMAGE&&t.add(n.backgroundImage.imageId)}for(i=0;i<e.levels.length;i++){var n=e.levels[i],s=new Array;s.push.apply(s,n.scriptOnAnimationFrame.blocks),s.push.apply(s,n.scriptOnLevelStart.blocks);for(var r=0;r<s.length;r++)for(var a=s[r],l=this.listBlockImageIds(a),u=Array.from(l),c=0;c<u.length;c++)t.add(u[c])}return t},Util.prototype.listBlockImageIds=function(e){var t=new Set;if(e.blockType==BlockType_1.default.ACTION){var i=e.actionBlock.action;(i.type.code==EventActionType_1.default.DRAW_IMAGE.code||i.type.code==EventActionType_1.default.SET_OBJECT_IMAGE.code)&&t.add(i.image.imageId)}else if(e.blockType==BlockType_1.default.CONDITION)for(var o=e.conditionBlock.ifBlocks,n=0;n<o.length;n++){var s=o[n];this.listBlockImageIds(s).forEach((function(e){t.add(e)}))}else if(e.blockType==BlockType_1.default.LOOP)for(o=e.loopBlock.blocks,n=0;n<o.length;n++){s=o[n];this.listBlockImageIds(s).forEach((function(e){t.add(e)}))}return t},Util.prototype.snapToGrid=function(e,t,i){var o=(e-i)%t;return o<0&&(o+=t),o>t/2&&(o-=t),e-o},Util.prototype.getTextLeftX=function(e,t){var i=this.measureText(e,t),o=e.x-i/2;return"left"==e.align?o+=i/2:"right"==e.align&&(o-=i/2),o},Util.prototype.measureText=function(e,t){t.font=e.fontSize+"px "+e.fontFamily;var i=e.text;return t.measureText(i).width},Util.prototype.isInside=function(e,t,i,o,n,s){return!(e<i)&&(!(e>i+n)&&(!(t<o)&&!(t>o+s)))},Util.prototype.isInsideInitialObject=function(e,t,i){if(null==e.objectType)return!1;var o={x:e.x,y:e.y,halfWidth:e.objectType.width/2,halfHeight:e.objectType.height/2},n={x:t,y:i,halfWidth:1,halfHeight:1};return!!this.testCollisionRectangleRectangle(o,n)},Util.prototype.getMousePos=function(e,t,i,o){return this.getTransformedXY(e,t,i,o)},Util.prototype.getTransformedXY=function(e,t,i,o){if(null==e)return{x:t.clientX,y:t.clientY};var n=e.getBoundingClientRect();if(!(null!=window.document.fullscreenElement))return{x:t.clientX-n.left,y:t.clientY-n.top};var s=window.screen.width,r=window.screen.height,a=r/o,l=s/i,u=Math.min(l,a),c=s-i*u,d=r-o*u;return{x:(t.clientX-n.left)/u-c/2/u,y:(t.clientY-n.top)/u-d/2/u}},Util.prototype.drawText=function(e,t,i,o,n,s,r,a){e.font=n,e.fillStyle=s,e.textAlign=r,e.textBaseline=a,e.fillText(t,i,o)},Util.prototype.buildFillStyleFromColor=function(e){return"rgb("+e.red+","+e.green+","+e.blue+","+e.alpha/100+")"},Util.prototype.newColor=function(e,t,i,o){return void 0===o&&(o=100),new Color_1.default(e,t,i,o)},Util.prototype.uid=function(){return this.randomString()},Util.prototype.randomString=function(){return Math.random().toString(36).substr(2)},Util.prototype.arrayMove=function(e,t,i){var o=e[t];i<0||i>e.length-1||(e.splice(t,1),e.splice(i,0,o))},Util.prototype.buildObjectSelector=function(e,t){if(null==e)return null;var i=new ObjectSelectorDefinition_1.default;return i.type=e.type,i.loopVariableName=e.loopVariableName,e.type==ObjectSelectorType_1.default.ALL_OBJECTS_OF_TYPE&&(i.objectType=this.findCustomObjectDefinitionByUid(t,e.objectType.uid)),i},Util.prototype.getLoopVariableNames=function(e){for(var t=new Array,i=e.loops,o=0;o<i.length;o++){var n=i[o];t.push(n.loopVariableName)}return t},Util.prototype.numberOrNull=function(e){return null==e?null:Number(e)},Util.prototype.zeroIfNull=function(e){return null==e?0:e},Util.prototype.oneIfNull=function(e){return null==e?1:e},Util.prototype.isEmpty=function(e){return null==e||""===e},Util.prototype.findEnemyTypeByEnemyTypeId=function(e,t){for(var i=null,o=0;o<e.length;o++)e[o].enemyId==t&&(i=e[o]);return i},Util.prototype.findBonusTypeByBonusTypeId=function(e,t){for(var i=null,o=0;o<e.length;o++)e[o].bonusTypeId==t&&(i=e[o]);return i},Util.prototype.findObstacleTypeByObstacleTypeId=function(e,t){for(var i=null,o=0;o<e.length;o++)e[o].obstacleTypeId==t&&(i=e[o]);return i},Util.prototype.findTypeById=function(e,t){for(var i=null,o=0;o<e.length;o++)e[o].id==t&&(i=e[o]);return i},Util.prototype.findLevelDefinitionByUid=function(e,t){for(var i=null,o=0;o<e.length;o++)e[o].uid==t&&(i=e[o]);return i},Util.prototype.findCustomObjectDefinitionByUid=function(e,t){for(var i=null,o=0;o<e.length;o++)e[o].uid==t&&(i=e[o]);return i},Util.prototype.findElementByUid=function(e,t){for(var i=null,o=0;o<e.length;o++)e[o].uid==t&&(i=e[o]);return i},Util.prototype.stopObject=function(e,t){(e.shape==Shape_1.default.CIRCLE&&t.shape==Shape_1.default.CIRCLE||e.shape==Shape_1.default.RECTANGLE&&t.shape==Shape_1.default.RECTANGLE||e.shape==Shape_1.default.CIRCLE&&t.shape==Shape_1.default.RECTANGLE||e.shape==Shape_1.default.RECTANGLE&&t.shape==Shape_1.default.CIRCLE)&&this.stopRectangleByRectangle(e,t)},Util.prototype.stopRectangleByRectangle=function(e,t){var i=this.absoluteDiff(e.x,t.x-t.halfWidth-e.halfWidth),o=this.absoluteDiff(e.x,t.x+t.halfWidth+e.halfWidth),n=this.absoluteDiff(e.y,t.y-t.halfHeight-e.halfWidth),s=this.absoluteDiff(e.y,t.y+t.halfHeight+e.halfWidth);n<s&&n<o&&n<i?(e.y-=n,e.ySpeed=0):s<o&&s<i?(e.y+=s,e.ySpeed=0):o<i?(e.x+=o,e.xSpeed=0):(e.x-=i,e.xSpeed=0)},Util.prototype.absoluteDiff=function(e,t){return Math.abs(e-t)},Util.prototype.testCollisionObjectLists=function(e,t){for(var i=0;i<e.length;i++)for(var o=0;o<t.length;o++)if(this.testCollision(e[i],t[o]))return!0;return!1},Util.prototype.testCollision=function(e,t){return e.shape==Shape_1.default.CIRCLE&&t.shape==Shape_1.default.RECTANGLE?this.testCollisionCircleRectangle(e,t):e.shape==Shape_1.default.RECTANGLE&&t.shape==Shape_1.default.CIRCLE?this.testCollisionCircleRectangle(t,e):e.shape==Shape_1.default.CIRCLE&&t.shape==Shape_1.default.CIRCLE?this.testCollisionBallBonus(e,t):e.shape==Shape_1.default.RECTANGLE&&t.shape==Shape_1.default.RECTANGLE&&this.testCollisionRectangleRectangle(e,t)},Util.prototype.testCollisionCircleRectangle=function(e,t){return e.y+e.radius>t.y-t.halfHeight&&e.y-e.radius<t.y+t.halfHeight&&e.x+e.radius>t.x-t.halfWidth&&e.x-e.radius<t.x+t.halfWidth},Util.prototype.testCollisionRectangleRectangle=function(e,t){return e.y+e.halfHeight>t.y-t.halfHeight&&e.y-e.halfHeight<t.y+t.halfHeight&&e.x+e.halfWidth>t.x-t.halfWidth&&e.x-e.halfWidth<t.x+t.halfWidth},Util.prototype.testCollisionBallBonus=function(e,t){var i=e.x,o=t.x,n=e.y,s=t.y;return Math.sqrt((o-i)*(o-i)+(s-n)*(s-n))<e.radius+t.radius},Util.prototype.distanceObjects=function(e,t){return this.distance(e.x,e.y,t.x,t.y)},Util.prototype.distance=function(e,t,i,o){return Math.sqrt((i-e)*(i-e)+(o-t)*(o-t))},Util.prototype.randomBetween=function(e,t){return e+Math.random()*(t-e)},Util.prototype.randomIntegerBetween=function(e,t){return Math.floor(Math.random()*t)+e},Util.prototype.readTextFile=function(e){var t=new XMLHttpRequest;t.open("GET",e,!1),t.onreadystatechange=function(){if(4===t.readyState&&(200===t.status||0==t.status)){var e=t.responseText;alert(e)}},t.send(null)},Util.prototype.isInsideObject=function(e,t,i){return null!=e&&(null!=t&&(!(e<i.x-i.halfWidth)&&(!(e>i.x+i.halfWidth)&&(!(t<i.y-i.halfHeight)&&!(t>i.y+i.halfHeight)))))},Util.prototype.getCookie=function(e){for(var t=e+"=",i=decodeURIComponent(document.cookie).split(";"),o=0;o<i.length;o++){for(var n=i[o];" "==n.charAt(0);)n=n.substring(1);if(0==n.indexOf(t))return n.substring(t.length,n.length)}return""},Util.prototype.getObjectsByType=function(e,t){for(var i=new Array,o=0;o<t.level.customObjectArray.length;o++)t.level.customObjectArray[o].type.uid==e&&i.push(t.level.customObjectArray[o]);return i},Util.prototype.checkButtonClick=function(e,t){return!!(t.mouseDownList.length>0&&this.checkMouseOverButton(e,t))},Util.prototype.checkMouseOverButton=function(e,t){if(null!=t.mousePos)for(var i=0;i<t.level.buttonArray.length;i++){var o=t.level.buttonArray[i];if(o.uid==e)return o.isInsideButton(t.mousePos.x,t.mousePos.y)}return!1},Util.prototype.checkButtonTouch=function(e,t){return t.touchStartList.length>0&&this.checkPositionOverButton(e,t,t.lastTouchX,t.lastTouchY)},Util.prototype.checkPositionOverButton=function(e,t,i,o){for(var n=0;n<t.level.buttonArray.length;n++){var s=t.level.buttonArray[n];if(s.uid==e)return s.isInsideButton(i,o)}return!1},Util.prototype.requestCanvasFullscreen=function(){var e=document.getElementById("myCanvas"),t=e;e.requestFullscreen?e.requestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullscreen?t.webkitRequestFullscreen():t.msRequestFullscreen&&t.msRequestFullscreen()},Util.prototype.cloneObject=function(e){var t=this.decycle(e,void 0),i=JSON.stringify(t),o=JSON.parse(i);return this.retrocycle(o)},Util.prototype.decycle=function(e,t){var i=new WeakMap;return function e(o,n){var s,r;return void 0!==t&&(o=t(o)),"object"!=typeof o||null===o||o instanceof Boolean||o instanceof Date||o instanceof Number||o instanceof RegExp||o instanceof String?o:void 0!==(s=i.get(o))?{$ref:s}:(i.set(o,n),Array.isArray(o)?(r=[],o.forEach((function(t,i){r[i]=e(t,n+"["+i+"]")}))):(r={},Object.keys(o).forEach((function(t){r[t]=e(o[t],n+"["+JSON.stringify(t)+"]")}))),r)}(e,"$")},Util.prototype.retrocycle=function($){var px=/^\$(?:\[(?:\d+|"(?:[^\\"\u0000-\u001f]|\\(?:[\\"\/bfnrt]|u[0-9a-zA-Z]{4}))*")\])*$/;return function rez(value){value&&"object"==typeof value&&(Array.isArray(value)?value.forEach((function(element,i){if("object"==typeof element&&null!==element){var path=element.$ref;"string"==typeof path&&px.test(path)?value[i]=eval(path):rez(element)}})):Object.keys(value).forEach((function(name){var item=value[name];if("object"==typeof item&&null!==item){var path=item.$ref;"string"==typeof path&&px.test(path)?value[name]=eval(path):rez(item)}})))}($),$},Util}();exports.default=Util},function(e,t,i){"use strict";t.__esModule=!0;var o=function(){function e(e,t,i,o){void 0===o&&(o=100),this.red=e,this.green=t,this.blue=i,this.alpha=o}return e.BLACK=new e(0,0,0,100),e.WHITE=new e(255,255,255,100),e.RED=new e(255,0,0,100),e.GREEN=new e(0,255,0,100),e.BLUE=new e(0,0,255,100),e}();t.default=o},function(e,t,i){"use strict";var o;t.__esModule=!0,function(e){e.ALL_OBJECTS="ALL_OBJECTS",e.ALL_OBJECTS_OF_TYPE="ALL_OBJECTS_OF_TYPE",e.LOOP_OBJECT="LOOP_OBJECT"}(o||(o={})),t.default=o},function(e,t,i){"use strict";var o;t.__esModule=!0,function(e){e.IMAGE="IMAGE",e.CIRCLE="CIRCLE",e.RECTANGLE="RECTANGLE"}(o||(o={})),t.default=o},function(e,t,i){"use strict";var o;t.__esModule=!0,function(e){e.OBJECT="OBJECT",e.NUMBER="NUMBER",e.REPEAT_X_TIMES="REPEAT_X_TIMES"}(o||(o={})),t.default=o},function(e,t,i){"use strict";var o;t.__esModule=!0,function(e){e.SOLID_COLOR="SOLID_COLOR",e.IMAGE="IMAGE"}(o||(o={})),t.default=o},function(e,t,i){"use strict";t.__esModule=!0;var o=function(){function e(e,t){this.code=e,this.name=t}return e.findByCode=function(e){var t=this[e];if(t)return t;throw new RangeError("Illegal EventActionType code: "+e)},e.EMPTY=new e("EMPTY","Empty"),e.GO_TO_NEXT_LEVEL=new e("GO_TO_NEXT_LEVEL","Go to next level"),e.GO_TO_PREVIOUS_LEVEL=new e("GO_TO_PREVIOUS_LEVEL","Go to previous level"),e.GO_TO_LEVEL=new e("GO_TO_LEVEL","Go to level"),e.RESTART_GAME=new e("RESTART_GAME","Restart game"),e.CREATE_CUSTOM_OBJECT=new e("CREATE_CUSTOM_OBJECT","Create object"),e.CONSOLE_LOG=new e("CONSOLE_LOG","Console log"),e.SET_CAMERA_CENTER_X=new e("SET_CAMERA_CENTER_X","Set camera center X"),e.SET_CAMERA_CENTER_Y=new e("SET_CAMERA_CENTER_Y","Set camera center Y"),e.REQUEST_FULLSCREEN=new e("REQUEST_FULLSCREEN","Request fullscreen"),e.DRAW_LINE=new e("DRAW_LINE","Draw line"),e.DRAW_RECT=new e("DRAW_RECT","Draw rect"),e.DRAW_CIRCLE=new e("DRAW_CIRCLE","Draw circle"),e.DRAW_TEXT=new e("DRAW_TEXT","Draw text"),e.DRAW_IMAGE=new e("DRAW_IMAGE","Draw image"),e.DRAW_PERCENTAGE_BAR=new e("DRAW_PERCENTAGE_BAR","Draw percentage bar"),e.SET_CANVAS_ANGLE=new e("SET_CANVAS_ANGLE","Set canvas angle"),e.SET_CUSTOM_OBJECT_SPEED_AND_ANGLE=new e("SET_CUSTOM_OBJECT_SPEED_AND_ANGLE","Set object speed and angle"),e.SET_OBJECT_SPEED_AND_TARGET=new e("SET_OBJECT_SPEED_AND_TARGET","Set object speed and target"),e.APPLY_FORCE_TO_OBJECT=new e("APPLY_FORCE_TO_OBJECT","Apply force to object"),e.SET_BUTTON_ATTRIBUTE=new e("SET_BUTTON_ATTRIBUTE","Set button attribute"),e.SHOOT_OBJECT=new e("SHOOT_OBJECT","Shoot object"),e.MULTIPLY_ZOOM=new e("MULTIPLY_ZOOM","Multiply zoom"),e.SET_ZOOM=new e("SET_ZOOM","Set zoom"),e.SET_LOCAL_STORAGE_VARIABLE=new e("SET_LOCAL_STORAGE_VARIABLE","Set local storage variable"),e.REMOVE_OBJECT=new e("REMOVE_OBJECT","Remove object"),e.ADD_TO_SCORE=new e("ADD_TO_SCORE","Add to score"),e.SET_SCORE=new e("SET_SCORE","Set score"),e.SET_CUSTOM_OBJECT_ATTRIBUTE=new e("SET_CUSTOM_OBJECT_ATTRIBUTE","Set object attribute"),e.ADD_TO_CUSTOM_OBJECT_ATTRIBUTE=new e("ADD_TO_CUSTOM_OBJECT_ATTRIBUTE","Add to object attribute"),e.SET_OBJECT_VARIABLE=new e("SET_OBJECT_VARIABLE","Set object variable"),e.ADD_TO_OBJECT_VARIABLE=new e("ADD_TO_OBJECT_VARIABLE","Add to object variable"),e.SET_OBJECT_IMAGE_ANGLE=new e("SET_OBJECT_IMAGE_ANGLE","Set object image angle"),e.SET_OBJECT_IMAGE=new e("SET_OBJECT_IMAGE","Set object image"),e.SET_LEVEL_VARIABLE=new e("SET_LEVEL_VARIABLE","Set level variable"),e.ADD_TO_LEVEL_VARIABLE=new e("ADD_TO_LEVEL_VARIABLE","Add to level variable"),e.SET_GLOBAL_VARIABLE=new e("SET_GLOBAL_VARIABLE","Set global variable"),e.ADD_TO_GLOBAL_VARIABLE=new e("ADD_TO_GLOBAL_VARIABLE","Add to global variable"),e.PLAY_AUDIO=new e("PLAY_AUDIO","Play audio"),e.STOP_ALL_AUDIOS=new e("STOP_ALL_AUDIOS","Stop all audios"),e}();t.default=o},function(e,t,i){"use strict";var o;t.__esModule=!0,function(e){e.LIBRARY="LIBRARY",e.UPLOAD="UPLOAD"}(o||(o={})),t.default=o},function(e,t,i){"use strict";var o;t.__esModule=!0,function(e){e.ACTION="ACTION",e.CONDITION="CONDITION",e.LOOP="LOOP",e.COMMENT="COMMENT"}(o||(o={})),t.default=o},function(e,t,i){"use strict";var o;t.__esModule=!0,function(e){e.COLLISION="COLLISION",e.KEYDOWN="KEYDOWN",e.KEYUP="KEYUP",e.EXPRESSION="EXPRESSION",e.ALWAYS="ALWAYS",e.ON_LEVEL_START="ON_LEVEL_START",e.ON_BUTTON_CLICK="ON_BUTTON_CLICK",e.EVERY_X_FRAMES="EVERY_X_FRAMES",e.EVERY_X_SECONDS="EVERY_X_SECONDS",e.DISTANCE_BETWEEN="DISTANCE_BETWEEN",e.MOUSEDOWN="MOUSEDOWN",e.MOUSEUP="MOUSEUP",e.REPEAT_WHILE_MOUSE_IS_DOWN="REPEAT_WHILE_MOUSE_IS_DOWN",e.REPEAT_WHILE_KEY_IS_DOWN="REPEAT_WHILE_KEY_IS_DOWN",e.MOUSE_OVER_OBJECT="MOUSE_OVER_OBJECT",e.MOUSE_OVER_BUTTON="MOUSE_OVER_BUTTON",e.CLICK_ON_OBJECT="CLICK_ON_OBJECT",e.TOUCH_ON_BUTTON="TOUCH_ON_BUTTON",e.TOUCH_ON_OBJECT="TOUCH_ON_OBJECT",e.ON_TOUCH_START="ON_TOUCH_START",e.ON_TOUCH_MOVE="ON_TOUCH_MOVE",e.ON_TOUCH_END="ON_TOUCH_END"}(o||(o={})),t.default=o},function(e,t,i){"use strict";t.__esModule=!0;var o=function(){function e(){}return e.prototype.duplicate=function(){var t=new e;return t.type=this.type,t.objectType=this.objectType,t.loopVariableName=this.loopVariableName,t},e}();t.default=o},function(e,t,i){"use strict";t.__esModule=!0;var o=i(2),n=i(6),s=i(9),r=i(4),a=i(8),l=i(38),u=i(14),c=i(7),d=i(19),h=function(){function e(){this.expressionEvaluatorVisualScripts=new l.default}return e.prototype.generateSourceCode=function(e){return this.generateVisualScriptsSourceCode(e)},e.prototype.generateVisualScriptsSourceCode=function(e){var t="";t+=this.addLine("//Visual scripts - start",0);for(var i=e.levels,o=0;o<i.length;o++){var n=i[o];t+=this.addLine("",0);var s="//Level: "+n.name;t+=this.addLine(s,0);var r='if (play.level.levelDefinition.uid == "'+n.uid+'") {';t+=this.addLine(r,0);var a=n.scriptOnAnimationFrame;t+=this.generateVisualScriptSourceCode(a,e,1);t+=this.addLine("}",0)}return t+=this.addLine("",0),t+=this.addLine("//Visual scripts - end",0)},e.prototype.generateVisualScriptSourceCode=function(e,t,i){var o="",n="//Visual script for level: "+e.level.name;o+=this.addLine(n,i);for(var s=e.blocks,r=0;r<s.length;r++){var a=s[r];o+=this.generateBlockSourceCode(a,t,i)}return o},e.prototype.generateBlockSourceCode=function(e,t,i){var o="";if(o+=this.addLine("",i),e.blockType==a.default.ACTION){var n=e.actionBlock;o+=this.generateActionSourceCode(n,t,i)}else if(e.blockType==a.default.CONDITION){var s=e.conditionBlock;o+=this.generateConditionSourceCode(s,t,i)}else if(e.blockType==a.default.LOOP){var r=e.loopBlock;o+=this.generateLoopSourceCode(r,t,i)}return o},e.prototype.generateLoopSourceCode=function(e,t,i){var n="";n+=this.addLine("{",i),i++;var s=e.loop,a=e.loop.loopVariableName;if(s.type==r.default.OBJECT){if(s.objectSelectorDefinition.type==o.default.ALL_OBJECTS){var l="let objectList_"+a+" = play.level.customObjectArray;";n+=this.addLine(l,i)}else if(s.objectSelectorDefinition.type==o.default.ALL_OBJECTS_OF_TYPE){l="let objectList_"+a+' = play.util.getObjectsByType("'+s.objectSelectorDefinition.objectType.uid+'",play);';n+=this.addLine(l,i)}var u="for (let i_"+a+"=0; i_"+a+"<objectList_"+a+".length;i_"+a+"++) {";n+=this.addLine(u,i);var c="let $"+a+" = objectList_"+a+"[i_"+a+"];";n+=this.addLine(c,i+1)}else if(s.type==r.default.NUMBER){var d=s.from,h=s.to,p=s.increment;l="for (let $"+a+"="+d+"; $"+a+(p>0?"<=":">=")+h+";$"+a+"+="+p+") {";n+=this.addLine(l,i)}else if(s.type==r.default.REPEAT_X_TIMES){l="for (let _num=0; _num<"+s.times+";_num++) {";n+=this.addLine(l,i)}else{l="{";n+=this.addLine(l,i)}for(var f=e.blocks,m=0;m<f.length;m++){var v=f[m];n+=this.generateBlockSourceCode(v,t,i+1)}return n+=this.addLine("}",i),i--,n+=this.addLine("}",i)},e.prototype.generateConditionSourceCode=function(e,t,i){var o="";o+=this.addLine("{",i),i++;var n=e.condition;if(n.type==s.default.KEYDOWN){var r='if (play.onKeyDown("'+n.keyCode+'")) {';o+=this.addLine(r,i)}else if(n.type==s.default.ALWAYS){r="{ //ALWAYS";o+=this.addLine(r,i)}else if(n.type==s.default.KEYUP){r='if (play.onKeyUp("'+n.keyCode+'")) {';o+=this.addLine(r,i)}else if(n.type==s.default.REPEAT_WHILE_KEY_IS_DOWN){r='if (play.isKeyDown("'+n.keyCode+'")) {';o+=this.addLine(r,i)}else if(n.type==s.default.REPEAT_WHILE_MOUSE_IS_DOWN){r="if (play.isLeftMouseButtonDown) {";o+=this.addLine(r,i)}else if(n.type==s.default.EXPRESSION){r="if ("+this.expressionEvaluatorVisualScripts.evaluateExpression(n.expression,t,!1)+") {";o+=this.addLine(r,i)}else if(n.type==s.default.MOUSEDOWN){r="if (play.mouseDownList.length > 0) {";o+=this.addLine(r,i)}else if(n.type==s.default.MOUSEUP){r="if (play.mouseUpList.length > 0) {";o+=this.addLine(r,i)}else if(n.type==s.default.COLLISION){o+=this.generateObjectSelectorSourceCode(n.object1,"objectList1",i),o+=this.generateObjectSelectorSourceCode(n.object2,"objectList2",i);r="if (play.util.testCollisionObjectLists(objectList1, objectList2)) {";o+=this.addLine(r,i)}else if(n.type==s.default.EVERY_X_SECONDS){r='if (play.checkEveryXSeconds("'+n.uid+'", '+n.seconds+")) {";o+=this.addLine(r,i)}else if(n.type==s.default.EVERY_X_FRAMES){r='if (play.checkEveryXFrames("'+n.uid+'", '+n.frames+")) {";o+=this.addLine(r,i)}else if(n.type==s.default.DISTANCE_BETWEEN){var a=this.expressionEvaluatorVisualScripts.evaluateExpression(n.x1,t,!1),l=this.expressionEvaluatorVisualScripts.evaluateExpression(n.y1,t,!1),c=this.expressionEvaluatorVisualScripts.evaluateExpression(n.x2,t,!1),d=this.expressionEvaluatorVisualScripts.evaluateExpression(n.y2,t,!1),h=this.expressionEvaluatorVisualScripts.evaluateExpression(n.distance,t,!1),p=null;n.relation==u.default.EQUAL?p="==":n.relation==u.default.GREATER?p=">":n.relation==u.default.SMALLER?p="<":n.relation==u.default.GREATER_OR_EQUAL?p=">=":n.relation==u.default.SMALLER_OR_EQUAL?p="<=":n.relation==u.default.DIFFERENT&&(p="!=");r="let distance = play.util.distance("+a+","+l+","+c+","+d+");";var f="if (distance "+p+" "+h+") {";o+=this.addLine(r,i),o+=this.addLine(f,i)}else if(n.type==s.default.ON_LEVEL_START){r="if (play.level.currentFrame == 0) {";o+=this.addLine(r,i)}else if(n.type==s.default.ON_BUTTON_CLICK){r='if (play.util.checkButtonClick("'+n.button.uid+'", play)) {';o+=this.addLine(r,i)}else if(n.type==s.default.MOUSE_OVER_BUTTON){r='if (play.util.checkMouseOverButton("'+n.button.uid+'", play)) {';o+=this.addLine(r,i)}else if(n.type==s.default.MOUSE_OVER_OBJECT){r="let isMouseOverObject = false;";o+=this.addLine(r,i);f="if (play.mousePos != null && play.util.isInsideObject(play.mousePos.x, play.mousePos.y, customObject)) isMouseOverObject = true;";o+=this.generateObjectLoopSourceCodeWithBody(n.objectSelectorDefinition,"customObject",i,[f]);var m="if (isMouseOverObject) {";o+=this.addLine(m,i)}else if(n.type==s.default.CLICK_ON_OBJECT){r="let isClickingOnObject = false;";o+=this.addLine(r,i);var v="let isMouseDown = play.mouseDownList.length > 0;";o+=this.addLine(v,i);var y="if (isMouseDown && play.mousePos != null) {";o+=this.addLine(y,i),i++;f="if (play.util.isInsideObject(play.mousePos.x, play.mousePos.y, customObject)) isClickingOnObject = true;";o+=this.generateObjectLoopSourceCodeWithBody(n.objectSelectorDefinition,"customObject",i,[f]),i--,o+=this.addLine("}",i);m="if (isClickingOnObject) {";o+=this.addLine(m,i)}else if(n.type==s.default.ON_TOUCH_START){r="if (play.touchStartList.length > 0) {";o+=this.addLine(r,i)}else if(n.type==s.default.ON_TOUCH_MOVE){r="if (play.touchMoveList.length > 0) {";o+=this.addLine(r,i)}else if(n.type==s.default.ON_TOUCH_END){r="if (play.touchEndList.length > 0) {";o+=this.addLine(r,i)}else if(n.type==s.default.TOUCH_ON_BUTTON){r='if (play.util.checkButtonTouch("'+n.button.uid+'", play)) {';o+=this.addLine(r,i)}else if(n.type==s.default.TOUCH_ON_OBJECT){r="let isClickingOnObject = false;";o+=this.addLine(r,i);v="let hasTouchStart = play.touchStartList.length > 0;";o+=this.addLine(v,i);y="if (hasTouchStart) {";o+=this.addLine(y,i),i++;f="if (play.util.isInsideObject(play.lastTouchX, play.lastTouchY, customObject)) isClickingOnObject = true;";o+=this.generateObjectLoopSourceCodeWithBody(n.objectSelectorDefinition,"customObject",i,[f]),i--,o+=this.addLine("}",i);m="if (isClickingOnObject) {";o+=this.addLine(m,i)}else o+=this.addLine("{",i);for(var E=e.ifBlocks,g=0;g<E.length;g++){var b=E[g];o+=this.generateBlockSourceCode(b,t,i+1)}return o+=this.addLine("}",i),i--,o+=this.addLine("}",i)},e.prototype.generateActionSourceCode=function(e,t,i){var o=this.addLine("{ //event action",i);i++;var s=e.action;if(s.type.code==n.default.GO_TO_NEXT_LEVEL.code){var r="play.goToNextLevel(); return;";o+=this.addLine(r,i)}else if(s.type.code==n.default.GO_TO_PREVIOUS_LEVEL.code){r="play.goToPreviousLevel(); return;";o+=this.addLine(r,i)}else if(s.type.code==n.default.GO_TO_LEVEL.code){r='play.goToLevelUid("'+s.levelDefinition.uid+'"); return;';o+=this.addLine(r,i)}else if(s.type.code==n.default.ADD_TO_SCORE.code){r="play.score += "+(C=this.expressionEvaluatorVisualScripts.evaluateExpression(s.value,t,!1))+";";o+=this.addLine(r,i)}else if(s.type.code==n.default.SET_SCORE.code){r="play.score = "+(C=this.expressionEvaluatorVisualScripts.evaluateExpression(s.value,t,!1))+";";o+=this.addLine(r,i)}else if(s.type.code==n.default.DRAW_TEXT.code){var a=this.expressionEvaluatorVisualScripts.evaluateExpression(s.x,t,!1),l=this.expressionEvaluatorVisualScripts.evaluateExpression(s.y,t,!1),u=null;s.textType==d.default.STATIC_TEXT?u="`"+s.text+"`":s.textType==d.default.EXPRESSION&&(u=this.expressionEvaluatorVisualScripts.evaluateExpression(s.text,t,!0));var h=s.fontFamily,p=this.expressionEvaluatorVisualScripts.evaluateExpression(s.fontSize,t,!1),f=s.textAlign;o+=this.generateColorSourceCode(s.color,"color",t,i);r='play.customElementsToDraw.push({"type":"TEXT", "x":'+a+', "y":'+l+', "text":'+u+', "fontSize":'+p+', "fontFamily":"'+h+'", "color":color, "textAlign":"'+f+'"});';o+=this.addLine(r,i)}else if(s.type.code==n.default.DRAW_LINE.code){var m=this.expressionEvaluatorVisualScripts.evaluateExpression(s.x1,t,!1),v=this.expressionEvaluatorVisualScripts.evaluateExpression(s.y1,t,!1),y=this.expressionEvaluatorVisualScripts.evaluateExpression(s.x2,t,!1),E=this.expressionEvaluatorVisualScripts.evaluateExpression(s.y2,t,!1),g=this.expressionEvaluatorVisualScripts.evaluateExpression(s.lineWidth,t,!1);o+=this.generateColorSourceCode(s.color,"color",t,i);r='play.customElementsToDraw.push({"type":"LINE","x1":'+m+', "y1":'+v+', "x2":'+y+', "y2":'+E+', "lineWidth":'+g+', "color":color});';o+=this.addLine(r,i)}else if(s.type.code==n.default.DRAW_RECT.code){a=this.expressionEvaluatorVisualScripts.evaluateExpression(s.x,t,!1),l=this.expressionEvaluatorVisualScripts.evaluateExpression(s.y,t,!1);var b=this.expressionEvaluatorVisualScripts.evaluateExpression(s.width,t,!1),_=this.expressionEvaluatorVisualScripts.evaluateExpression(s.height,t,!1),T="null";null!=s.borderSize&&(T=this.expressionEvaluatorVisualScripts.evaluateExpression(s.borderSize,t,!1)),o+=this.generateColorSourceCode(s.color,"color",t,i),o+=this.generateColorSourceCode(s.borderColor,"borderColor",t,i);r='play.customElementsToDraw.push({"type":"RECT","x":'+a+', "y":'+l+', "width":'+b+', "height":'+_+', "borderSize":'+T+', "color":color, "borderColor":borderColor, "drawType":"'+s.drawType+'"});';o+=this.addLine(r,i)}else if(s.type.code==n.default.DRAW_CIRCLE.code){a=this.expressionEvaluatorVisualScripts.evaluateExpression(s.x,t,!1),l=this.expressionEvaluatorVisualScripts.evaluateExpression(s.y,t,!1);var O=this.expressionEvaluatorVisualScripts.evaluateExpression(s.radius,t,!1);T="null";null!=s.borderSize&&(T=this.expressionEvaluatorVisualScripts.evaluateExpression(s.borderSize,t,!1)),o+=this.generateColorSourceCode(s.color,"color",t,i),o+=this.generateColorSourceCode(s.borderColor,"borderColor",t,i);r='play.customElementsToDraw.push({"type":"CIRCLE","x":'+a+', "y":'+l+', "radius":'+O+', "borderSize":'+T+', "color":color, "borderColor":borderColor, "drawType":"'+s.drawType+'"});';o+=this.addLine(r,i)}else if(s.type.code==n.default.DRAW_IMAGE.code){r='play.customElementsToDraw.push({"type":"IMAGE", "x":'+(a=this.expressionEvaluatorVisualScripts.evaluateExpression(s.x,t,!1))+', "y":'+(l=this.expressionEvaluatorVisualScripts.evaluateExpression(s.y,t,!1))+', "width":'+(b=this.expressionEvaluatorVisualScripts.evaluateExpression(s.width,t,!1))+', "height":'+(_=this.expressionEvaluatorVisualScripts.evaluateExpression(s.height,t,!1))+', "alpha":'+(A=this.expressionEvaluatorVisualScripts.evaluateExpression(s.alpha,t,!1))+', "rotation":'+this.expressionEvaluatorVisualScripts.evaluateExpression(s.rotation,t,!1)+', "imageId":"'+s.image.imageId+'"});';o+=this.addLine(r,i)}else if(s.type.code==n.default.DRAW_PERCENTAGE_BAR.code){a=this.expressionEvaluatorVisualScripts.evaluateExpression(s.x,t,!1),l=this.expressionEvaluatorVisualScripts.evaluateExpression(s.y,t,!1),b=this.expressionEvaluatorVisualScripts.evaluateExpression(s.width,t,!1),_=this.expressionEvaluatorVisualScripts.evaluateExpression(s.height,t,!1);var A=this.expressionEvaluatorVisualScripts.evaluateExpression(s.alpha,t,!1),C=this.expressionEvaluatorVisualScripts.evaluateExpression(s.value,t,!1),S=this.expressionEvaluatorVisualScripts.evaluateExpression(s.maxValue,t,!1);o+=this.generateColorSourceCode(s.color,"color",t,i),o+=this.generateColorSourceCode(s.backgroundColor,"backgroundColor",t,i),o+=this.generateColorSourceCode(s.borderColor,"borderColor",t,i);var w='play.customElementsToDraw.push({"type":"PERCENTAGE_BAR", "x":'+a+', "y":'+l+', "width":'+b+', "height":'+_+', "alpha":'+A+', "value":'+C+', "maxValue":'+S+', "split":'+s.split+', "borderSize":"'+s.borderSize+'", "color":color, "backgroundColor":backgroundColor, "borderColor":borderColor});';o+=this.addLine(w,i)}else if(s.type.code==n.default.SET_LEVEL_VARIABLE.code){C=this.expressionEvaluatorVisualScripts.evaluateExpression(s.value,t,!1),r='play.level.setVariable("'+(Y=s.levelVariable.name)+'", '+C+");";o+=this.addLine(r,i)}else if(s.type.code==n.default.ADD_TO_LEVEL_VARIABLE.code){C=this.expressionEvaluatorVisualScripts.evaluateExpression(s.value,t,!1),r='play.level.addToVariable("'+(Y=s.levelVariable.name)+'", '+C+");";o+=this.addLine(r,i)}else if(s.type.code==n.default.CREATE_CUSTOM_OBJECT.code){a=this.expressionEvaluatorVisualScripts.evaluateExpression(s.x,t,!1),l=this.expressionEvaluatorVisualScripts.evaluateExpression(s.y,t,!1);var L="let objectType = play.objectTypesMap.get('"+s.customObjectType.uid+"');";o+=this.addLine(L,i);r="let customObject = play.level.addCustomObject(objectType, "+a+", "+l+");";if(o+=this.addLine(r,i),null!=s.speedX&&""!=s.speedX){var x="customObject.speedX = "+this.expressionEvaluatorVisualScripts.evaluateExpression(s.speedX,t,!1)+";";o+=this.addLine(x,i)}if(null!=s.speedY&&""!=s.speedY){x="customObject.speedY = "+this.expressionEvaluatorVisualScripts.evaluateExpression(s.speedY,t,!1)+";";o+=this.addLine(x,i)}}else if(s.type.code==n.default.REMOVE_OBJECT.code){r="customObject.markedToRemove = true;";o+=this.generateObjectLoopSourceCodeWithBody(s.objectSelectorDefinition,"customObject",i,[r])}else if(s.type.code==n.default.SHOOT_OBJECT.code){r="let sourceList = new Array();";o+=this.addLine(r,i);var B=s.customObjectType.uid;if("COORDINATES"==s.sourceType){x='sourceList.push({"customObjectTypeUid":"'+B+'", "x":'+this.expressionEvaluatorVisualScripts.evaluateExpression(s.sourceX,t,!1)+', "y":'+this.expressionEvaluatorVisualScripts.evaluateExpression(s.sourceY,t,!1)+"});";o+=this.addLine(x,i)}else if("MOUSE_POSITION"==s.sourceType){x="if (play.mousePos != null) {";var I='\t\tsourceList.push({ "customObjectTypeUid":"'+B+'", "x":play.mousePos.x + play.screenX, "y":play.mousePos.y + play.screenY });';w="}";o+=this.addLine(x,i),o+=this.addLine(I,i),o+=this.addLine(w,i)}else if("OBJECT"==s.sourceType){x='sourceList.push({"customObjectTypeUid":"'+B+'", "x":customObject.x, "y":customObject.y });';o+=this.generateObjectLoopSourceCodeWithBody(s.sourceObjectSelectorDefinition,"customObject",i,[x])}o+=this.addLine("for (let i_source=0; i_source<sourceList.length; i_source++) {",i),i++;if(o+=this.addLine("let source = sourceList[i_source];",i),"SPEED_X_Y"==s.targetType){var R="let shotObject = play.level.addCustomObject(play.objectTypesMap.get(source.customObjectTypeUid), source.x, source.y);",j="shotObject.speedX = "+this.expressionEvaluatorVisualScripts.evaluateExpression(s.speedX,t,!1)+";",M="shotObject.speedY = "+this.expressionEvaluatorVisualScripts.evaluateExpression(s.speedY,t,!1)+";";o+=this.addLine(R,i),o+=this.addLine(j,i),o+=this.addLine(M,i)}else if("COORDINATES"==s.targetType){R="let dx = "+this.expressionEvaluatorVisualScripts.evaluateExpression(s.targetX,t,!1)+" - source.x;",j="let dy = "+this.expressionEvaluatorVisualScripts.evaluateExpression(s.targetY,t,!1)+" - source.y;",M="let d = play.util.distance(0,0,dx,dy);";var D="let shotObject = play.level.addCustomObject(play.objectTypesMap.get(source.customObjectTypeUid), source.x, source.y);",N="let speed = "+(F=this.expressionEvaluatorVisualScripts.evaluateExpression(s.speed,t,!1))+";",P="shotObject.speedX = speed * dx / d;",V="shotObject.speedY = speed * dy / d;";o+=this.addLine(R,i),o+=this.addLine(j,i),o+=this.addLine(M,i),o+=this.addLine(D,i),o+=this.addLine(N,i),o+=this.addLine(P,i),o+=this.addLine(V,i)}else if("ANGLE"==s.targetType){R="let shotObject = play.level.addCustomObject(play.objectTypesMap.get(source.customObjectTypeUid), source.x, source.y);",j="let angle = "+(G=this.expressionEvaluatorVisualScripts.evaluateExpression(s.angle,t,!1)),M="let speed = "+(F=this.expressionEvaluatorVisualScripts.evaluateExpression(s.speed,t,!1)),D="shotObject.speedX = Math.cos(angle) * speed;",N="shotObject.speedY = -Math.sin(angle) * speed;";o+=this.addLine(R,i),o+=this.addLine(j,i),o+=this.addLine(M,i),o+=this.addLine(D,i),o+=this.addLine(N,i)}else if("MOUSE_POSITION"==s.targetType){R="if (play.mousePos != null) {",j="\tlet targetX = play.mousePos.x;",M="\tlet targetY = play.mousePos.y;",D="\tlet dx = targetX + play.screenX - source.x;",N="\tlet dy = targetY + play.screenY - source.y;",P="\tlet d = play.util.distance(0,0,dx,dy);",V="\tlet shotObject = play.level.addCustomObject(play.objectTypesMap.get(source.customObjectTypeUid), source.x, source.y);";var k="\tlet speed = "+(F=this.expressionEvaluatorVisualScripts.evaluateExpression(s.speed,t,!1))+";";o+=this.addLine(R,i),o+=this.addLine(j,i),o+=this.addLine(M,i),o+=this.addLine(D,i),o+=this.addLine(N,i),o+=this.addLine(P,i),o+=this.addLine(V,i),o+=this.addLine(k,i),o+=this.addLine("\tshotObject.speedX = speed * dx / d;",i),o+=this.addLine("\tshotObject.speedY = speed * dy / d;",i),o+=this.addLine("}",i)}else if("OBJECT"==s.targetType){var U=["let dx = targetObject.x - source.x;",x="let dy = targetObject.y - source.y;",I="let d = play.util.distance(0,0,dx,dy);",w="let shotObject = play.level.addCustomObject(play.objectTypesMap.get(source.customObjectTypeUid), source.x, source.y);",X="let speed = "+(F=this.expressionEvaluatorVisualScripts.evaluateExpression(s.speed,t,!1))+";",W="shotObject.speedX = speed * dx / d;","shotObject.speedY = speed * dy / d;"];o+=this.generateObjectLoopSourceCodeWithBody(s.targetObjectSelectorDefinition,"targetObject",i,U)}i--,o+=this.addLine("}",i)}else if(s.type.code==n.default.SET_CUSTOM_OBJECT_ATTRIBUTE.code){C=this.expressionEvaluatorVisualScripts.evaluateExpression(s.value,t,!1),r="";"x"==s.attribute?r+="customObject.x = "+C+";":"y"==s.attribute?r+="customObject.y = "+C+";":"speedX"==s.attribute?r+="customObject.speedX = "+C+";":"speedY"==s.attribute?r+="customObject.speedY = "+C+";":"width"==s.attribute?r+="customObject.halfWidth = ("+C+")/2;":"height"==s.attribute?r+="customObject.halfHeight = ("+C+")/2;":"alpha"==s.attribute&&(r+="customObject.alpha = "+C+";"),o+=this.generateObjectLoopSourceCodeWithBody(s.objectSelectorDefinition,"customObject",i,[r])}else if(s.type.code==n.default.ADD_TO_CUSTOM_OBJECT_ATTRIBUTE.code){C=this.expressionEvaluatorVisualScripts.evaluateExpression(s.value,t,!1),r="";"x"==s.attribute?r+="customObject.x += "+C+";":"y"==s.attribute?r+="customObject.y += "+C+";":"speedX"==s.attribute?r+="customObject.speedX += "+C+";":"speedY"==s.attribute?r+="customObject.speedY += "+C+";":"width"==s.attribute?r+="customObject.halfWidth += ("+C+")/2;":"height"==s.attribute?r+="customObject.halfHeight += ("+C+")/2;":"alpha"==s.attribute&&(r+="customObject.alpha += "+C+";"),o+=this.generateObjectLoopSourceCodeWithBody(s.objectSelectorDefinition,"customObject",i,[r])}else if(s.type.code==n.default.SET_CUSTOM_OBJECT_SPEED_AND_ANGLE.code){r="customObject.speedX = Math.cos("+(G=this.expressionEvaluatorVisualScripts.evaluateExpression(s.angle,t,!1))+") * "+(F=this.expressionEvaluatorVisualScripts.evaluateExpression(s.speed,t,!1))+";",x="customObject.speedY = -Math.sin("+G+") * "+F+";";o+=this.generateObjectLoopSourceCodeWithBody(s.objectSelectorDefinition,"customObject",i,[r,x])}else if(s.type.code==n.default.SET_OBJECT_SPEED_AND_TARGET.code){var F=this.expressionEvaluatorVisualScripts.evaluateExpression(s.speed,t,!1);U=[r="let dx = "+this.expressionEvaluatorVisualScripts.evaluateExpression(s.targetX,t,!1)+" - customObject.x;",x="let dy = "+this.expressionEvaluatorVisualScripts.evaluateExpression(s.targetY,t,!1)+" - customObject.y;",I="let d = play.util.distance(0,0,dx,dy);",w="customObject.speedX = "+F+" * dx / d;",X="customObject.speedY = "+F+" * dy / d;"];o+=this.generateObjectLoopSourceCodeWithBody(s.objectSelectorDefinition,"customObject",i,U)}else if(s.type.code==n.default.APPLY_FORCE_TO_OBJECT.code){var J=this.expressionEvaluatorVisualScripts.evaluateExpression(s.force,t,!1);if("ANGLE"==s.targetType){r="customObject.speedX += Math.cos("+(G=this.expressionEvaluatorVisualScripts.evaluateExpression(s.angle,t,!1))+") * "+J+";",x="customObject.speedY += -Math.sin("+G+") * "+J+";";o+=this.generateObjectLoopSourceCodeWithBody(s.objectSelectorDefinition,"customObject",i,[r,x])}else if("COORDINATES"==s.targetType){U=[r="let dx = "+this.expressionEvaluatorVisualScripts.evaluateExpression(s.targetX,t,!1)+" - customObject.x;",x="let dy = "+this.expressionEvaluatorVisualScripts.evaluateExpression(s.targetY,t,!1)+" - customObject.y;",I="let d = play.util.distance(0,0,dx,dy);",w="if (d > 0) {",X="\tcustomObject.speedX += "+J+" * dx / d;",W="\tcustomObject.speedY += "+J+" * dy / d;","}"];o+=this.generateObjectLoopSourceCodeWithBody(s.objectSelectorDefinition,"customObject",i,U)}}else if(s.type.code==n.default.SET_OBJECT_IMAGE_ANGLE.code){r="customObject.imageAngle = "+(G=this.expressionEvaluatorVisualScripts.evaluateExpression(s.angle,t,!1))+";";o+=this.generateObjectLoopSourceCodeWithBody(s.objectSelectorDefinition,"customObject",i,[r])}else if(s.type.code==n.default.SET_OBJECT_IMAGE.code){r="customObject.image = play.buildImageObject('"+s.image.imageSourceType+"', '"+s.image.imageId+"');";o+=this.generateObjectLoopSourceCodeWithBody(s.objectSelectorDefinition,"customObject",i,[r])}else if(s.type.code==n.default.SET_OBJECT_VARIABLE.code){C=this.expressionEvaluatorVisualScripts.evaluateExpression(s.value,t,!1),r='customObject.setVariable("'+(Y=s.variable)+'", '+C+");";o+=this.generateObjectLoopSourceCodeWithBody(s.objectSelectorDefinition,"customObject",i,[r])}else if(s.type.code==n.default.ADD_TO_OBJECT_VARIABLE.code){C=this.expressionEvaluatorVisualScripts.evaluateExpression(s.value,t,!1),r='customObject.addToVariable("'+(Y=s.variable)+'", '+C+");";o+=this.generateObjectLoopSourceCodeWithBody(s.objectSelectorDefinition,"customObject",i,[r])}else if(s.type.code==n.default.CONSOLE_LOG.code){C=null;s.textType==d.default.STATIC_TEXT?C="`"+s.expression+"`":s.textType==d.default.EXPRESSION&&(C=this.expressionEvaluatorVisualScripts.evaluateExpression(s.expression,t,!0));r="console.log("+C+");";o+=this.addLine(r,i)}else if(s.type.code==n.default.SET_CAMERA_CENTER_X.code){r="play.setCameraCenterX("+(a=this.expressionEvaluatorVisualScripts.evaluateExpression(s.value,t,!1))+");";o+=this.addLine(r,i)}else if(s.type.code==n.default.SET_CAMERA_CENTER_Y.code){r="play.setCameraCenterY("+(l=this.expressionEvaluatorVisualScripts.evaluateExpression(s.value,t,!1))+");";o+=this.addLine(r,i)}else if(s.type.code==n.default.SET_GLOBAL_VARIABLE.code){C=this.expressionEvaluatorVisualScripts.evaluateExpression(s.value,t,!1),r='play.setGlobalVariable("'+(Y=s.variable)+'", '+C+");";o+=this.addLine(r,i)}else if(s.type.code==n.default.ADD_TO_GLOBAL_VARIABLE.code){C=this.expressionEvaluatorVisualScripts.evaluateExpression(s.value,t,!1),r='play.addToGlobalVariable("'+(Y=s.variable)+'", '+C+");";o+=this.addLine(r,i)}else if(s.type.code==n.default.SET_ZOOM.code){r="play.setZoom("+(C=this.expressionEvaluatorVisualScripts.evaluateExpression(s.value,t,!1))+");";o+=this.addLine(r,i)}else if(s.type.code==n.default.MULTIPLY_ZOOM.code){r="play.muliplyZoom("+(C=this.expressionEvaluatorVisualScripts.evaluateExpression(s.value,t,!1))+");";o+=this.addLine(r,i)}else if(s.type.code==n.default.SET_LOCAL_STORAGE_VARIABLE.code){var Y=null;s.variableTextType==d.default.STATIC_TEXT?Y="`"+s.variable+"`":s.variableTextType==d.default.EXPRESSION&&(Y=this.expressionEvaluatorVisualScripts.evaluateExpression(s.variable,t,!0));C=null;s.valueTextType==d.default.STATIC_TEXT?C="`"+s.value+"`":s.valueTextType==d.default.EXPRESSION&&(C=this.expressionEvaluatorVisualScripts.evaluateExpression(s.value,t,!1));r="localStorage.setItem("+Y+","+C+");";o+=this.addLine(r,i)}else if(s.type.code==n.default.SET_CANVAS_ANGLE.code){var G;r="play.level.canvasAngle="+(G=this.expressionEvaluatorVisualScripts.evaluateExpression(s.angle,t,!1))+";";o+=this.addLine(r,i)}else if(s.type.code==n.default.SET_BUTTON_ATTRIBUTE.code){if("borderSize"==s.attribute||"width"==s.attribute||"height"==s.attribute||"x"==s.attribute||"y"==s.attribute){C=this.expressionEvaluatorVisualScripts.evaluateExpression(s.value,t,!1),r="for (let i=0; i<play.level.buttonArray.length; i++) {",x="\tlet button = play.level.buttonArray[i];",I='\tif (button.uid == "'+s.button.uid+'") {',w="\t\tbutton."+s.attribute+" = "+C+";";var X="\t}",W="}";o+=this.addLine(r,i),o+=this.addLine(x,i),o+=this.addLine(I,i),o+=this.addLine(w,i),o+=this.addLine(X,i),o+=this.addLine(W,i)}else if("backgroundColor"==s.attribute||"borderColor"==s.attribute||"textColor"==s.attribute){o+=this.generateColorSourceCode(s.color,"color",t,i);r="for (let i=0; i<play.level.buttonArray.length; i++) {",x="\tlet button = play.level.buttonArray[i];",I='\tif (button.uid == "'+s.button.uid+'") {',w="\t\tbutton."+s.attribute+" = color;",X="\t}",W="}";o+=this.addLine(r,i),o+=this.addLine(x,i),o+=this.addLine(I,i),o+=this.addLine(w,i),o+=this.addLine(X,i),o+=this.addLine(W,i)}}else if(s.type.code==n.default.REQUEST_FULLSCREEN.code){r="play.util.requestCanvasFullscreen();";o+=this.addLine(r,i)}else if(s.type.code==n.default.PLAY_AUDIO.code){var H=this.expressionEvaluatorVisualScripts.evaluateExpression(s.volume,t,!1);if(s.audio.audioSourceType==c.default.LIBRARY){r='play.playLibraryAudio("'+s.audio.audioPath+'",'+H+");";o+=this.addLine(r,i)}else if(s.audio.audioSourceType==c.default.UPLOAD){r='play.playCustomAudio("'+s.audio.customAudio.uid+'",'+H+");";o+=this.addLine(r,i)}}else if(s.type.code==n.default.STOP_ALL_AUDIOS.code){r="play.stopAllAudios();";o+=this.addLine(r,i)}else if(s.type.code==n.default.RESTART_GAME.code){r="play.restart();";o+=this.addLine(r,i)}return i--,o+=this.addLine("}",i)},e.prototype.generateColorSourceCode=function(e,t,i,o){if(null==e||""==e.red||""==e.green||""==e.blue){var n="let "+t+" = null;";return this.addLine(n,o)}var s="let "+t+" = play.util.newColor("+this.expressionEvaluatorVisualScripts.evaluateExpression(""+e.red,i,!1)+", "+this.expressionEvaluatorVisualScripts.evaluateExpression(""+e.green,i,!1)+", "+this.expressionEvaluatorVisualScripts.evaluateExpression(""+e.blue,i,!1)+");";return this.addLine(s,o)},e.prototype.generateTabs=function(e){for(var t="",i=0;i<e;i++)t+="\t";return t},e.prototype.generateObjectLoopSourceCodeWithBody=function(e,t,i,n){var s="",r=e.type!=o.default.LOOP_OBJECT;if(r)s+=this.generateObjectLoopSourceCode(e,t,i),i++;else{var a="let "+t+" = $"+e.loopVariableName+";";s+=this.addLine(a,i)}for(var l=0;l<n.length;l++)s+=this.addLine(n[l],i);return r&&(i--,s+=this.addLine("}",i)),s},e.prototype.generateObjectLoopSourceCode=function(e,t,i){var o=this.generateObjectSelectorSourceCode(e,"objectList",i);o+=this.addLine("for (var i=0; i<objectList.length; i++) {",i),i++;var n="let "+t+" = objectList[i];";return o+=this.addLine(n,i)},e.prototype.generateObjectSelectorSourceCode=function(e,t,i){var n="";if(e.type==o.default.ALL_OBJECTS_OF_TYPE){var s="let "+t+' = play.util.getObjectsByType("'+e.objectType.uid+'", play);';n+=this.addLine(s,i)}else if(e.type==o.default.ALL_OBJECTS){s="let "+t+" = play.level.customObjectArray;";n+=this.addLine(s,i)}else if(e.type==o.default.LOOP_OBJECT){s="let "+t+" = [$"+e.loopVariableName+"];";n+=this.addLine(s,i)}return n},e.prototype.addLine=function(e,t){var i=this.generateTabs(t);return i+=e,i+="\n"},e}();t.default=h},function(e,t,i){"use strict";t.__esModule=!0;var o=i(0),n=i(17),s=function(){function e(e,t,i,s){this.imageAngle=0,this.shape=n.default.RECTANGLE,this.variables=new Map,this.markedToRemove=!1,this.isObjectOnPlatform=!1,this.isObjectJumping=!1,this.justStartedJumping=!1,this.play=i.play,this.level=i,this.type=s,this.x=e,this.y=t,this.halfWidth=s.width/2,this.halfHeight=s.height/2,this.image=s.image,this.speedX=0,this.speedY=0,this.electricCharge=s.electricCharge,this.mass=s.mass,this.alpha=s.alpha;var r=s.objectVariables;if(null!=r)for(var a=0;a<r.length;a++){var l=r[a];this.variables.set(l.name,l.initialValue)}this.util=new o.default}return e.prototype.hasJustStartedJumping=function(){return this.justStartedJumping},e.prototype.isOnPlatform=function(){return this.isObjectOnPlatform},e.prototype.isJumping=function(){return this.isObjectJumping},e.prototype.update=function(){if(this.justStartedJumping=!1,this.isObjectOnPlatform=!1,this.x+=this.speedX,this.y+=this.speedY,null!=this.type.applyGravity&&1==this.type.applyGravity&&(this.speedY+=this.level.levelDefinition.gravity),null!=this.type.behaviours)for(var e=0;e<this.type.behaviours.length;e++){var t=this.type.behaviours[e];if("KEYBOARD_MOVEMENT"==t.type){var i=0,o=0;"8_DIRECTIONS"==t.keyboardMovementDirections?(this.play.isAnyKeyDown(this.util.getKeyCodesByDirection("RIGHT",t.keyboardMovementKeys))&&(i+=1),this.play.isAnyKeyDown(this.util.getKeyCodesByDirection("LEFT",t.keyboardMovementKeys))&&(i-=1),this.play.isAnyKeyDown(this.util.getKeyCodesByDirection("UP",t.keyboardMovementKeys))&&(o-=1),this.play.isAnyKeyDown(this.util.getKeyCodesByDirection("DOWN",t.keyboardMovementKeys))&&(o+=1)):"LEFT_AND_RIGHT"==t.keyboardMovementDirections?(this.play.isAnyKeyDown(this.util.getKeyCodesByDirection("RIGHT",t.keyboardMovementKeys))&&(i+=1),this.play.isAnyKeyDown(this.util.getKeyCodesByDirection("LEFT",t.keyboardMovementKeys))&&(i-=1)):"UP_AND_DOWN"==t.keyboardMovementDirections&&(this.play.isAnyKeyDown(this.util.getKeyCodesByDirection("UP",t.keyboardMovementKeys))&&(o-=1),this.play.isAnyKeyDown(this.util.getKeyCodesByDirection("DOWN",t.keyboardMovementKeys))&&(o+=1)),"SET_SPEED_ON_KEY_DOWN"==t.keyboardMovementType?("8_DIRECTIONS"!=t.keyboardMovementDirections&&"LEFT_AND_RIGHT"!=t.keyboardMovementDirections||(this.speedX=i*t.speedX),"8_DIRECTIONS"!=t.keyboardMovementDirections&&"UP_AND_DOWN"!=t.keyboardMovementDirections||(this.speedY=o*t.speedY)):"SET_ACCELERATION_ON_KEY_DOWN"==t.keyboardMovementType?("8_DIRECTIONS"!=t.keyboardMovementDirections&&"LEFT_AND_RIGHT"!=t.keyboardMovementDirections||(this.speedX+=i*t.accelerationX),"8_DIRECTIONS"!=t.keyboardMovementDirections&&"UP_AND_DOWN"!=t.keyboardMovementDirections||(this.speedY+=o*t.accelerationY)):t.keyboardMovementType}else if("MOUSE_MOVEMENT"==t.type){if(null!=this.play.mousePos){var n=this.play.mousePos.x-this.x,s=this.play.mousePos.y-this.y;n+=this.play.screenX,s+=this.play.screenY,"SET_SPEED_BY_MOUSE_DISTANCE"==t.mouseMovementType?(this.speedX=t.factorX*n,this.speedY=t.factorY*s):"SET_ACCELERATION_BY_MOUSE_DISTANCE"==t.mouseMovementType?(this.speedX+=t.factorX*n,this.speedY+=t.factorY*s):"SET_POSITION_BY_MOUSE_POSITION"==t.mouseMovementType&&(this.x=t.factorX*this.play.mousePos.x,this.y=t.factorY*this.play.mousePos.y)}}else if("STOP_ON_OBJECT"==t.type||"BOUNCE_ON_OBJECT"==t.type){for(var r=new Array,a=0;a<this.play.level.customObjectArray.length;a++)this.play.level.customObjectArray[a].type.uid==t.objectSelector&&r.push(this.play.level.customObjectArray[a]);for(var l=0;l<r.length;l++){var u=r[l];if(this.util.testCollision(this,u)){var c=null,d=null,h=u.y+u.halfHeight+this.halfHeight,p=u.y-u.halfHeight-this.halfHeight;d=Math.abs(h-this.y)<Math.abs(p-this.y)?h:p;var f=u.x+u.halfWidth+this.halfWidth,m=u.x-u.halfWidth-this.halfWidth;c=Math.abs(f-this.x)<Math.abs(m-this.x)?f:m,Math.abs(c-this.x)<Math.abs(d-this.y)?(this.x=c,"STOP_ON_OBJECT"==t.type?this.speedX=0:"BOUNCE_ON_OBJECT"==t.type&&(this.speedX>0?this.speedX=-t.bounceSpeed:this.speedX=t.bounceSpeed)):(this.y=d,"STOP_ON_OBJECT"==t.type?this.speedY=0:"BOUNCE_ON_OBJECT"==t.type&&(this.speedY>0&&this.y<u.y&&(this.speedY=-t.bounceSpeed),this.speedY<0&&this.y>u.y&&(this.speedY=t.bounceSpeed)))}}}else if("JUMP_ON_PLATFORM"==t.type){r=new Array;for(var v=0;v<this.play.level.customObjectArray.length;v++)this.play.level.customObjectArray[v].type.uid==t.objectSelector&&r.push(this.play.level.customObjectArray[v]);for(var y=new Array,E=0;E<r.length;E++){u=r[E];this.util.testCollision(this,u)&&y.push(u)}for(var g=null,b=0,_=null,T=0,O=0;O<y.length;O++){var A=this.util.distanceObjects(this,y[O]);null==g||A<b?(_=g,T=b,g=y[O],b=A):(null==_||A<T)&&(_=y[O],T=A)}null!=g&&this.processCollisionJumpOnPlatform(g,t),null!=_&&this.processCollisionJumpOnPlatform(_,t)}}},e.prototype.processCollisionJumpOnPlatform=function(e,t){var i=null,o=null,n=e.y+e.halfHeight+this.halfHeight,s=e.y-e.halfHeight-this.halfHeight;o=Math.abs(n-this.y)<Math.abs(s-this.y)?n:s;var r=e.x+e.halfWidth+this.halfWidth,a=e.x-e.halfWidth-this.halfWidth;i=Math.abs(r-this.x)<Math.abs(a-this.x)?r:a,Math.abs(i-this.x)<Math.abs(o-this.y)?(this.x=i,this.speedX=0):(this.y=o,this.speedY>=0&&this.y<e.y?(this.isObjectOnPlatform=!0,this.isObjectJumping=!1,this.speedY=0):this.isObjectOnPlatform=!1,this.speedY<0&&this.y>e.y&&(this.speedY=0),1==this.isObjectOnPlatform&&this.play.isKeyDown(t.jumpKey)&&(this.speedY=-t.jumpSpeed,this.justStartedJumping=!0,this.isObjectJumping=!0))},e.prototype.getVariable=function(e){var t=this.variables.get(e);return null==t?(this.variables.set(e,0),0):t},e.prototype.setVariable=function(e,t){this.variables.set(e,t)},e.prototype.addToVariable=function(e,t){var i=this.variables.get(e);null==i?this.variables.set(e,t):this.variables.set(e,i+t)},e.prototype.drawShape=function(e){e.fillStyle="#000000",e.beginPath(),e.rect(this.x-this.play.screenX-this.halfWidth,this.y-this.play.screenY-this.halfHeight,2*this.halfWidth,2*this.halfHeight),e.closePath(),e.fill()},e}();t.default=s},function(e,t,i){"use strict";var o;t.__esModule=!0,function(e){e.STRING="STRING",e.NUMBER="NUMBER",e.BOOLEAN="BOOLEAN",e.CUSTOM_OBJECT_TYPE="CUSTOM_OBJECT_TYPE",e.ARRAY="ARRAY",e.MATRIX="MATRIX"}(o||(o={})),t.default=o},function(e,t,i){"use strict";var o;t.__esModule=!0,function(e){e.EQUAL="EQUAL",e.GREATER="GREATER",e.SMALLER="SMALLER",e.GREATER_OR_EQUAL="GREATER_OR_EQUAL",e.SMALLER_OR_EQUAL="SMALLER_OR_EQUAL",e.DIFFERENT="DIFFERENT"}(o||(o={})),t.default=o},function(e,t,i){"use strict";t.__esModule=!0;var o=function(){};t.default=o},function(e,t){var i;i=function(){return this}();try{i=i||new Function("return this")()}catch(e){"object"==typeof window&&(i=window)}e.exports=i},function(e,t,i){"use strict";var o;t.__esModule=!0,function(e){e.CIRCLE="CIRCLE",e.RECTANGLE="RECTANGLE"}(o||(o={})),t.default=o},function(e,t,i){"use strict";t.__esModule=!0;var o=function(){this.templateVersion="v0.4.3"};t.default=o},function(e,t,i){"use strict";var o;t.__esModule=!0,function(e){e.STATIC_TEXT="STATIC_TEXT",e.EXPRESSION="EXPRESSION"}(o||(o={})),t.default=o},function(module,exports,__webpack_require__){"use strict";exports.__esModule=!0;var CustomObject_1=__webpack_require__(12),Util_1=__webpack_require__(0),VariableType_1=__webpack_require__(13),ExpressionEvaluator=function(){function ExpressionEvaluator(){this.util=new Util_1.default,this.regexpFps=new RegExp("{fps}","g"),this.regexpScore=new RegExp("{score}","g"),this.regexpRandom=new RegExp("{random}","g"),this.regexpMousePosX=new RegExp("{mousePosX}","g"),this.regexpMousePosY=new RegExp("{mousePosY}","g"),this.regexpScreenX=new RegExp("{screenX}","g"),this.regexpScreenY=new RegExp("{screenY}","g"),this.regexpLoopCurrentIndex=new RegExp("{loop.currentIndex}","g"),this.regexpLevelName=new RegExp("{levelDefinition.name}","g"),this.regexpCurrentLevelFrame=new RegExp("{level.currentFrame}","g"),this.regexLocalStorageVariable=new RegExp("{localStorage.\\w+}"),this.regexDistanceLoopObjects=new RegExp("{distanceLoopObjects\\(\\w+,\\w+\\)}"),this.regexMap=new Map}return ExpressionEvaluator.prototype.findRegexByString=function(e){var t=this.regexMap.get(e);return null==t&&(t=new RegExp(e,"g"),this.regexMap.set(e,t)),t},ExpressionEvaluator.prototype.initObjectVariablesRegexp=function(e){},ExpressionEvaluator.prototype.evaluateExpression=function(expression,play,loopState){if(expression=this.replaceVariables(expression,play,loopState),-1!=expression.indexOf("{"))throw new Error("Invalid expression: "+expression);var result=eval(expression);return result},ExpressionEvaluator.prototype.replaceVariables=function(e,t,i){var o=this;e=(e=(e=e.replace(this.regexpScore,""+t.score)).replace(this.regexpRandom,""+Math.random())).replace(this.regexpFps,""+Math.round(100*t.level.fps)/100);var n=t.level.variables;null!=n&&n.forEach((function(t,i){e=e.replace(o.findRegexByString("{levelVariable."+i+"}"),""+t)}));var s=t.globalVariables;return null!=s&&s.forEach((function(t,i){e=e.replace(o.findRegexByString("{globalVariable."+i+"}"),""+t)})),null!=i&&i.variables.forEach((function(t,i){t instanceof CustomObject_1.default?(e=(e=(e=(e=(e=(e=(e=e.replace(o.findRegexByString("{loopObject.variable."+i+".x}"),""+t.x)).replace(o.findRegexByString("{loopObject.variable."+i+".y}"),""+t.y)).replace(o.findRegexByString("{loopObject.variable."+i+".speedX}"),""+t.speedX)).replace(o.findRegexByString("{loopObject.variable."+i+".speedY}"),""+t.speedY)).replace(o.findRegexByString("{loopObject.variable."+i+".width}"),""+2*t.halfWidth)).replace(o.findRegexByString("{loopObject.variable."+i+".height}"),""+2*t.halfHeight)).replace(o.findRegexByString("{loopObject.variable."+i+".alpha}"),""+t.alpha),t.variables.forEach((function(t,n){e=e.replace(o.findRegexByString("{loopObject.variable."+i+".variable."+n+"}"),""+t)}))):"number"==typeof t&&(e=e.replace(o.findRegexByString("{loopObject.variable."+i+"}"),""+t))})),e=(e=(e=(e=(e=t.mousePos?(e=e.replace(this.regexpMousePosX,""+t.mousePos.x)).replace(this.regexpMousePosY,""+t.mousePos.y):(e=e.replace(this.regexpMousePosX,"0")).replace(this.regexpMousePosY,"0")).replace(this.regexpScreenX,""+t.screenX)).replace(this.regexpScreenY,""+t.screenY)).replace(this.regexpLevelName,""+t.level.levelDefinition.name)).replace(this.regexpCurrentLevelFrame,""+t.level.currentFrame),e=this.replaceLevelArrayVariables(e,t,i),e=this.replaceLocalStorageVariables(e,t,i),e=this.replaceDistanceLoopObjects(e,t,i)},ExpressionEvaluator.prototype.replaceLevelArrayVariables=function(e,t,i){for(var o=t.level.levelDefinition.levelVariables,n=0;n<o.length;n++)if(o[n].type==VariableType_1.default.ARRAY){var s=o[n].name;e=this.replaceLevelArrayVariable(e,t,i,s)}return e},ExpressionEvaluator.prototype.replaceLevelArrayVariable=function(e,t,i,o){for(var n=t.level.variables.get(o),s=new RegExp("{levelVariable."+o+"\\[\\d+\\]}"),r=s.exec(e);r;){var a=new RegExp("\\d+").exec(r[0]),l=parseInt(a[0]);e=e.replace(s,n[l]),r=s.exec(e)}return e},ExpressionEvaluator.prototype.replaceLocalStorageVariables=function(e,t,i){for(var o=this.regexLocalStorageVariable.exec(e);o;){var n=o[0].substring(14,o[0].length-1);e=e.replace(this.regexLocalStorageVariable,localStorage.getItem(n)),o=this.regexLocalStorageVariable.exec(e)}return e},ExpressionEvaluator.prototype.replaceDistanceLoopObjects=function(e,t,i){for(var o=this.regexDistanceLoopObjects.exec(e);o;){var n=o[0].substring(21,o[0].length-2).split(","),s=n[0],r=n[1],a=i.variables.get(s),l=i.variables.get(r),u=0;a instanceof CustomObject_1.default&&l instanceof CustomObject_1.default&&(u=this.util.distanceObjects(a,l)),e=e.replace(this.regexDistanceLoopObjects,"("+u+")"),o=this.regexDistanceLoopObjects.exec(e)}return e},ExpressionEvaluator}();exports.default=ExpressionEvaluator},function(e,t,i){"use strict";var o;t.__esModule=!0,function(e){e.FILL="FILL",e.STROKE="STROKE",e.FILL_AND_STROKE="FILL_AND_STROKE"}(o||(o={})),t.default=o},function(e,t,i){"use strict";t.__esModule=!0;var o=function(){function e(){}return e.prototype.drawRoundRect=function(e,t,i,o,n,s,r,a){if(void 0===a&&(a=!0),void 0===s&&(s=5),"number"==typeof s)s={tl:s,tr:s,br:s,bl:s};else{var l={tl:0,tr:0,br:0,bl:0};for(var u in l)s[u]=s[u]||l[u]}e.beginPath(),e.moveTo(t+s.tl,i),e.lineTo(t+o-s.tr,i),e.quadraticCurveTo(t+o,i,t+o,i+s.tr),e.lineTo(t+o,i+n-s.br),e.quadraticCurveTo(t+o,i+n,t+o-s.br,i+n),e.lineTo(t+s.bl,i+n),e.quadraticCurveTo(t,i+n,t,i+n-s.bl),e.lineTo(t,i+s.tl),e.quadraticCurveTo(t,i,t+s.tl,i),e.closePath(),r&&e.fill(),a&&e.stroke()},e}();t.default=o},function(e,t,i){"use strict";t.__esModule=!0;var o=function(){function e(e,t){this.lastEvaluationFrame=0,this.lastResetFrame=0,this.lastEvaluationResult=!1,this.resetEveryXFrames=e,this.lastResetFrame=t,this.lastEvaluationFrame=t}return e.prototype.updateCounter=function(){},e.prototype.evaluateCondition=function(e){return e==this.lastEvaluationFrame?this.lastEvaluationResult:e-this.lastEvaluationFrame>1?(this.lastResetFrame=e,this.lastEvaluationFrame=e,this.lastEvaluationResult=!1,!1):e-this.lastResetFrame>=this.resetEveryXFrames?(this.lastResetFrame=e,this.lastEvaluationFrame=e,this.lastEvaluationResult=!0,!0):(this.lastEvaluationFrame=e,this.lastEvaluationResult=!1,!1)},e}();t.default=o},function(e,t,i){"use strict";t.__esModule=!0;var o=function(){function e(e,t,i){this.lastEvaluationFrame=0,this.lastEvaluationResult=!1,this.resetEveryXSeconds=e,this.lastResetTime=i,this.lastEvaluationFrame=t}return e.prototype.updateCounter=function(){},e.prototype.evaluateCondition=function(e,t){return e==this.lastEvaluationFrame?this.lastEvaluationResult:e-this.lastEvaluationFrame>1?(this.lastResetTime=t,this.lastEvaluationFrame=e,this.lastEvaluationResult=!1,!1):t-this.lastResetTime>=1e3*this.resetEveryXSeconds?(this.lastResetTime=t,this.lastEvaluationFrame=e,this.lastEvaluationResult=!0,!0):(this.lastEvaluationFrame=e,this.lastEvaluationResult=!1,!1)},e}();t.default=o},function(e,t,i){"use strict";t.__esModule=!0;var o=function(){function e(){}return e.prototype.duplicate=function(){var t=new e;return t.imageSourceType=this.imageSourceType,t.imageId=this.imageId,t.customImage=this.customImage,t},e}();t.default=o},function(e,t,i){"use strict";var o;t.__esModule=!0,function(e){e.LIBRARY="LIBRARY",e.UPLOAD="UPLOAD"}(o||(o={})),t.default=o},function(e,t,i){"use strict";t.__esModule=!0;var o=i(21),n=i(28),s=i(6),r=i(29),a=i(9),l=i(46),u=i(30),c=i(4),d=i(3),h=function(){function e(){}return e.prototype.getKeyboardKeys=function(){return[{code:"ArrowUp",name:"ArrowUp"},{code:"ArrowDown",name:"ArrowDown"},{code:"ArrowLeft",name:"ArrowLeft"},{code:"ArrowRight",name:"ArrowRight"},{code:"Space",name:"Space"},{code:"Enter",name:"Enter"},{code:"ShiftLeft",name:"ShiftLeft"},{code:"ShiftRight",name:"ShiftRight"},{code:"ControlLeft",name:"ControlLeft"},{code:"ControlRight",name:"ControlRight"},{code:"Escape",name:"Escape"},{code:"Backspace",name:"Backspace"},{code:"AltLeft",name:"AltLeft"},{code:"AltRight",name:"AltRight"},{code:"CapsLock",name:"CapsLock"},{code:"Tab",name:"Tab"},{code:"Insert",name:"Insert"},{code:"Delete",name:"Delete"},{code:"Home",name:"Home"},{code:"End",name:"End"},{code:"PageUp",name:"PageUp"},{code:"PageDown",name:"PageDown"},{code:"Digit1",name:"Digit1"},{code:"Digit2",name:"Digit2"},{code:"Digit3",name:"Digit3"},{code:"Digit4",name:"Digit4"},{code:"Digit5",name:"Digit5"},{code:"Digit6",name:"Digit6"},{code:"Digit7",name:"Digit7"},{code:"Digit8",name:"Digit8"},{code:"Digit9",name:"Digit9"},{code:"Digit0",name:"Digit0"},{code:"Numpad1",name:"Numpad1"},{code:"Numpad2",name:"Numpad2"},{code:"Numpad3",name:"Numpad3"},{code:"Numpad4",name:"Numpad4"},{code:"Numpad5",name:"Numpad5"},{code:"Numpad6",name:"Numpad6"},{code:"Numpad7",name:"Numpad7"},{code:"Numpad8",name:"Numpad8"},{code:"Numpad9",name:"Numpad9"},{code:"Numpad0",name:"Numpad0"},{code:"NumLock",name:"NumLock"},{code:"NumpadDivide",name:"NumpadDivide"},{code:"NumpadMultiply",name:"NumpadMultiply"},{code:"NumpadSubtract",name:"NumpadSubtract"},{code:"NumpadAdd",name:"NumpadAdd"},{code:"NumpadEnter",name:"NumpadEnter"},{code:"NumpadDecimal",name:"NumpadDecimal"},{code:"KeyA",name:"KeyA"},{code:"KeyB",name:"KeyB"},{code:"KeyC",name:"KeyC"},{code:"KeyD",name:"KeyD"},{code:"KeyE",name:"KeyE"},{code:"KeyF",name:"KeyF"},{code:"KeyG",name:"KeyG"},{code:"KeyH",name:"KeyH"},{code:"KeyI",name:"KeyI"},{code:"KeyJ",name:"KeyJ"},{code:"KeyK",name:"KeyK"},{code:"KeyL",name:"KeyL"},{code:"KeyM",name:"KeyM"},{code:"KeyN",name:"KeyN"},{code:"KeyO",name:"KeyO"},{code:"KeyP",name:"KeyP"},{code:"KeyQ",name:"KeyQ"},{code:"KeyR",name:"KeyR"},{code:"KeyS",name:"KeyS"},{code:"KeyT",name:"KeyT"},{code:"KeyU",name:"KeyU"},{code:"KeyV",name:"KeyV"},{code:"KeyW",name:"KeyW"},{code:"KeyX",name:"KeyX"},{code:"KeyY",name:"KeyY"},{code:"KeyZ",name:"KeyZ"},{code:"F1",name:"F1"},{code:"F2",name:"F2"},{code:"F3",name:"F3"},{code:"F4",name:"F4"},{code:"F5",name:"F5"},{code:"F6",name:"F6"},{code:"F7",name:"F7"},{code:"F8",name:"F8"},{code:"F9",name:"F9"},{code:"F10",name:"F10"},{code:"F11",name:"F11"},{code:"F12",name:"F12"},{code:"IntlBackslash",name:"IntlBackslash"},{code:"OSLeft",name:"OSLeft"},{code:"Minus",name:"Minus"},{code:"Equal",name:"Equal"},{code:"Backquote",name:"Backquote"},{code:"BracketLeft",name:"BracketLeft"},{code:"BracketRight",name:"BracketRight"},{code:"Semicolon",name:"Semicolon"},{code:"Quote",name:"Quote"},{code:"Backslash",name:"Backslash"},{code:"Comma",name:"Comma"},{code:"Period",name:"Period"},{code:"Slash",name:"Slash"}]},e.prototype.getEventConditionCategories=function(){return[{code:r.default.OBJECTS,name:"Objects"},{code:r.default.TIME,name:"Time"},{code:r.default.KEYBOARD,name:"Keyboard"},{code:r.default.MOUSE,name:"Mouse"},{code:r.default.BUTTON,name:"Button"},{code:r.default.TOUCH,name:"Touch"},{code:r.default.EXPRESSION,name:"Expression"}]},e.prototype.getEventConditionTypesByCategory=function(e){for(var t=this.getEventConditionTypes(),i=new Array,o=0;o<t.length;o++)for(var n=t[o],s=n.categories,r=0;r<s.length;r++)s[r]==e&&i.push(n);return i},e.prototype.getEventActionCategories=function(){return[{code:n.default.GAME},{code:n.default.LEVEL},{code:n.default.OBJECT},{code:n.default.BUTTON},{code:n.default.DRAWING},{code:n.default.AUDIO},{code:n.default.STORAGE},{code:n.default.OTHERS}]},e.prototype.getEventActionTypesByCategory=function(e){for(var t=this.getEventActionTypes(),i=new Array,o=0;o<t.length;o++)t[o].category==e&&i.push(t[o]);return i},e.prototype.getEventActionTypes=function(){return[{code:s.default.GO_TO_NEXT_LEVEL.code,name:s.default.GO_TO_NEXT_LEVEL.name,category:n.default.LEVEL},{code:s.default.GO_TO_PREVIOUS_LEVEL.code,name:s.default.GO_TO_PREVIOUS_LEVEL.name,category:n.default.LEVEL},{code:s.default.GO_TO_LEVEL.code,name:s.default.GO_TO_LEVEL.name,category:n.default.LEVEL},{code:s.default.SET_LEVEL_VARIABLE.code,name:s.default.SET_LEVEL_VARIABLE.name,category:n.default.LEVEL},{code:s.default.ADD_TO_LEVEL_VARIABLE.code,name:s.default.ADD_TO_LEVEL_VARIABLE.name,category:n.default.LEVEL},{code:s.default.SET_CAMERA_CENTER_X.code,name:s.default.SET_CAMERA_CENTER_X.name,category:n.default.LEVEL},{code:s.default.SET_CAMERA_CENTER_Y.code,name:s.default.SET_CAMERA_CENTER_Y.name,category:n.default.LEVEL},{code:s.default.SET_ZOOM.code,name:s.default.SET_ZOOM.name,category:n.default.LEVEL},{code:s.default.MULTIPLY_ZOOM.code,name:s.default.MULTIPLY_ZOOM.name,category:n.default.LEVEL},{code:s.default.SET_CANVAS_ANGLE.code,name:s.default.SET_CANVAS_ANGLE.name,category:n.default.LEVEL},{code:s.default.RESTART_GAME.code,name:s.default.RESTART_GAME.name,category:n.default.GAME},{code:s.default.SET_SCORE.code,name:s.default.SET_SCORE.name,category:n.default.GAME},{code:s.default.ADD_TO_SCORE.code,name:s.default.ADD_TO_SCORE.name,category:n.default.GAME},{code:s.default.SET_GLOBAL_VARIABLE.code,name:s.default.SET_GLOBAL_VARIABLE.name,category:n.default.GAME},{code:s.default.ADD_TO_GLOBAL_VARIABLE.code,name:s.default.ADD_TO_GLOBAL_VARIABLE.name,category:n.default.GAME},{code:s.default.REQUEST_FULLSCREEN.code,name:s.default.REQUEST_FULLSCREEN.name,category:n.default.GAME},{code:s.default.CREATE_CUSTOM_OBJECT.code,name:s.default.CREATE_CUSTOM_OBJECT.name,category:n.default.OBJECT},{code:s.default.SHOOT_OBJECT.code,name:s.default.SHOOT_OBJECT.name,category:n.default.OBJECT},{code:s.default.REMOVE_OBJECT.code,name:s.default.REMOVE_OBJECT.name,category:n.default.OBJECT},{code:s.default.SET_CUSTOM_OBJECT_ATTRIBUTE.code,name:s.default.SET_CUSTOM_OBJECT_ATTRIBUTE.name,category:n.default.OBJECT},{code:s.default.ADD_TO_CUSTOM_OBJECT_ATTRIBUTE.code,name:s.default.ADD_TO_CUSTOM_OBJECT_ATTRIBUTE.name,category:n.default.OBJECT},{code:s.default.SET_CUSTOM_OBJECT_SPEED_AND_ANGLE.code,name:s.default.SET_CUSTOM_OBJECT_SPEED_AND_ANGLE.name,category:n.default.OBJECT},{code:s.default.SET_OBJECT_SPEED_AND_TARGET.code,name:s.default.SET_OBJECT_SPEED_AND_TARGET.name,category:n.default.OBJECT},{code:s.default.APPLY_FORCE_TO_OBJECT.code,name:s.default.APPLY_FORCE_TO_OBJECT.name,category:n.default.OBJECT},{code:s.default.SET_OBJECT_IMAGE_ANGLE.code,name:s.default.SET_OBJECT_IMAGE_ANGLE.name,category:n.default.OBJECT},{code:s.default.SET_OBJECT_IMAGE.code,name:s.default.SET_OBJECT_IMAGE.name,category:n.default.OBJECT},{code:s.default.SET_OBJECT_VARIABLE.code,name:s.default.SET_OBJECT_VARIABLE.name,category:n.default.OBJECT},{code:s.default.ADD_TO_OBJECT_VARIABLE.code,name:s.default.ADD_TO_OBJECT_VARIABLE.name,category:n.default.OBJECT},{code:s.default.SET_BUTTON_ATTRIBUTE.code,name:s.default.SET_BUTTON_ATTRIBUTE.name,category:n.default.BUTTON},{code:s.default.CONSOLE_LOG.code,name:s.default.CONSOLE_LOG.name,category:n.default.OTHERS},{code:s.default.SET_LOCAL_STORAGE_VARIABLE.code,name:s.default.SET_LOCAL_STORAGE_VARIABLE.name,category:n.default.STORAGE},{code:s.default.PLAY_AUDIO.code,name:s.default.PLAY_AUDIO.name,category:n.default.AUDIO},{code:s.default.STOP_ALL_AUDIOS.code,name:s.default.STOP_ALL_AUDIOS.name,category:n.default.AUDIO},{code:s.default.DRAW_LINE.code,name:s.default.DRAW_LINE.name,category:n.default.DRAWING},{code:s.default.DRAW_CIRCLE.code,name:s.default.DRAW_CIRCLE.name,category:n.default.DRAWING},{code:s.default.DRAW_RECT.code,name:s.default.DRAW_RECT.name,category:n.default.DRAWING},{code:s.default.DRAW_IMAGE.code,name:s.default.DRAW_IMAGE.name,category:n.default.DRAWING},{code:s.default.DRAW_TEXT.code,name:s.default.DRAW_TEXT.name,category:n.default.DRAWING},{code:s.default.DRAW_PERCENTAGE_BAR.code,name:s.default.DRAW_PERCENTAGE_BAR.name,category:n.default.DRAWING}]},e.prototype.getEventConditionTypes=function(){return[{code:a.default.COLLISION,name:"Collision",categories:[r.default.OBJECTS]},{code:a.default.KEYDOWN,name:"Keydown",categories:[r.default.KEYBOARD]},{code:a.default.KEYUP,name:"Keyup",categories:[r.default.KEYBOARD]},{code:a.default.REPEAT_WHILE_KEY_IS_DOWN,name:"Is key down",categories:[r.default.KEYBOARD]},{code:a.default.REPEAT_WHILE_MOUSE_IS_DOWN,name:"Is mouse down",categories:[r.default.MOUSE]},{code:a.default.MOUSEDOWN,name:"On mouse down",categories:[r.default.MOUSE]},{code:a.default.MOUSEUP,name:"On mouse up",categories:[r.default.MOUSE]},{code:a.default.ALWAYS,name:"Always",categories:[r.default.TIME]},{code:a.default.EVERY_X_FRAMES,name:"Every X frames",categories:[r.default.TIME]},{code:a.default.EVERY_X_SECONDS,name:"Every X seconds",categories:[r.default.TIME]},{code:a.default.ON_LEVEL_START,name:"On level start",categories:[r.default.TIME]},{code:a.default.ON_BUTTON_CLICK,name:"On button click",categories:[r.default.BUTTON,r.default.MOUSE]},{code:a.default.MOUSE_OVER_BUTTON,name:"Mouse over button",categories:[r.default.BUTTON,r.default.MOUSE]},{code:a.default.CLICK_ON_OBJECT,name:"Click on object",categories:[r.default.MOUSE,r.default.OBJECTS]},{code:a.default.MOUSE_OVER_OBJECT,name:"Mouse over object",categories:[r.default.MOUSE,r.default.OBJECTS]},{code:a.default.ON_TOUCH_START,name:"On touch start",categories:[r.default.TOUCH]},{code:a.default.ON_TOUCH_MOVE,name:"On touch move",categories:[r.default.TOUCH]},{code:a.default.ON_TOUCH_END,name:"On touch end",categories:[r.default.TOUCH]},{code:a.default.TOUCH_ON_BUTTON,name:"Touch on button",categories:[r.default.TOUCH,r.default.BUTTON]},{code:a.default.TOUCH_ON_OBJECT,name:"Touch on object",categories:[r.default.TOUCH,r.default.OBJECTS]},{code:a.default.EXPRESSION,name:"Expression",categories:[r.default.EXPRESSION]},{code:a.default.DISTANCE_BETWEEN,name:"Distance between",categories:[r.default.EXPRESSION]}]},e.prototype.getLoopTypes=function(){return[{code:c.default.OBJECT,name:"Object"},{code:c.default.NUMBER,name:"Number"},{code:c.default.REPEAT_X_TIMES,name:"Repeat X times"}]},e.prototype.getRenderTypes=function(){return[{code:d.default.IMAGE,name:"IMAGE"},{code:d.default.CIRCLE,name:"CIRCLE"},{code:d.default.RECTANGLE,name:"RECTANGLE"}]},e.prototype.getDrawTypes=function(){return[{code:o.default.FILL,name:"FILL"},{code:o.default.STROKE,name:"STROKE"},{code:o.default.FILL_AND_STROKE,name:"FILL_AND_STROKE"}]},e.prototype.getExpressionCategories=function(){return[{code:l.default.OBJECT,name:"Object"},{code:l.default.LEVEL,name:"Level"},{code:l.default.GAME,name:"Game"},{code:l.default.MATH,name:"Math"},{code:l.default.MOUSE,name:"Mouse"},{code:l.default.TOUCH,name:"Touch"},{code:l.default.ACCELEROMETER,name:"Accelerometer"},{code:l.default.OTHERS,name:"Others"}]},e.prototype.getExpressionTypesByCategory=function(e){return this.getExpressionTypes().filter((function(t){return t.category==e}))},e.prototype.getExpressionTypes=function(){return[{code:u.default.SCORE,name:"SCORE",category:l.default.GAME},{code:u.default.RANDOM,name:"Random number between 0 and 1",category:l.default.MATH},{code:u.default.RANDOM_NUMBER_BETWEEN,name:"Random number between...",category:l.default.MATH},{code:u.default.RANDOM_INTEGER_BETWEEN,name:"Random integer between...",category:l.default.MATH},{code:u.default.PI,name:"Pi",category:l.default.MATH},{code:u.default.SIN,name:"Sine",category:l.default.MATH},{code:u.default.COS,name:"Cosine",category:l.default.MATH},{code:u.default.TAN,name:"Tangent",category:l.default.MATH},{code:u.default.SQRT,name:"Square root",category:l.default.MATH},{code:u.default.ABS,name:"Absolute value",category:l.default.MATH},{code:u.default.ROUND,name:"Round",category:l.default.MATH},{code:u.default.CEIL,name:"Round up",category:l.default.MATH},{code:u.default.FLOOR,name:"Round down",category:l.default.MATH},{code:u.default.MIN,name:"Min",category:l.default.MATH},{code:u.default.MAX,name:"Max",category:l.default.MATH},{code:u.default.MOUSE_POS_X,name:"MOUSE_POS_X",category:l.default.MOUSE},{code:u.default.MOUSE_POS_Y,name:"MOUSE_POS_Y",category:l.default.MOUSE},{code:u.default.SCREEN_X,name:"SCREEN_X",category:l.default.LEVEL},{code:u.default.SCREEN_Y,name:"SCREEN_Y",category:l.default.LEVEL},{code:u.default.GLOBAL_VARIABLE,name:"GLOBAL_VARIABLE",category:l.default.GAME},{code:u.default.LEVEL_VARIABLE,name:"LEVEL_VARIABLE",category:l.default.LEVEL},{code:u.default.OBJECT_ATTRIBUTE,name:"OBJECT_ATTRIBUTE",category:l.default.OBJECT},{code:u.default.OBJECT_VARIABLE,name:"OBJECT_VARIABLE",category:l.default.OBJECT},{code:u.default.OBJECT_METHOD,name:"OBJECT_METHOD",category:l.default.OBJECT},{code:u.default.LOOP_NUMBER,name:"LOOP_NUMBER",category:l.default.OTHERS},{code:u.default.LEVEL_NAME,name:"LEVEL_NAME",category:l.default.LEVEL},{code:u.default.CURRENT_LEVEL_FRAME,name:"CURRENT_LEVEL_FRAME",category:l.default.LEVEL},{code:u.default.DISTANCE_BETWEEN_LOOP_OBJECTS,name:"DISTANCE_BETWEEN_LOOP_OBJECTS",category:l.default.OBJECT},{code:u.default.LOCAL_STORAGE_VARIABLE,name:"LOCAL_STORAGE_VARIABLE",category:l.default.GAME},{code:u.default.FPS,name:"FPS",category:l.default.GAME},{code:u.default.LAST_TOUCH_X,name:"LAST_TOUCH_X",category:l.default.TOUCH},{code:u.default.LAST_TOUCH_Y,name:"LAST_TOUCH_Y",category:l.default.TOUCH},{code:u.default.ACCELEROMETER_X,name:"ACCELEROMETER_X",category:l.default.ACCELEROMETER},{code:u.default.ACCELEROMETER_Y,name:"ACCELEROMETER_Y",category:l.default.ACCELEROMETER},{code:u.default.ACCELEROMETER_Z,name:"ACCELEROMETER_Z",category:l.default.ACCELEROMETER}]},e.prototype.getKeyboardMovementDirections=function(){return[{code:"8_DIRECTIONS",name:"8 directions"},{code:"LEFT_AND_RIGHT",name:"Left and right"},{code:"UP_AND_DOWN",name:"Up and down"}]},e.prototype.getKeyboardMovementKeys=function(){return[{code:"ARROW_KEYS",name:"Arrow keys"},{code:"WASD_KEYS",name:"WASD keys"},{code:"ARROW_KEYS_OR_WASD_KEYS",name:"Arrow keys or WASD keys"}]},e}();t.default=h},function(e,t,i){"use strict";var o;t.__esModule=!0,function(e){e.OBJECT="OBJECT",e.LEVEL="LEVEL",e.GAME="GAME",e.STORAGE="STORAGE",e.BUTTON="BUTTON",e.DRAWING="DRAWING",e.AUDIO="AUDIO",e.OTHERS="OTHERS"}(o||(o={})),t.default=o},function(e,t,i){"use strict";var o;t.__esModule=!0,function(e){e.OBJECTS="OBJECTS",e.TIME="TIME",e.KEYBOARD="KEYBOARD",e.MOUSE="MOUSE",e.BUTTON="BUTTON",e.TOUCH="TOUCH",e.EXPRESSION="EXPRESSION"}(o||(o={})),t.default=o},function(e,t,i){"use strict";var o;t.__esModule=!0,function(e){e.SCORE="SCORE",e.RANDOM="RANDOM",e.RANDOM_NUMBER_BETWEEN="RANDOM_NUMBER_BETWEEN",e.RANDOM_INTEGER_BETWEEN="RANDOM_INTEGER_BETWEEN",e.PI="PI",e.SIN="SIN",e.COS="COS",e.TAN="TAN",e.SQRT="SQRT",e.ABS="ABS",e.CEIL="CEIL",e.FLOOR="FLOOR",e.MAX="MAX",e.MIN="MIN",e.ROUND="ROUND",e.MOUSE_POS_X="MOUSE_POS_X",e.MOUSE_POS_Y="MOUSE_POS_Y",e.SCREEN_X="SCREEN_X",e.SCREEN_Y="SCREEN_Y",e.GLOBAL_VARIABLE="GLOBAL_VARIABLE",e.LEVEL_VARIABLE="LEVEL_VARIABLE",e.OBJECT_ATTRIBUTE="OBJECT_ATTRIBUTE",e.OBJECT_VARIABLE="OBJECT_VARIABLE",e.OBJECT_METHOD="OBJECT_METHOD",e.LOOP_NUMBER="LOOP_NUMBER",e.LEVEL_NAME="LEVEL_NAME",e.CURRENT_LEVEL_FRAME="CURRENT_LEVEL_FRAME",e.DISTANCE_BETWEEN_LOOP_OBJECTS="DISTANCE_BETWEEN_LOOP_OBJECTS",e.LOCAL_STORAGE_VARIABLE="LOCAL_STORAGE_VARIABLE",e.FPS="FPS",e.LAST_TOUCH_X="LAST_TOUCH_X",e.LAST_TOUCH_Y="LAST_TOUCH_Y",e.ACCELEROMETER_X="ACCELEROMETER_X",e.ACCELEROMETER_Y="ACCELEROMETER_Y",e.ACCELEROMETER_Z="ACCELEROMETER_Z"}(o||(o={})),t.default=o},function(e,t,i){"use strict";t.__esModule=!0;var o=function(){};t.default=o},function(e,t,i){"use strict";t.__esModule=!0;var o=function(){};t.default=o},function(e,t,i){"use strict";t.__esModule=!0;var o=function(){};t.default=o},function(e,t,i){"use strict";t.__esModule=!0,t.ActionTemplateController=void 0;var o=i(35),n=i(1),s=i(45),r=i(18),a=i(27),l=i(0),u=i(47),c=i(10),d=i(48),h=i(49),p=i(50),f=i(15),m=i(51),v=i(31),y=i(32),E=i(52),g=i(2),b=i(28),_=i(6),T=i(30),O=i(4),A=i(14),C=i(3),S=i(13),w=i(5),L=i(33),x=i(53),B=i(57),I=i(26),R=i(25),j=i(58),M=i(7),D=i(59),N=i(60),P=i(61),V=i(62),k=i(63),U=i(64),F=i(11),J=i(8),Y=i(71),G=i(19),X=i(72),W=function(){function e(e){this.isExported=!1,this.gameSize=0,this.gameSizeFormatted="",this.localStorageGameSize=0,this.localStorageGameSizeFormatted="",this.showDebug=!1,this.customObjectTypeBehaviourController=null,this.editLoopController=new P.default(this),this.gamePropertiesController=new V.default(this),this.visualScriptController=new U.default(this),this.visualScriptsController=new Y.default(this),this.onGameError=null,this.keyup=null,this.keydown=null,this.environment=new r.default,this.util=new l.default,this.genericService=new a.default,this.gameDefinition=null,this.actionTemplate=null,this.sourceCode=null,this.canvas=document.getElementById("myCanvas"),this.ctx=this.canvas.getContext("2d"),this.levelPreviewViewModel=null,this.loading=!1,this.message=null,this.errorMessage=null,this.errorField=null,this.currentTab="GAME_PROPERTIES",this.currentTab2="",this.currentScreen="GAME_PROPERTIES",this.returnScreen="",this.previousLevelTab="PROPERTIES",this.resourcesBaseUrl=null,this.isPlayingGame=!1,this.showObjectSelectorHelp=!1,this.showExpressionHelp=!1,this.hiscores=new Array,this.game=null,this.gameParamsJson=null,this.gameParamsJsonDecycled=null,this.newGameParamsJson=null,this.gameId=null,this.gameName="",this.gameDescription="",this.gameThumbnail="",this.newEventActionTypeCode=_.default.EMPTY.code,this.oldCustomObjectType=null,this.newCustomObjectType=null,this.currentCustomObjectTypeIndex=null,this.currentExpressionField=null,this.expressionCategory=null,this.expressionType=null,this.expressionToInsert=null,this.expressionObjectAttribute=null,this.expressionObjectMethod=null,this.expressionLoopVariableName=null,this.expressionLoopVariableName2=null,this.expressionGlobalVariableName=null,this.expressionLevelVariableName=null,this.expressionLoopObjectVariables=new Array,this.expressionLoopObjectVariable=null,this.expressionLocalStorageVariableName=null,this.expressionMinNumber=null,this.expressionMaxNumber=null,this.expressionParam1=null,this.expressionParam2=null,this.currentEventIndex=null,this.currentEvent=null,this.currentBlock=null,this.currentScript=null,this.oldLevel=null,this.newLevel=null,this.currentLevelIndex=null,this.editingPlayer=null,this.editingPlayerLevelIndex=null,this.newEventCondition=null,this.oldEventCondition=null,this.newEventAction=null,this.oldEventAction=null,this.newCustomText=null,this.oldCustomText=null,this.newCustomObject=null,this.oldCustomObject=null,this.newAttributeToShow=null,this.oldAttributeToShow=null,this.newLevelVariable=null,this.oldLevelVariable=null,this.newLevelText=null,this.oldLevelText=null,this.oldButton=null,this.newButton=null,this.oldEvent=null,this.newEvent=null,this.oldObjectVariable=null,this.newObjectVariable=null,this.oldGlobalVariable=null,this.newGlobalVariable=null,this.oldCustomImage=null,this.newCustomImage=null,this.oldCustomAudio=null,this.newCustomAudio=null,this.objectVariables=new Array,this.currentLocalVariables=new Array,this.buttons=new Array,this.conditionObjectSelectorTypes=[{value:g.default.ALL_OBJECTS_OF_TYPE,name:"Any object of type..."},{value:g.default.LOOP_OBJECT,name:"Loop object..."}],this.actionObjectSelectorTypes=[{value:g.default.ALL_OBJECTS_OF_TYPE,name:"All objects of type..."},{value:g.default.LOOP_OBJECT,name:"Loop object..."}],this.keys=this.genericService.getKeyboardKeys(),this.backgroundTypes=[{code:w.default.IMAGE,name:"Image"},{code:w.default.SOLID_COLOR,name:"Solid color"}],this.renderTypes=this.genericService.getRenderTypes(),this.drawTypes=this.genericService.getDrawTypes(),this.eventActionCategories=this.genericService.getEventActionCategories(),this.eventActionTypes=this.genericService.getEventActionTypes(),this.eventConditionCategories=this.genericService.getEventConditionCategories(),this.eventConditionTypes=this.genericService.getEventConditionTypes(),this.expressionTypes=this.genericService.getExpressionTypes(),this.expressionCategories=this.genericService.getExpressionCategories(),this.relations=[{code:A.default.EQUAL},{code:A.default.GREATER},{code:A.default.SMALLER},{code:A.default.GREATER_OR_EQUAL},{code:A.default.SMALLER_OR_EQUAL},{code:A.default.DIFFERENT}],this.sourceTypes=[{code:"COORDINATES"},{code:"MOUSE_POSITION"},{code:"OBJECT"}],this.targetTypes=[{code:"COORDINATES"},{code:"MOUSE_POSITION"},{code:"SPEED_X_Y"},{code:"ANGLE"},{code:"OBJECT"}],this.forceTargetTypes=[{code:"COORDINATES"},{code:"ANGLE"}],this.customObjectAttributes=[{code:"x"},{code:"y"},{code:"speedX"},{code:"speedY"},{code:"width"},{code:"height"},{code:"alpha"}],this.buttonAttributes=[{code:"x"},{code:"y"},{code:"width"},{code:"height"},{code:"borderSize"},{code:"backgroundColor"},{code:"borderColor"},{code:"textColor"}],this.keyboardMovementDirections=this.genericService.getKeyboardMovementDirections(),this.keyboardMovementKeys=this.genericService.getKeyboardMovementKeys(),this.keyboardMovementTypes=[{code:"SET_SPEED_ON_KEY_DOWN",name:"Set speed on key down"},{code:"SET_ACCELERATION_ON_KEY_DOWN",name:"Set acceleration on key down"},{code:"ADD_POSITION_ON_KEY_DOWN",name:"Add position on key down"}],this.mouseMovementTypes=[{code:"SET_POSITION_BY_MOUSE_POSITION",name:"Set position by mouse position"},{code:"SET_SPEED_BY_MOUSE_DISTANCE",name:"Set speed by mouse distance"},{code:"SET_ACCELERATION_BY_MOUSE_DISTANCE",name:"Set acceleration by mouse distance"}],this.textAlignOptions=[{code:"center"},{code:"left"},{code:"right"}],this.drawTypeOptions=[{code:"FILL"},{code:"STROKE"},{code:"FILL_AND_STROKE"}],this.fontFamilyOptions=[{code:"serif"},{code:"sans-serif"},{code:"cursive"},{code:"fantasy"},{code:"monospace"},{code:"times"},{code:"courier"},{code:"arial"},{code:"Times New Roman"},{code:"Helvetica"},{code:"Arial Black"},{code:"Comic Sans MS"},{code:"Courier New"},{code:"Courier"},{code:"Lucida Console"},{code:"Verdana"}],this.miniaturesImages=new Map,this.customImagesWithMiniatures=new Array,this.objectTypesWithMiniatures=new Array;var t=this;this.customObjectTypeBehaviourController=new N.default(this),this.resourcesBaseUrl=e,this.levelPreviewViewModel=new x.default(this,e),this.refreshSession();var i=function(){try{null!=t.actionTemplate&&t.actionTemplate.loop(),t.levelPreviewViewModel.drawPreview()}catch(e){t.editGame(),t.onGameError(e)}window.requestAnimationFrame(i)};this.canvas.addEventListener("mousemove",(function(e){if(null!=t.actionTemplate){var i=function(e,t){return n(e,t)}(t.canvas,e);t.actionTemplate.mousemove(i)}}),!1),this.canvas.addEventListener("click",(function(e){null!=t.actionTemplate&&t.actionTemplate.click()}),!1),this.canvas.addEventListener("mousedown",(function(e){null!=t.actionTemplate&&t.isPlayingGame&&(t.actionTemplate.mousedown(),e.preventDefault())}),!1),this.canvas.addEventListener("mouseup",(function(e){null!=t.actionTemplate&&t.isPlayingGame&&(t.actionTemplate.mouseup(),e.preventDefault())}),!1);function o(e){for(var i=e.changedTouches,o=0;o<i.length;o++){var s=i[o],r=n(t.canvas,s);t.actionTemplate.play.lastTouchX=r.x,t.actionTemplate.play.lastTouchY=r.y}}function n(e,i){var o=e.getBoundingClientRect();if(!(null!=window.document.fullscreenElement))return{x:i.clientX-o.left,y:i.clientY-o.top};var n=window.screen.width,s=window.screen.height,r=s/t.gameDefinition.canvasHeight,a=n/t.gameDefinition.canvasWidth,l=Math.min(a,r),u=n-t.gameDefinition.canvasWidth*l,c=s-t.gameDefinition.canvasHeight*l;return{x:(i.clientX-o.left)/l-u/2/l,y:(i.clientY-o.top)/l-c/2/l}}window.requestAnimationFrame(i),this.keydown=function(e){null!=t.actionTemplate&&t.isPlayingGame&&(e.preventDefault(),t.actionTemplate.keydown(e))},this.keyup=function(e){null!=t.actionTemplate&&t.isPlayingGame&&(e.preventDefault(),t.actionTemplate.keyup(e))},document.addEventListener("keydown",this.keydown,!1),document.addEventListener("keyup",this.keyup,!1),window.addEventListener("devicemotion",(function(e){var i=e.accelerationIncludingGravity.x,o=e.accelerationIncludingGravity.y,n=e.accelerationIncludingGravity.z;t.actionTemplate.updateAccelerometer(i,o,n)}),!0),this.canvas.addEventListener("touchmove",(function(e){null!=t.actionTemplate&&t.isPlayingGame&&(e.preventDefault(),t.actionTemplate.play.touchMoveList.push(e),o(e))}),!1),this.canvas.addEventListener("touchstart",(function(e){null!=t.actionTemplate&&t.isPlayingGame&&(e.preventDefault(),t.actionTemplate.play.touchStartList.push(e),o(e))}),!1),this.canvas.addEventListener("touchend",(function(e){null!=t.actionTemplate&&t.isPlayingGame&&(e.preventDefault(),t.actionTemplate.play.touchEndList.push(e),o(e))}),!1),null==this.gameId&&this.startNewGame()}return e.prototype.updateObjectTypesWithMiniatures=function(){this.objectTypesWithMiniatures=new Array;for(var e=this.gameParamsJson.customObjectTypes,t=0;t<e.length;t++){var i=e[t],o=new B.default;i.image.imageSourceType==I.default.UPLOAD?(o.uid=i.image.customImage.uid,o.imageData=i.image.customImage.imageData):i.image.imageSourceType==I.default.LIBRARY&&(o.uid=i.image.imageId,o.imageData="");var n=this.getMiniatureImage(o);this.objectTypesWithMiniatures.push({objectType:i,miniatureImage:n})}},e.prototype.updateCustomImagesWithMiniatures=function(){this.customImagesWithMiniatures=new Array;for(var e=this.gameParamsJson.customImages,t=0;t<e.length;t++){var i=e[t],o=this.getMiniatureImage(i);this.customImagesWithMiniatures.push({customImage:i,miniatureImage:o})}},e.prototype.getMiniatureImage=function(e){var t=this.miniaturesImages.get(e.uid);if(null!=t);else{(t=new B.default).uid=this.util.uid(),t.imageData="",this.miniaturesImages.set(e.uid,t);this.util.resizeImage(e.imageData,128,128,(function(e){t.imageData=e}))}return t},e.prototype.updateGameUpdatedDate=function(){var e=(new Date).toISOString();this.gameParamsJson.updatedAt=e,null==this.gameParamsJson.createdAt&&(this.gameParamsJson.createdAt=e)},e.prototype.setGameSize=function(e){this.gameSize=e,this.gameSizeFormatted=this.util.formatBytes(e)},e.prototype.updateGameSize=function(){var e=this.buildJsonDecycled(0);this.setGameSize(e.length)},e.prototype.saveJsonToLocalStorage=function(){this.updateGameUpdatedDate();if(this.gameSize<5242880){var e=this.buildJsonDecycled(0);this.setGameSize(e.length),localStorage.setItem("gameJSON",e)}},e.prototype.getGameDefinitionFromLocalStorage=function(){var e=localStorage.getItem("gameJSON");return this.localStorageGameSize=e.length,this.localStorageGameSizeFormatted=this.util.formatBytes(this.localStorageGameSize),this.util.retrocycle(JSON.parse(e))},e.prototype.loadJsonFromLocalStorage=function(){var e=localStorage.getItem("gameJSON");null!=e&&(this.loadGameDecycled(e),this.updateCustomImagesWithMiniatures(),this.updateObjectTypesWithMiniatures(),this.setGameSize(e.length))},e.prototype.clearJsonFromLocalStorage=function(){localStorage.removeItem("gameJSON")},e.prototype.openAudioSelection=function(e){this.setCurrentScreen("AUDIO_SELECTION"),this.returnScreen=e},e.prototype.closeAudioSelection=function(){this.setCurrentScreen(this.returnScreen)},e.prototype.selectLibraryAudio=function(e){var t=new j.default;t.audioSourceType=M.default.LIBRARY,t.audioPath=e,"EDIT_EVENT_ACTION"==this.returnScreen&&(this.newEventAction.audio=t),this.closeAudioSelection()},e.prototype.selectUploadedAudio=function(e){var t=new j.default;t.audioSourceType=M.default.UPLOAD,t.customAudio=this.util.findElementByUid(this.gameParamsJson.customAudios,e),"EDIT_EVENT_ACTION"==this.returnScreen&&(this.newEventAction.audio=t),this.closeAudioSelection()},e.prototype.openImageSelection=function(e){this.setCurrentScreen("IMAGE_SELECTION"),this.returnScreen=e},e.prototype.selectCustomImage=function(e){var t=new R.default;t.imageSourceType=I.default.UPLOAD,t.imageId="custom:"+e,t.customImage=this.util.findElementByUid(this.gameParamsJson.customImages,e),"CUSTOM_OBJECT_TYPE_PROPERTIES"==this.returnScreen?this.newCustomObjectType.image=t:"PROPERTIES"==this.returnScreen?this.newLevel.backgroundImage=t:"EDIT_EVENT_ACTION"==this.returnScreen&&(this.newEventAction.image=t),this.closeImageSelection()},e.prototype.selectImage=function(e){var t=new R.default;t.imageSourceType=I.default.LIBRARY,t.imageId=e,"CUSTOM_OBJECT_TYPE_PROPERTIES"==this.returnScreen?this.newCustomObjectType.image=t:"PROPERTIES"==this.returnScreen?this.newLevel.backgroundImage=t:"EDIT_EVENT_ACTION"==this.returnScreen&&(this.newEventAction.image=t),this.closeImageSelection()},e.prototype.closeImageSelection=function(){this.setCurrentScreen(this.returnScreen)},e.prototype.openObjectTypeSelection=function(e){this.setCurrentScreen("OBJECT_TYPE_SELECTION"),this.returnScreen=e},e.prototype.selectObjectType=function(e){"EDIT_CUSTOM_OBJECT"==this.returnScreen&&(this.newCustomObject.objectType=this.util.findElementByUid(this.gameParamsJson.customObjectTypes,e)),this.closeImageSelection()},e.prototype.closeObjectTypeSelection=function(){this.setCurrentScreen(this.returnScreen)},e.prototype.filterEventConditionTypes=function(){this.eventConditionTypes=this.genericService.getEventConditionTypesByCategory(this.newEventCondition.category)},e.prototype.clearEventConditionType=function(){this.newEventCondition.type=null},e.prototype.filterEventActionTypes=function(){this.eventActionTypes=this.genericService.getEventActionTypesByCategory(this.newEventAction.category)},e.prototype.clearEventActionType=function(){this.newEventAction.type=_.default.EMPTY,this.newEventActionTypeCode=_.default.EMPTY.code},e.prototype.updateEventActionType=function(){null!=this.newEventActionTypeCode&&(this.newEventAction.type=_.default.findByCode(this.newEventActionTypeCode),this.newEventAction.value=null)},e.prototype.toggleObjectSelectorHelp=function(){this.showObjectSelectorHelp=!this.showObjectSelectorHelp},e.prototype.toggleExpressionHelp=function(){this.showExpressionHelp=!this.showExpressionHelp},e.prototype.openExpressionHelp=function(e){this.expressionCategory=null,this.showExpressionHelp=!0,this.clearExpressionHelpForm(),this.currentExpressionField=e},e.prototype.closeExpressionHelp=function(){this.showExpressionHelp=!1},e.prototype.filterExpressionTypes=function(){this.expressionTypes=this.genericService.getExpressionTypesByCategory(this.expressionCategory)},e.prototype.updateExpressionToInsert=function(){var e=this.expressionType,t=null;if(e==T.default.SCORE)t="play.score";else if(e==T.default.RANDOM)t="Math.random()";else if(e==T.default.RANDOM_NUMBER_BETWEEN){var i=this.expressionMinNumber,o=this.expressionMaxNumber;t="0"==i?"Math.random() * "+o:"Math.random() * ("+o+" - "+i+") + "+i}else if(e==T.default.RANDOM_INTEGER_BETWEEN){i=this.expressionMinNumber,o=this.expressionMaxNumber;t="0"==i?"Math.floor(Math.random() * "+o+")":"Math.floor(Math.random() * ("+o+" - "+i+") + "+i+")"}else e==T.default.FPS?t="play.getFPS()":e==T.default.MOUSE_POS_X?t="play.getMouseX()":e==T.default.MOUSE_POS_Y?t="play.getMouseY()":e==T.default.SCREEN_X?t="play.screenX":e==T.default.SCREEN_Y?t="play.screenY":e==T.default.GLOBAL_VARIABLE?t='play.getGlobalVariable("'+this.expressionGlobalVariableName+'")':e==T.default.LEVEL_VARIABLE?t='play.getLevelVariable("'+this.expressionLevelVariableName+'")':e==T.default.OBJECT_ATTRIBUTE?t="$"+this.expressionLoopVariableName+"."+this.expressionObjectAttribute:e==T.default.OBJECT_METHOD?"JUST_STARTED_JUMPING"==this.expressionObjectMethod?t="$"+this.expressionLoopVariableName+".hasJustStartedJumping()":"IS_ON_PLATFORM"==this.expressionObjectMethod?t="$"+this.expressionLoopVariableName+".isOnPlatform()":"IS_JUMPING"==this.expressionObjectMethod&&(t="$"+this.expressionLoopVariableName+".isJumping()"):e==T.default.OBJECT_VARIABLE?t="$"+this.expressionLoopVariableName+'.getVariable("'+this.expressionLoopObjectVariable+'")':e==T.default.LOOP_NUMBER?t="$"+this.expressionLoopVariableName:e==T.default.LEVEL_NAME?t="play.getCurrentLevel().getName()":e==T.default.CURRENT_LEVEL_FRAME?t="play.getCurrentLevel().getCurrentFrame()":e==T.default.LOCAL_STORAGE_VARIABLE?t='localStorage.getItem("'+this.expressionLocalStorageVariableName+'")':e==T.default.DISTANCE_BETWEEN_LOOP_OBJECTS?t="play.util.distanceObjects($"+this.expressionLoopVariableName+", $"+this.expressionLoopVariableName2+")":e==T.default.ACCELEROMETER_X?t="play.accelerometer.x":e==T.default.ACCELEROMETER_Y?t="play.accelerometer.y":e==T.default.ACCELEROMETER_Z?t="play.accelerometer.z":e==T.default.LAST_TOUCH_X?t="play.lastTouchX":e==T.default.LAST_TOUCH_Y?t="play.lastTouchY":e==T.default.PI?t="Math.PI":e==T.default.SIN?t="Math.sin("+this.expressionParam1+")":e==T.default.COS?t="Math.cos("+this.expressionParam1+")":e==T.default.TAN?t="Math.tan("+this.expressionParam1+")":e==T.default.SQRT?t="Math.sqrt("+this.expressionParam1+")":e==T.default.ABS?t="Math.abs("+this.expressionParam1+")":e==T.default.CEIL?t="Math.ceil("+this.expressionParam1+")":e==T.default.FLOOR?t="Math.floor("+this.expressionParam1+")":e==T.default.MAX?t="Math.max("+this.expressionParam1+","+this.expressionParam2+")":e==T.default.MIN?t="Math.min("+this.expressionParam1+","+this.expressionParam2+")":e==T.default.ROUND&&(t="Math.round("+this.expressionParam1+")");this.expressionToInsert=t},e.prototype.insertExpression=function(){var e=this.expressionToInsert;"newEventCondition.expression"==this.currentExpressionField?(null==this.newEventCondition.expression&&(this.newEventCondition.expression=""),this.newEventCondition.expression+=e):"newEventCondition.x1"==this.currentExpressionField?(null==this.newEventCondition.x1&&(this.newEventCondition.x1=""),this.newEventCondition.x1+=e):"newEventCondition.x2"==this.currentExpressionField?(null==this.newEventCondition.x2&&(this.newEventCondition.x2=""),this.newEventCondition.x2+=e):"newEventCondition.y1"==this.currentExpressionField?(null==this.newEventCondition.y1&&(this.newEventCondition.y1=""),this.newEventCondition.y1+=e):"newEventCondition.y2"==this.currentExpressionField?(null==this.newEventCondition.y2&&(this.newEventCondition.y2=""),this.newEventCondition.y2+=e):"newEventCondition.distance"==this.currentExpressionField?(null==this.newEventCondition.distance&&(this.newEventCondition.distance=""),this.newEventCondition.distance+=e):"newEventAction.x"==this.currentExpressionField?(null==this.newEventAction.x&&(this.newEventAction.x=""),this.newEventAction.x+=e):"newEventAction.y"==this.currentExpressionField?(null==this.newEventAction.y&&(this.newEventAction.y=""),this.newEventAction.y+=e):"newEventAction.speedX"==this.currentExpressionField?(null==this.newEventAction.speedX&&(this.newEventAction.speedX=""),this.newEventAction.speedX+=e):"newEventAction.speedY"==this.currentExpressionField?(null==this.newEventAction.speedY&&(this.newEventAction.speedY=""),this.newEventAction.speedY+=e):"newEventAction.value"==this.currentExpressionField?(null==this.newEventAction.value&&(this.newEventAction.value=""),this.newEventAction.value+=e):"newEventAction.speed"==this.currentExpressionField?(null==this.newEventAction.speed&&(this.newEventAction.speed=""),this.newEventAction.speed+=e):"newEventAction.angle"==this.currentExpressionField?(null==this.newEventAction.angle&&(this.newEventAction.angle=""),this.newEventAction.angle+=e):"newEventAction.force"==this.currentExpressionField?(null==this.newEventAction.force&&(this.newEventAction.force=""),this.newEventAction.force+=e):"newEventAction.sourceX"==this.currentExpressionField?(null==this.newEventAction.sourceX&&(this.newEventAction.sourceX=""),this.newEventAction.sourceX+=e):"newEventAction.sourceY"==this.currentExpressionField?(null==this.newEventAction.sourceY&&(this.newEventAction.sourceY=""),this.newEventAction.sourceY+=e):"newEventAction.targetX"==this.currentExpressionField?(null==this.newEventAction.targetX&&(this.newEventAction.targetX=""),this.newEventAction.targetX+=e):"newEventAction.targetY"==this.currentExpressionField?(null==this.newEventAction.targetY&&(this.newEventAction.targetY=""),this.newEventAction.targetY+=e):"newEventAction.variable"==this.currentExpressionField?(null==this.newEventAction.variable&&(this.newEventAction.variable=""),this.newEventAction.variable+=e):"newEventAction.expression"==this.currentExpressionField?(null==this.newEventAction.expression&&(this.newEventAction.expression=""),this.newEventAction.expression+=e):"newEventAction.lineWidth"==this.currentExpressionField?(null==this.newEventAction.lineWidth&&(this.newEventAction.lineWidth=""),this.newEventAction.lineWidth+=e):"newEventAction.x1"==this.currentExpressionField?(null==this.newEventAction.x1&&(this.newEventAction.x1=""),this.newEventAction.x1+=e):"newEventAction.y1"==this.currentExpressionField?(null==this.newEventAction.y1&&(this.newEventAction.y1=""),this.newEventAction.y1+=e):"newEventAction.x2"==this.currentExpressionField?(null==this.newEventAction.x2&&(this.newEventAction.x2=""),this.newEventAction.x2+=e):"newEventAction.y2"==this.currentExpressionField?(null==this.newEventAction.y2&&(this.newEventAction.y2=""),this.newEventAction.y2+=e):"newEventAction.radius"==this.currentExpressionField?(null==this.newEventAction.radius&&(this.newEventAction.radius=""),this.newEventAction.radius+=e):"newEventAction.width"==this.currentExpressionField?(null==this.newEventAction.width&&(this.newEventAction.width=""),this.newEventAction.width+=e):"newEventAction.height"==this.currentExpressionField?(null==this.newEventAction.height&&(this.newEventAction.height=""),this.newEventAction.height+=e):"newEventAction.alpha"==this.currentExpressionField?(null==this.newEventAction.alpha&&(this.newEventAction.alpha=""),this.newEventAction.alpha+=e):"newEventAction.rotation"==this.currentExpressionField?(null==this.newEventAction.rotation&&(this.newEventAction.rotation=""),this.newEventAction.rotation+=e):"newEventAction.text"==this.currentExpressionField?(null==this.newEventAction.text&&(this.newEventAction.text=""),this.newEventAction.text+=e):"newEventAction.maxValue"==this.currentExpressionField?(null==this.newEventAction.maxValue&&(this.newEventAction.maxValue=""),this.newEventAction.maxValue+=e):"newEventAction.fontSize"==this.currentExpressionField?(null==this.newEventAction.fontSize&&(this.newEventAction.fontSize=""),this.newEventAction.fontSize+=e):"newEventAction.volume"==this.currentExpressionField?(null==this.newEventAction.volume&&(this.newEventAction.volume=""),this.newEventAction.volume+=e):"newEventAction.color.red"==this.currentExpressionField?(null==this.newEventAction.color&&(this.newEventAction.color=new s.default("","","")),this.newEventAction.color.red+=e):"newEventAction.color.green"==this.currentExpressionField?(null==this.newEventAction.color&&(this.newEventAction.color=new s.default("","","")),this.newEventAction.color.green+=e):"newEventAction.color.blue"==this.currentExpressionField?(null==this.newEventAction.color&&(this.newEventAction.color=new s.default("","","")),this.newEventAction.color.blue+=e):"newEventAction.borderColor.red"==this.currentExpressionField?(null==this.newEventAction.borderColor&&(this.newEventAction.borderColor=new s.default("","","")),this.newEventAction.borderColor.red+=e):"newEventAction.borderColor.green"==this.currentExpressionField?(null==this.newEventAction.borderColor&&(this.newEventAction.borderColor=new s.default("","","")),this.newEventAction.borderColor.green+=e):"newEventAction.borderColor.blue"==this.currentExpressionField?(null==this.newEventAction.borderColor&&(this.newEventAction.borderColor=new s.default("","","")),this.newEventAction.borderColor.blue+=e):"newEventAction.backgroundColor.red"==this.currentExpressionField?(null==this.newEventAction.backgroundColor&&(this.newEventAction.backgroundColor=new s.default("","","")),this.newEventAction.backgroundColor.red+=e):"newEventAction.backgroundColor.green"==this.currentExpressionField?(null==this.newEventAction.backgroundColor&&(this.newEventAction.backgroundColor=new s.default("","","")),this.newEventAction.backgroundColor.green+=e):"newEventAction.backgroundColor.blue"==this.currentExpressionField&&(null==this.newEventAction.backgroundColor&&(this.newEventAction.backgroundColor=new s.default("","","")),this.newEventAction.backgroundColor.blue+=e),this.closeExpressionHelp()},e.prototype.updateExpressionLoopObjectVariables=function(){var e=this;this.expressionLoopObjectVariables=new Array;var t=this.currentLocalVariables.find((function(t){return t.name==e.expressionLoopVariableName}));null!=t&&null!=t.objectType&&(this.expressionLoopObjectVariables=t.objectType.objectVariables)},e.prototype.clearExpressionHelpForm=function(){this.expressionType=null,this.expressionToInsert=null,this.expressionObjectAttribute=null,this.expressionObjectMethod=null,this.expressionLoopVariableName=null,this.expressionLoopVariableName2=null,this.expressionGlobalVariableName=null,this.expressionLevelVariableName=null,this.expressionLoopObjectVariables=new Array,this.expressionLoopObjectVariable=null,this.expressionLocalStorageVariableName=null},e.prototype.newGame=function(){this.startNewGame()},e.prototype.startNewGame=function(){this.actionTemplate=null,this.isPlayingGame=!1,this.gameId=null,this.gameName="My Game",this.gameDescription="";var e=(new Date).toISOString(),t=new u.default;t.name="My Game",t.description="",t.engineVersion=this.environment.templateVersion,t.createdAt=e,t.updatedAt=e,t.canvasHeight=500,t.canvasWidth=600,t.levels=new Array,t.customObjectTypes=new Array,t.events=new Array,t.customTexts=new Array,t.globalVariables=new Array,t.customImages=new Array,t.customAudios=new Array,this.gameParamsJson=t,this.addLevel(),this.updateGameSize()},e.prototype.requestCanvasFullscreen=function(){this.util.requestCanvasFullscreen()},e.prototype.refreshSession=function(){this.sessionId=this.util.getCookie("sessionId")},e.prototype.setCurrentTab=function(e){this.currentTab=e,this.closeExpressionHelp(),"SAVE"==e&&this.refreshSession(),"IMPORT_EXPORT"!=e&&"IMPORT_GAME"!=e&&"EXPORT_GAME"!=e||(this.gameParamsJsonDecycled=null),"VISUAL_SCRIPTS"==e&&this.visualScriptsController.updateCurrentScript(),"CUSTOM_IMAGES"==e&&this.updateCustomImagesWithMiniatures(),"CUSTOM_OBJECT_TYPES"==e&&this.updateObjectTypesWithMiniatures();for(var t=["GAME_PROPERTIES","LEVELS","CUSTOM_OBJECT_TYPES","CUSTOM_TEXTS","GLOBAL_VARIABLES","EVENTS","VISUAL_SCRIPTS","IMPORT_EXPORT","IMPORT_GAME","EXPORT_GAME","SAVE","EDIT_LEVEL","EDIT_CUSTOM_OBJECT","EDIT_GLOBAL_VARIABLE","EDIT_CUSTOM_TEXT","EDIT_EVENT","EDIT_LOOP","EDIT_EVENT_CONDITION","EDIT_EVENT_ACTION","EDIT_BUTTON","EDIT_LEVEL_VARIABLE","EDIT_OBJECT_VARIABLE","EDIT_CUSTOM_OBJECT_TYPE","EDIT_CUSTOM_OBJECT_TYPE_BEHAVIOUR","CUSTOM_IMAGES","CUSTOM_AUDIOS"],i=0;i<t.length;i++){var o=document.getElementById("link-tab-"+t[i]);null!=o&&(o.className="nav-link")}var n=document.getElementById("link-tab-"+e);null!=n&&n.classList.add("active"),this.setCurrentTab2(""),this.setCurrentScreen(e)},e.prototype.setCurrentTab2=function(e){this.currentTab2=e;for(var t=["PROPERTIES","INITIAL_OBJECTS","LEVEL_TEXTS","BUTTONS","LEVEL_VARIABLES","LEVEL_EVENTS","CUSTOM_OBJECT_TYPE_PROPERTIES","CUSTOM_OBJECT_TYPE_BEHAVIOURS","CUSTOM_OBJECT_VARIABLES"],i=0;i<t.length;i++){var o=document.getElementById("link-tab-"+t[i]);null!=o&&(o.className="nav-link")}var n=document.getElementById("link-tab-"+e);null!=n&&n.classList.add("active"),"PROPERTIES"!=e&&"INITIAL_OBJECTS"!=e&&"LEVEL_TEXTS"!=e&&"BUTTONS"!=e&&"LEVEL_VARIABLES"!=e&&"LEVEL_EVENTS"!=e||(this.previousLevelTab=e),this.setCurrentScreen(e)},e.prototype.setCurrentScreen=function(e){this.currentScreen=e},e.prototype.addLevel=function(){var e=new p.default;e.name="Level "+(this.gameParamsJson.levels.length+1),e.uid=this.util.uid(),e.backgroundType=w.default.SOLID_COLOR,e.backgroundColor=new n.default(255,255,255),e.backgroundImageWidth=64,e.backgroundImageHeight=64,e.gravity=.3,e.electricConstant=0,e.levelVariables=new Array,e.initialObjects=new Array,e.texts=new Array,e.buttons=new Array,e.applyGravitationalForceBetweenObjects=!1,e.gravitationalConstant=0;var t=new R.default;t.imageSourceType=I.default.LIBRARY,t.imageId="images/asset-packs/kenney/2d/voxel-pack/png/tiles/greystone.png",e.backgroundImage=t;var i=new k.default;i.uid=this.util.uid(),i.name="",i.description="",i.blocks=new Array,i.level=e;var o=new k.default;o.uid=this.util.uid(),o.name="",o.description="",o.blocks=new Array,o.level=e,e.scriptOnLevelStart=i,e.scriptOnAnimationFrame=o,this.gameParamsJson.levels.push(e)},e.prototype.moveLevelUp=function(e){this.util.arrayMove(this.gameParamsJson.levels,e,e-1)},e.prototype.moveLevelDown=function(e){this.util.arrayMove(this.gameParamsJson.levels,e,e+1)},e.prototype.deleteLevel=function(e){this.gameParamsJson.levels.splice(e,1)},e.prototype.showLevelVariables=function(e){this.editLevel(e),this.currentTab2="LEVEL_VARIABLES"},e.prototype.showInitialObjects=function(e){this.editLevel(e),this.currentTab2="INITIAL_OBJECTS"},e.prototype.editLevel=function(e){var t=this.gameParamsJson.levels[e];this.oldLevel=t,this.newLevel=this.util.cloneObject(t),this.currentLevelIndex=e,this.setCurrentTab2(this.previousLevelTab),this.currentScript=this.oldLevel.scriptOnAnimationFrame},e.prototype.cancelChangesLevel=function(){this.setCurrentTab("LEVELS"),this.oldLevel=null,this.newLevel=null},e.prototype.updateLevel=function(){this.setCurrentTab("LEVELS"),this.oldLevel.name=this.newLevel.name,this.oldLevel.backgroundType=this.newLevel.backgroundType,this.oldLevel.backgroundImage.imageId=this.newLevel.backgroundImage.imageId,this.oldLevel.backgroundImage.imageSourceType=this.newLevel.backgroundImage.imageSourceType,this.oldLevel.backgroundImage.customImage=this.newLevel.backgroundImage.customImage,this.oldLevel.backgroundImageWidth=Number(this.newLevel.backgroundImageWidth),this.oldLevel.backgroundImageHeight=Number(this.newLevel.backgroundImageHeight),this.oldLevel.backgroundColor={red:Number(this.newLevel.backgroundColor.red),green:Number(this.newLevel.backgroundColor.green),blue:Number(this.newLevel.backgroundColor.blue),alpha:100},this.oldLevel.gravity=Number(this.newLevel.gravity),this.oldLevel.electricConstant=Number(this.newLevel.electricConstant),this.oldLevel.centerCameraAtObject=this.newLevel.centerCameraAtObject,this.oldLevel.centerCameraAtObjectTypeId=this.newLevel.centerCameraAtObjectTypeId,this.oldLevel.applyGravitationalForceBetweenObjects=this.newLevel.applyGravitationalForceBetweenObjects,this.oldLevel.gravitationalConstant=this.newLevel.gravitationalConstant,this.oldLevel=null,this.newLevel=null,this.saveJsonToLocalStorage()},e.prototype.addEvent=function(){var e=new d.default;e.uid=this.util.uid(),e.levelDefinition=this.gameParamsJson.levels[0],e.loops=new Array,e.conditions=new Array,e.actions=new Array,this.gameParamsJson.events.push(e)},e.prototype.editEvent=function(e){this.setCurrentScreen("EDIT_EVENT"),this.oldEvent=e,this.newEvent=JSON.parse(JSON.stringify(this.oldEvent))},e.prototype.updateEvent=function(){this.setCurrentTab("EVENTS"),this.oldEvent.description=this.newEvent.description,this.oldEvent.levelDefinition=this.util.findLevelDefinitionByUid(this.gameParamsJson.levels,this.newEvent.levelDefinition.uid),this.oldEvent=null,this.newEvent=null},e.prototype.cancelChangesEvent=function(){this.setCurrentTab("EVENTS"),this.oldEvent=null,this.newEvent=null},e.prototype.moveEventUp=function(e){this.util.arrayMove(this.gameParamsJson.events,e,e-1)},e.prototype.moveEventDown=function(e){this.util.arrayMove(this.gameParamsJson.events,e,e+1)},e.prototype.deleteEvent=function(e){this.gameParamsJson.events.splice(e,1)},e.prototype.deleteAllEvents=function(e){confirm("Delete all events?")&&this.gameParamsJson.events.splice(0,this.gameParamsJson.events.length)},e.prototype.buildEventAction=function(){var e=new h.default;e.category=b.default.GAME,e.type=_.default.ADD_TO_SCORE,e.textType=G.default.STATIC_TEXT,e.variableTextType=G.default.STATIC_TEXT,e.valueTextType=G.default.STATIC_TEXT,e.value="1",e.font=null,e.fillStyle=null,e.textAlign=null,e.attribute=null,e.variable=null,e.speed=null,e.angle=null,e.targetX=null,e.targetY=null,e.force=null,e.objectSelectorDefinition=new c.default,e.objectSelectorDefinition.objectType=new f.default,e.sourceObjectSelectorDefinition=new c.default,e.sourceObjectSelectorDefinition.objectType=new f.default,e.targetObjectSelectorDefinition=new c.default,e.targetObjectSelectorDefinition.objectType=new f.default,e.color=new s.default("","",""),e.borderColor=new s.default("","",""),e.backgroundColor=new s.default("","",""),e.levelDefinition=new p.default,e.button=new v.default;var t=new R.default;t.imageSourceType=I.default.LIBRARY,t.imageId="images/asset-packs/kenney/2d/puzzle-2/png/balls/grey/edited/ball-red.png",e.image=t;var i=new j.default;return i.audioPath="audio/kenney/retro-sounds/jump1.ogg",i.audioSourceType=M.default.LIBRARY,i.customAudio=new D.default,e.audio=i,e.volume="100",e},e.prototype.addEventAction=function(e){var t=this.buildEventAction();this.gameParamsJson.events[e].actions.push(t)},e.prototype.deleteEventAction=function(e,t){this.gameParamsJson.events[e].actions.splice(t,1)},e.prototype.editEventAction=function(e){var t;this.currentBlock=e;var i=e.actionBlock.action;this.setCurrentScreen("EDIT_EVENT_ACTION"),this.oldEventAction=i,this.newEventAction=this.util.cloneObject(this.oldEventAction),this.newEventAction.customObjectType=this.newEventAction.customObjectType||new f.default,this.newEventAction.levelVariable=this.newEventAction.levelVariable||new E.default,null!==(t=this.newEventAction.audio==this.newEventAction.audio)&&void 0!==t||new j.default,null==this.newEventAction.audio.customAudio&&(this.newEventAction.audio.customAudio=new D.default),null==this.newEventAction.objectSelectorDefinition&&(this.newEventAction.objectSelectorDefinition=new c.default),null==this.newEventAction.objectSelectorDefinition.objectType&&(this.newEventAction.objectSelectorDefinition.objectType=new f.default),null==this.newEventAction.sourceObjectSelectorDefinition&&(this.newEventAction.sourceObjectSelectorDefinition=new c.default),null==this.newEventAction.sourceObjectSelectorDefinition.objectType&&(this.newEventAction.sourceObjectSelectorDefinition.objectType=new f.default),null==this.newEventAction.targetObjectSelectorDefinition&&(this.newEventAction.targetObjectSelectorDefinition=new c.default),null==this.newEventAction.targetObjectSelectorDefinition.objectType&&(this.newEventAction.targetObjectSelectorDefinition.objectType=new f.default),null==this.newEventAction.color&&(this.newEventAction.color=new s.default("","","")),null==this.newEventAction.borderColor&&(this.newEventAction.borderColor=new s.default("","","")),null==this.newEventAction.backgroundColor&&(this.newEventAction.backgroundColor=new s.default("","","")),null==this.newEventAction.levelDefinition&&(this.newEventAction.levelDefinition=new p.default),null==this.newEventAction.button&&(this.newEventAction.button=new v.default),this.filterEventActionTypes(),this.newEventActionTypeCode=this.newEventAction.type.code,this.loadButtons(),this.newEventAction.type.code!=_.default.SET_OBJECT_VARIABLE.code&&this.newEventAction.type.code!=_.default.ADD_TO_OBJECT_VARIABLE.code||(null!=this.newEventAction.objectSelectorDefinition.loopVariableName&&this.loadLoopObjectVariables(this.newEventAction.objectSelectorDefinition.loopVariableName),null!=this.newEventAction.objectSelectorDefinition.objectType.uid&&this.loadObjectVariables(this.newEventAction.objectSelectorDefinition.objectType.uid)),this.currentLocalVariables=this.getLocalVariablesByBlock(e)},e.prototype.updateEventAction=function(){"LEVELS"==this.currentTab?this.setCurrentTab2("LEVEL_EVENTS"):"VISUAL_SCRIPTS"==this.currentTab&&this.setCurrentTab("VISUAL_SCRIPTS"),this.oldEventAction.category=this.newEventAction.category,this.oldEventAction.type=_.default.findByCode(this.newEventAction.type.code),this.oldEventAction.customObjectType=this.util.findElementByUid(this.gameParamsJson.customObjectTypes,this.newEventAction.customObjectType.uid),this.oldEventAction.sourceType=this.newEventAction.sourceType,this.oldEventAction.targetType=this.newEventAction.targetType,this.oldEventAction.x=this.newEventAction.x,this.oldEventAction.y=this.newEventAction.y,this.oldEventAction.attribute=this.newEventAction.attribute,this.oldEventAction.value=this.newEventAction.value,this.oldEventAction.valueTextType=this.newEventAction.valueTextType,this.oldEventAction.variable=this.newEventAction.variable,this.oldEventAction.variableTextType=this.newEventAction.variableTextType,this.oldEventAction.levelVariable=this.util.findElementByUid(this.currentScript.level.levelVariables,this.newEventAction.levelVariable.uid),null!=this.newEventAction.levelDefinition&&(this.oldEventAction.levelDefinition=this.util.findLevelDefinitionByUid(this.gameParamsJson.levels,this.newEventAction.levelDefinition.uid)),this.oldEventAction.audio.audioSourceType=this.newEventAction.audio.audioSourceType,this.oldEventAction.audio.audioPath=this.newEventAction.audio.audioPath,null!=this.newEventAction.audio.customAudio?this.oldEventAction.audio.customAudio=this.util.findElementByUid(this.gameParamsJson.customAudios,this.newEventAction.audio.customAudio.uid):this.oldEventAction.audio.customAudio=null,this.oldEventAction.sourceX=this.newEventAction.sourceX,this.oldEventAction.sourceY=this.newEventAction.sourceY,this.oldEventAction.targetX=this.newEventAction.targetX,this.oldEventAction.targetY=this.newEventAction.targetY,this.oldEventAction.x1=this.newEventAction.x1,this.oldEventAction.y1=this.newEventAction.y1,this.oldEventAction.x2=this.newEventAction.x2,this.oldEventAction.y2=this.newEventAction.y2,this.oldEventAction.lineWidth=this.newEventAction.lineWidth,this.oldEventAction.width=this.newEventAction.width,this.oldEventAction.height=this.newEventAction.height,this.oldEventAction.radius=this.newEventAction.radius,this.oldEventAction.speed=this.newEventAction.speed,this.oldEventAction.speedX=this.newEventAction.speedX,this.oldEventAction.speedY=this.newEventAction.speedY,this.oldEventAction.force=this.newEventAction.force,this.oldEventAction.angle=this.newEventAction.angle,this.oldEventAction.expression=this.newEventAction.expression,this.oldEventAction.text=this.newEventAction.text,this.oldEventAction.textType=this.newEventAction.textType,this.oldEventAction.fontSize=this.newEventAction.fontSize,this.oldEventAction.fontFamily=this.newEventAction.fontFamily,this.oldEventAction.textAlign=this.newEventAction.textAlign,this.oldEventAction.fillStyle=this.newEventAction.fillStyle,this.oldEventAction.alpha=this.newEventAction.alpha,this.oldEventAction.rotation=this.newEventAction.rotation,this.oldEventAction.maxValue=this.newEventAction.maxValue,this.oldEventAction.split=this.newEventAction.split,this.oldEventAction.borderSize=this.newEventAction.borderSize,this.oldEventAction.drawType=this.newEventAction.drawType,this.oldEventAction.volume=this.newEventAction.volume,this.oldEventAction.image.imageSourceType=this.newEventAction.image.imageSourceType,this.oldEventAction.image.imageId=this.newEventAction.image.imageId,this.newEventAction.image.imageSourceType==I.default.UPLOAD?this.oldEventAction.image.customImage=this.util.findElementByUid(this.gameParamsJson.customImages,this.newEventAction.image.customImage.uid):this.oldEventAction.image.customImage=null,null!=this.newEventAction.button&&(this.oldEventAction.button=this.util.findElementByUid(this.buttons,this.newEventAction.button.uid)),this.oldEventAction.objectSelectorDefinition=this.util.buildObjectSelector(this.newEventAction.objectSelectorDefinition,this.gameParamsJson.customObjectTypes),this.oldEventAction.sourceObjectSelectorDefinition=this.util.buildObjectSelector(this.newEventAction.sourceObjectSelectorDefinition,this.gameParamsJson.customObjectTypes),this.oldEventAction.targetObjectSelectorDefinition=this.util.buildObjectSelector(this.newEventAction.targetObjectSelectorDefinition,this.gameParamsJson.customObjectTypes),null!=this.newEventAction.color&&(this.oldEventAction.color=new s.default(this.newEventAction.color.red,this.newEventAction.color.green,this.newEventAction.color.blue)),null!=this.newEventAction.backgroundColor&&(this.oldEventAction.backgroundColor=new s.default(this.newEventAction.backgroundColor.red,this.newEventAction.backgroundColor.green,this.newEventAction.backgroundColor.blue)),null!=this.newEventAction.borderColor&&(this.oldEventAction.borderColor=new s.default(this.newEventAction.borderColor.red,this.newEventAction.borderColor.green,this.newEventAction.borderColor.blue)),this.oldEventAction=null,this.newEventAction=null,this.visualScriptController.selectBlock(this.currentBlock),this.saveJsonToLocalStorage()},e.prototype.cancelChangesEventAction=function(){"LEVELS"==this.currentTab?this.setCurrentTab2("LEVEL_EVENTS"):"VISUAL_SCRIPTS"==this.currentTab&&this.setCurrentTab("VISUAL_SCRIPTS"),this.oldEventAction=null,this.newEventAction=null,this.visualScriptController.selectBlock(this.currentBlock)},e.prototype.addCustomObject=function(e){0==this.gameParamsJson.customObjectTypes.length&&this.addCustomObjectType();var t=new y.default;t.x=this.gameParamsJson.canvasWidth/2+this.levelPreviewViewModel.levelPreviewRenderer.offsetX,t.y=this.gameParamsJson.canvasHeight/2+this.levelPreviewViewModel.levelPreviewRenderer.offsetY,t.objectType=this.gameParamsJson.customObjectTypes[0],this.gameParamsJson.levels[e].initialObjects.push(t),this.levelPreviewViewModel.deselectElements(),this.levelPreviewViewModel.selectedObject=t},e.prototype.deleteCustomObject=function(e,t){this.gameParamsJson.levels[e].initialObjects.splice(t,1)},e.prototype.editCustomObject=function(e){this.setCurrentScreen("EDIT_CUSTOM_OBJECT"),this.oldCustomObject=e,this.newCustomObject=JSON.parse(JSON.stringify(this.oldCustomObject))},e.prototype.cancelChangesCustomObject=function(){this.setCurrentTab2("INITIAL_OBJECTS"),this.oldCustomObject=null,this.newCustomObject=null},e.prototype.updateCustomObject=function(){this.setCurrentTab2("INITIAL_OBJECTS"),this.oldCustomObject.objectType=this.util.findElementByUid(this.gameParamsJson.customObjectTypes,this.newCustomObject.objectType.uid),this.oldCustomObject.x=Number(this.newCustomObject.x),this.oldCustomObject.y=Number(this.newCustomObject.y),this.oldCustomObject.repeatTimes=this.util.numberOrNull(this.newCustomObject.repeatTimes),this.oldCustomObject.dx=this.util.numberOrNull(this.newCustomObject.dx),this.oldCustomObject.dy=this.util.numberOrNull(this.newCustomObject.dy),this.oldCustomObject.repeatTimes2=this.util.numberOrNull(this.newCustomObject.repeatTimes2),this.oldCustomObject.dx2=this.util.numberOrNull(this.newCustomObject.dx2),this.oldCustomObject.dy2=this.util.numberOrNull(this.newCustomObject.dy2),this.oldCustomObject=null,this.newCustomObject=null,this.saveJsonToLocalStorage()},e.prototype.addButton=function(e){var t=new v.default;t.backgroundColor=new n.default(255,255,255),t.backgroundColorMouseOver=new n.default(255,255,255),t.borderColor=new n.default(0,0,0),t.borderColorMouseOver=new n.default(0,0,0),t.borderRadius=5,t.borderSize=1,t.borderSizeMouseOver=1,t.fontSize=14,t.height=30,t.name="button",t.text="button",t.textColor=new n.default(0,0,0),t.uid=this.util.uid(),t.width=100,t.x=300+this.levelPreviewViewModel.levelPreviewRenderer.offsetX,t.y=250+this.levelPreviewViewModel.levelPreviewRenderer.offsetY,this.gameParamsJson.levels[e].buttons.push(t),this.levelPreviewViewModel.deselectElements(),this.levelPreviewViewModel.selectedButton=t},e.prototype.deleteButton=function(e,t){this.gameParamsJson.levels[e].buttons.splice(t,1)},e.prototype.editButton=function(e){this.setCurrentScreen("EDIT_BUTTON"),this.oldButton=e,this.newButton=JSON.parse(JSON.stringify(this.oldButton))},e.prototype.cancelChangesButton=function(){this.setCurrentTab2("BUTTONS"),this.oldCustomObject=null,this.newCustomObject=null},e.prototype.updateButton=function(){this.setCurrentTab2("BUTTONS"),this.oldButton.name=this.newButton.name,this.oldButton.typeId=this.newButton.typeId,this.oldButton.x=Number(this.newButton.x),this.oldButton.y=Number(this.newButton.y),this.oldButton.width=Number(this.newButton.width),this.oldButton.height=Number(this.newButton.height),this.oldButton.borderSize=Number(this.newButton.borderSize),this.oldButton.borderSizeMouseOver=Number(this.newButton.borderSizeMouseOver),this.oldButton.borderRadius=Number(this.newButton.borderRadius),this.oldButton.fontSize=Number(this.newButton.fontSize),this.oldButton.text=this.newButton.text,this.oldButton.backgroundColor={red:Number(this.newButton.backgroundColor.red),green:Number(this.newButton.backgroundColor.green),blue:Number(this.newButton.backgroundColor.blue),alpha:100},this.oldButton.backgroundColorMouseOver={red:Number(this.newButton.backgroundColorMouseOver.red),green:Number(this.newButton.backgroundColorMouseOver.green),blue:Number(this.newButton.backgroundColorMouseOver.blue),alpha:100},this.oldButton.borderColor={red:Number(this.newButton.borderColor.red),green:Number(this.newButton.borderColor.green),blue:Number(this.newButton.borderColor.blue),alpha:100},this.oldButton.borderColorMouseOver={red:Number(this.newButton.borderColorMouseOver.red),green:Number(this.newButton.borderColorMouseOver.green),blue:Number(this.newButton.borderColorMouseOver.blue),alpha:100},this.oldButton.textColor={red:Number(this.newButton.textColor.red),green:Number(this.newButton.textColor.green),blue:Number(this.newButton.textColor.blue),alpha:100},this.oldButton=null,this.newButton=null},e.prototype.addLevelVariable=function(e){null==this.gameParamsJson.levels[e].levelVariables&&(this.gameParamsJson.levels[e].levelVariables=new Array);var t=new E.default;t.uid=this.util.uid(),t.name="variable01",t.initialValue=0,t.type=S.default.NUMBER,this.gameParamsJson.levels[e].levelVariables.push(t)},e.prototype.deleteLevelVariable=function(e,t){this.gameParamsJson.levels[e].levelVariables.splice(t,1)},e.prototype.editLevelVariable=function(e){this.setCurrentScreen("EDIT_LEVEL_VARIABLE"),this.oldLevelVariable=e,this.newLevelVariable=JSON.parse(JSON.stringify(this.oldLevelVariable))},e.prototype.cancelChangesLevelVariable=function(){this.setCurrentTab2("LEVEL_VARIABLES"),this.oldLevelVariable=null,this.newLevelVariable=null},e.prototype.updateLevelVariable=function(){this.setCurrentTab2("LEVEL_VARIABLES"),this.oldLevelVariable.name=this.newLevelVariable.name,this.oldLevelVariable.initialValue=Number(this.newLevelVariable.initialValue),this.oldLevelVariable=null,this.newLevelVariable=null,this.saveJsonToLocalStorage()},e.prototype.addLevelText=function(e){null==this.gameParamsJson.levels[e].texts&&(this.gameParamsJson.levels[e].texts=new Array);var t=new L.default;t.uid=this.util.uid(),t.text="Text",t.align="center",t.color=new n.default(0,0,0),t.fontFamily="arial",t.fontSize=32,t.x=300+this.levelPreviewViewModel.levelPreviewRenderer.offsetX,t.y=250+this.levelPreviewViewModel.levelPreviewRenderer.offsetY,this.gameParamsJson.levels[e].texts.push(t),this.levelPreviewViewModel.deselectElements(),this.levelPreviewViewModel.selectedText=t},e.prototype.deleteLevelText=function(e,t){this.gameParamsJson.levels[e].texts.splice(t,1)},e.prototype.editLevelText=function(e){this.setCurrentScreen("EDIT_LEVEL_TEXT"),this.oldLevelText=e,this.newLevelText=JSON.parse(JSON.stringify(this.oldLevelText))},e.prototype.cancelChangesLevelText=function(){this.setCurrentTab2("LEVEL_TEXTS"),this.oldLevelText=null,this.newLevelText=null},e.prototype.updateLevelText=function(){this.setCurrentTab2("LEVEL_TEXTS"),this.oldLevelText.text=this.newLevelText.text,this.oldLevelText.fontFamily=this.newLevelText.fontFamily,this.oldLevelText.align=this.newLevelText.align,this.oldLevelText.x=Number(this.newLevelText.x),this.oldLevelText.y=Number(this.newLevelText.y),this.oldLevelText.fontSize=Number(this.newLevelText.fontSize),this.oldLevelText.color={red:this.newLevelText.color.red,green:this.newLevelText.color.green,blue:this.newLevelText.color.blue,alpha:this.newLevelText.color.alpha},this.oldLevelText=null,this.newLevelText=null},e.prototype.addObjectVariable=function(e){null==this.gameParamsJson.customObjectTypes[e].objectVariables&&(this.gameParamsJson.customObjectTypes[e].objectVariables=new Array);var t=new m.default;t.name="variable01",t.initialValue=0,t.type=S.default.NUMBER,this.gameParamsJson.customObjectTypes[e].objectVariables.push(t)},e.prototype.deleteObjectVariable=function(e,t){this.gameParamsJson.customObjectTypes[e].objectVariables.splice(t,1)},e.prototype.editObjectVariable=function(e){this.setCurrentScreen("EDIT_OBJECT_VARIABLE"),this.oldObjectVariable=e,this.newObjectVariable=JSON.parse(JSON.stringify(this.oldObjectVariable))},e.prototype.cancelChangesObjectVariable=function(){this.setCurrentTab2("CUSTOM_OBJECT_VARIABLES"),this.oldObjectVariable=null,this.newObjectVariable=null},e.prototype.updateObjectVariable=function(){this.setCurrentTab2("CUSTOM_OBJECT_VARIABLES"),this.oldObjectVariable.name=this.newObjectVariable.name,this.oldObjectVariable.initialValue=Number(this.newObjectVariable.initialValue),this.oldObjectVariable=null,this.newObjectVariable=null},e.prototype.addCustomText=function(){this.gameParamsJson.customTexts.push({text:"text",font:"12px Arial",fillStyle:"#AAAAAA",x:0,y:0,levelIndex:0})},e.prototype.deleteCustomText=function(e){this.gameParamsJson.customTexts.splice(e,1)},e.prototype.editCustomText=function(e){this.setCurrentScreen("EDIT_CUSTOM_TEXT"),this.oldCustomText=e,this.newCustomText=JSON.parse(JSON.stringify(this.oldCustomText))},e.prototype.cancelChangesCustomText=function(){this.setCurrentTab("CUSTOM_TEXTS"),this.oldCustomText=null,this.newCustomText=null},e.prototype.updateCustomText=function(){this.setCurrentTab("CUSTOM_TEXTS"),this.oldCustomText.text=this.newCustomText.text,this.oldCustomText.font=this.newCustomText.font,this.oldCustomText.fillStyle=this.newCustomText.fillStyle,this.oldCustomText.x=Number(this.newCustomText.x),this.oldCustomText.y=Number(this.newCustomText.y),this.oldCustomText.levelIndex=Number(this.newCustomText.levelIndex),this.oldCustomText=null,this.newCustomText=null},e.prototype.addGlobalVariable=function(){var e=new m.default;e.name="globalVariable001",e.initialValue=0,this.gameParamsJson.globalVariables.push(e)},e.prototype.deleteGlobalVariable=function(e){this.gameParamsJson.globalVariables.splice(e,1)},e.prototype.editGlobalVariable=function(e){this.setCurrentScreen("EDIT_GLOBAL_VARIABLE"),this.oldGlobalVariable=e,this.newGlobalVariable=JSON.parse(JSON.stringify(this.oldGlobalVariable))},e.prototype.cancelChangesGlobalVariable=function(){this.setCurrentTab("GLOBAL_VARIABLES"),this.oldGlobalVariable=null,this.newGlobalVariable=null},e.prototype.updateGlobalVariable=function(){this.setCurrentTab("GLOBAL_VARIABLES"),this.oldGlobalVariable.name=this.newGlobalVariable.name,this.oldGlobalVariable.initialValue=Number(this.newGlobalVariable.initialValue),this.oldGlobalVariable=null,this.newGlobalVariable=null,this.saveJsonToLocalStorage()},e.prototype.goToAddCustomImage=function(){this.setCurrentScreen("ADD_CUSTOM_IMAGE"),this.newCustomImage=new B.default},e.prototype.initCustomImage=function(){this.newCustomImage=new B.default},e.prototype.addCustomImage=function(){this.newCustomImage.uid=this.util.uid(),this.gameParamsJson.customImages.push(this.newCustomImage),this.setCurrentTab("CUSTOM_IMAGES")},e.prototype.deleteCustomImage=function(e){this.gameParamsJson.customImages.splice(e,1),this.updateCustomImagesWithMiniatures()},e.prototype.editCustomImage=function(e){this.setCurrentScreen("EDIT_CUSTOM_IMAGE"),this.oldCustomImage=e,this.newCustomImage=JSON.parse(JSON.stringify(this.oldCustomImage))},e.prototype.updateCustomImage=function(){this.setCurrentTab("CUSTOM_IMAGES"),this.oldCustomImage.name=this.newCustomImage.name,this.oldCustomImage.imageData=this.newCustomImage.imageData,this.oldCustomImage=null,this.newCustomImage=null},e.prototype.cancelAddCustomImage=function(){this.setCurrentTab("CUSTOM_IMAGES")},e.prototype.goToAddCustomAudio=function(){this.setCurrentScreen("ADD_CUSTOM_AUDIO"),this.newCustomAudio=new D.default},e.prototype.initCustomAudio=function(){this.newCustomAudio=new D.default},e.prototype.addCustomAudio=function(){this.newCustomAudio.uid=this.util.uid(),this.gameParamsJson.customAudios.push(this.newCustomAudio),this.setCurrentTab("CUSTOM_AUDIOS")},e.prototype.deleteCustomAudio=function(e){this.gameParamsJson.customAudios.splice(e,1)},e.prototype.editCustomAudio=function(e){this.setCurrentScreen("EDIT_CUSTOM_AUDIO"),this.oldCustomAudio=e,this.newCustomAudio=JSON.parse(JSON.stringify(this.oldCustomAudio))},e.prototype.updateCustomAudio=function(){this.setCurrentTab("CUSTOM_AUDIOS"),this.oldCustomAudio.name=this.newCustomAudio.name,this.oldCustomAudio.audioData=this.newCustomAudio.audioData,this.oldCustomAudio=null,this.newCustomAudio=null},e.prototype.cancelAddCustomAudio=function(){this.setCurrentTab("CUSTOM_AUDIOS")},e.prototype.deleteEventCondition=function(e,t){this.gameParamsJson.events[e].conditions.splice(t,1)},e.prototype.editEventCondition=function(e){this.currentBlock=e;var t=e.conditionBlock.condition;this.setCurrentScreen("EDIT_EVENT_CONDITION"),this.oldEventCondition=t;var i=this.util.cloneObject(this.oldEventCondition);null==i.object1&&(i.object1=new c.default),null==i.object1.objectType&&(i.object1.objectType=new f.default),null==i.object2&&(i.object2=new c.default),null==i.object2.objectType&&(i.object2.objectType=new f.default),null==i.button&&(i.button=new v.default),null==i.objectSelectorDefinition&&(i.objectSelectorDefinition=new c.default),null==i.objectSelectorDefinition.objectType&&(i.objectSelectorDefinition.objectType=new f.default),this.newEventCondition=i,this.loadButtons(),this.currentLocalVariables=this.getLocalVariablesByBlock(e),this.filterEventConditionTypes()},e.prototype.updateEventCondition=function(){"LEVELS"==this.currentTab?this.setCurrentTab2("LEVEL_EVENTS"):"VISUAL_SCRIPTS"==this.currentTab&&this.setCurrentTab("VISUAL_SCRIPTS"),this.oldEventCondition.type=this.newEventCondition.type,this.oldEventCondition.category=this.newEventCondition.category,this.oldEventCondition.expression=this.newEventCondition.expression,this.oldEventCondition.keyCode=this.newEventCondition.keyCode,this.oldEventCondition.frames=Number(this.newEventCondition.frames),this.oldEventCondition.seconds=Number(this.newEventCondition.seconds),this.oldEventCondition.x1=this.newEventCondition.x1,this.oldEventCondition.y1=this.newEventCondition.y1,this.oldEventCondition.x2=this.newEventCondition.x2,this.oldEventCondition.y2=this.newEventCondition.y2,this.oldEventCondition.distance=this.newEventCondition.distance,this.oldEventCondition.relation=this.newEventCondition.relation,this.oldEventCondition.objectSelectorDefinition=this.util.buildObjectSelector(this.newEventCondition.objectSelectorDefinition,this.gameParamsJson.customObjectTypes),this.oldEventCondition.object1=this.util.buildObjectSelector(this.newEventCondition.object1,this.gameParamsJson.customObjectTypes),this.oldEventCondition.object2=this.util.buildObjectSelector(this.newEventCondition.object2,this.gameParamsJson.customObjectTypes),null!=this.newEventCondition.button&&(this.oldEventCondition.button=this.util.findElementByUid(this.buttons,this.newEventCondition.button.uid)),this.oldEventCondition=null,this.newEventCondition=null,this.visualScriptController.selectBlock(this.currentBlock),this.saveJsonToLocalStorage()},e.prototype.cancelChangesEventCondition=function(){"LEVELS"==this.currentTab?this.setCurrentTab2("LEVEL_EVENTS"):"VISUAL_SCRIPTS"==this.currentTab&&this.setCurrentTab("VISUAL_SCRIPTS"),this.oldEventCondition=null,this.newEventCondition=null,this.visualScriptController.selectBlock(this.currentBlock)},e.prototype.showCustomObjectTypeBehaviours=function(e){this.editCustomObjectType(e),this.setCurrentTab2("CUSTOM_OBJECT_TYPE_BEHAVIOURS")},e.prototype.addCustomObjectType=function(){var e=new f.default;e.uid=this.util.uid(),e.id="ObjectType"+(this.gameParamsJson.customObjectTypes.length+1),e.width=30,e.height=30,e.electricCharge=0,e.mass=0,e.alpha=1,e.applyGravity=!1,e.behaviours=new Array,e.renderType=C.default.IMAGE,e.color=new n.default(255,0,0),e.borderColor=new n.default(0,0,0),e.objectVariables=new Array;var t=new R.default;t.imageSourceType=I.default.LIBRARY,t.imageId="images/asset-packs/kenney/2d/puzzle-2/png/balls/grey/edited/ball-red.png",e.image=t,this.gameParamsJson.customObjectTypes.push(e),this.updateObjectTypesWithMiniatures()},e.prototype.deleteCustomObjectType=function(e){this.gameParamsJson.customObjectTypes.splice(e,1),this.updateObjectTypesWithMiniatures()},e.prototype.editCustomObjectType=function(e){this.setCurrentTab("CUSTOM_OBJECT_TYPES"),this.setCurrentTab2("CUSTOM_OBJECT_TYPE_PROPERTIES");var t=this.gameParamsJson.customObjectTypes[e];this.oldCustomObjectType=t,this.newCustomObjectType=JSON.parse(JSON.stringify(t)),this.currentCustomObjectTypeIndex=e},e.prototype.validateCustomObjectType=function(){if(this.errorMessage=null,this.errorField=null,0==this.newCustomObjectType.applyGravity)for(var e=this.oldCustomObjectType.behaviours,t=0;t<e.length;t++){if("JUMP_ON_PLATFORM"==e[t].type)return this.errorMessage='The object type has a "JUMP_ON_PLATFORM" behaviour but the field "apply gravity" is not checked. Check the field "apply gravity" above, or remove the behaviour "JUMP_ON_PLATFORM".',this.errorField="applyGravity",!1}return!0},e.prototype.updateCustomObjectType=function(){this.validateCustomObjectType()&&(this.setCurrentTab("CUSTOM_OBJECT_TYPES"),this.oldCustomObjectType.id=this.newCustomObjectType.id,this.oldCustomObjectType.width=Number(this.newCustomObjectType.width),this.oldCustomObjectType.height=Number(this.newCustomObjectType.height),this.oldCustomObjectType.electricCharge=Number(this.newCustomObjectType.electricCharge),this.oldCustomObjectType.mass=Number(this.newCustomObjectType.mass),this.oldCustomObjectType.alpha=Number(this.newCustomObjectType.alpha),this.oldCustomObjectType.applyGravity=this.newCustomObjectType.applyGravity,this.oldCustomObjectType.renderType=this.newCustomObjectType.renderType,this.oldCustomObjectType.drawType=this.newCustomObjectType.drawType,this.oldCustomObjectType.borderSize=Number(this.newCustomObjectType.borderSize),this.oldCustomObjectType.image.imageSourceType=this.newCustomObjectType.image.imageSourceType,this.oldCustomObjectType.image.imageId=this.newCustomObjectType.image.imageId,this.newCustomObjectType.image.imageSourceType==I.default.UPLOAD?this.oldCustomObjectType.image.customImage=this.util.findElementByUid(this.gameParamsJson.customImages,this.newCustomObjectType.image.customImage.uid):this.oldCustomObjectType.image.customImage=null,null!=this.newCustomObjectType.color&&(this.oldCustomObjectType.color=new n.default(this.newCustomObjectType.color.red,this.newCustomObjectType.color.green,this.newCustomObjectType.color.blue)),null!=this.newCustomObjectType.borderColor&&(this.oldCustomObjectType.borderColor=new n.default(this.newCustomObjectType.borderColor.red,this.newCustomObjectType.borderColor.green,this.newCustomObjectType.borderColor.blue)),this.oldCustomObjectType=null,this.newCustomObjectType=null,this.updateObjectTypesWithMiniatures(),this.saveJsonToLocalStorage())},e.prototype.cancelChangesCustomObjectType=function(){this.setCurrentTab("CUSTOM_OBJECT_TYPES"),this.oldCustomObjectType=null,this.newCustomObjectType=null},e.prototype.generateSourceCode=function(){var e=new F.default;this.sourceCode=e.generateSourceCode(this.gameParamsJson)},e.prototype.buildJsonDecycled=function(e){var t=this.util.decycle(this.gameParamsJson,void 0);return JSON.stringify(t,null,e)},e.prototype.buildJsonDecycledWithoutResourceData=function(e){var t=this.util.cloneObject(this.gameParamsJson);this.removeImageData(t),this.removeAudioData(t);var i=this.util.decycle(t,void 0);return JSON.stringify(i,null,e)},e.prototype.removeImageData=function(e){for(var t=e.customImages,i=0;i<t.length;i++){t[i].imageData=""}},e.prototype.removeAudioData=function(e){for(var t=e.customAudios,i=0;i<t.length;i++){t[i].audioData=""}},e.prototype.cleanExportedJson=function(){this.gameParamsJsonDecycled=null},e.prototype.downloadGameJSON=function(){this.updateGameUpdatedDate();var e=this.buildJsonDecycled(0),t=this.gameParamsJson.name,i=(t=t.replace(" ","_"))+".json",o=new Blob([e],{type:"text/plain;charset=utf-8"});X.saveAs(o,i)},e.prototype.exportDecycled=function(){this.gameParamsJsonDecycled=this.buildJsonDecycled(4)},e.prototype.importDecycled=function(){var e=this.loadGameDecycled(this.newGameParamsJson);return this.updateCustomImagesWithMiniatures(),this.updateObjectTypesWithMiniatures(),e},e.prototype.cancelImportExport=function(){this.setCurrentScreen(this.currentTab)},e.prototype.splitEngineVersion=function(e){var t=e.substring(1).split(".");return{major:t[0],minor:t[1],patch:t[2]}},e.prototype.loadGameDecycled=function(e){var t,i=this.util.retrocycle(JSON.parse(e)),o=null!==(t=i.engineVersion)&&void 0!==t?t:"v0.1.5",n=this.environment.templateVersion;if("snapshot"!=o&&"snapshot"!=n){var s=this.splitEngineVersion(o),r=this.splitEngineVersion(n);if(s.major!=r.major)return{success:!1,sourceEngineVersion:o};if(s.minor!=r.minor)return{success:!1,sourceEngineVersion:o}}return this.gameParamsJson=i,{success:!0}},e.prototype.setGame=function(e){this.game=e,this.gameName=e.name.S,this.gameDescription=e.description.S,this.gameThumbnail=e.thumbnail.S,this.gameId=e.id.S,this.loadGameDecycled(e.paramsJson.S)},e.prototype.updateGameParamsJson=function(){this.gameParamsJson=JSON.parse(this.newGameParamsJson)},e.prototype.loadButtons=function(){this.buttons=[];for(var e=0;e<this.gameParamsJson.levels.length;e++)for(var t=this.gameParamsJson.levels[e],i=0;i<t.buttons.length;i++){var o=t.buttons[i];this.buttons.push(o)}},e.prototype.getLocalVariablesByBlock=function(e){var t=new Array;if(e.blockType==J.default.LOOP){var i=e.loopBlock;if(i.loop.type==O.default.OBJECT)(o=new m.default).type=S.default.CUSTOM_OBJECT_TYPE,o.name=i.loop.loopVariableName,i.loop.objectSelectorDefinition.type==g.default.ALL_OBJECTS_OF_TYPE&&(o.objectType=i.loop.objectSelectorDefinition.objectType),t.push(o);else if(i.loop.type==O.default.NUMBER){var o;(o=new m.default).type=S.default.NUMBER,o.name=i.loop.loopVariableName,t.push(o)}}else e.blockType,J.default.ACTION;var n=e.parentBlock;if(null!=n)for(var s=this.getLocalVariablesByBlock(n),r=0;r<s.length;r++){var a=s[r];t.push(a)}return t},e.prototype.loadLoopObjectVariables=function(e){var t=this.currentLocalVariables.find((function(t){return t.name==e}));null!=t&&null!=t.objectType&&(this.objectVariables=t.objectType.objectVariables)},e.prototype.loadObjectVariables=function(e){var t=this.gameParamsJson.customObjectTypes.find((function(t){return t.uid==e}));this.objectVariables=t.objectVariables},e.prototype.initGame=function(e){this.saveJsonToLocalStorage(),null!=this.actionTemplate&&this.actionTemplate.game.stopAllAudios();var t=new u.default;null!=this.gameParamsJson&&(t=this.gameParamsJson);var i=new o.default(null,t,this.ctx,this.resourcesBaseUrl,this.isExported,e);i.game.updateProcessEventsSourceCode(),this.actionTemplate=i,this.gameDefinition=t,this.isPlayingGame=!0},e.prototype.setIsExported=function(e){this.isExported=e},e.prototype.playCurrentLevel=function(){this.initGame(this.currentLevelIndex)},e.prototype.playLevel=function(e){this.initGame(e)},e.prototype.editGame=function(){this.actionTemplate.game.stopAllAudios(),this.actionTemplate=null,this.isPlayingGame=!1},e.prototype.removeEventListeners=function(){document.removeEventListener("keydown",this.keydown,!1),document.removeEventListener("keyup",this.keyup,!1)},e.prototype.listImageIds=function(){return this.util.listImageIds(this.gameParamsJson)},e.prototype.listLibraryAudioPaths=function(){return this.util.listAudios(this.gameParamsJson,M.default.LIBRARY)},e.prototype.listCustomAudioUids=function(){return this.util.listAudios(this.gameParamsJson,M.default.UPLOAD)},e}();t.ActionTemplateController=W},function(e,t,i){"use strict";t.__esModule=!0;var o=i(36),n=i(39),s=i(40),r=i(0),a=function(){function e(e,t,i,a,l,u){this.mousePos=null,this.postScore=e,this.postedScore=!1,this.isExported=l;var c=this;this.game=new o.default(t,i,a,l),this.game.loadResources((function(){c.play=new s.default(c.game),null!=u&&c.play.goToLevelIndex(u),window.document.getElementById("myCanvas").style.cursor="default"})),this.ctx=i,this.util=new r.default,this.gameRenderer=new n.default}return e.prototype.getScore=function(){return null==this.play?0:this.play.score},e.prototype.setMousePos=function(e){if(null==this.play)return this.mousePos=e,void(this.gameRenderer.mousePos=e);this.play.mousePos=e},e.prototype.updateAccelerometer=function(e,t,i){null!=this.play&&(this.play.accelerometer.x=e,this.play.accelerometer.y=t,this.play.accelerometer.z=i)},e.prototype.updateGame=function(){null!=this.play&&this.play.update()},e.prototype.loop=function(){this.ctx;null==this.play||this.play.paused||(this.play.gameOver?this.postedScore||(this.postedScore=!0):(this.play.clearCustomElementsToDraw(),this.updateGame())),null!=this.play?this.gameRenderer.render(this.play.level):this.gameRenderer.renderLoading(this.game)},e.prototype.startNewGame=function(){this.play=new s.default(this.game),this.postedScore=!1},e.prototype.keydown=function(e){if(null!=this.play){var t=this.play;t.game;t.registerKeyDown(e.code),"Enter"==e.code&&t.gameOver&&this.startNewGame(),"KeyP"==e.code&&(t.paused=!t.paused)}},e.prototype.keyup=function(e){if(null!=this.play){var t=this.play;t.game;t.registerKeyUp(e.code)}},e.prototype.click=function(){},e.prototype.mousemove=function(e){if(this.setMousePos(e),null==this.play){var t=this.gameRenderer.isInsideLogo(e.x,e.y);window.document.getElementById("myCanvas").style.cursor=t?"pointer":"default"}},e.prototype.mousedown=function(){if(null!=this.play){var e=this.play;e.game;e.mouseDownList.push("mouseDown"),e.isLeftMouseButtonDown=!0}else{this.gameRenderer.isInsideLogo(this.mousePos.x,this.mousePos.y)&&window.open("https://www.easygamemaker.com")}},e.prototype.mouseup=function(){if(null!=this.play){var e=this.play;e.game;e.mouseUpList.push("mouseUp"),e.isLeftMouseButtonDown=!1}},e}();t.default=a},function(e,t,i){"use strict";t.__esModule=!0;var o=i(37),n=i(0),s=i(7),r=i(11),a=function(){function e(e,t,i,o){this.images=new Map,this.numImagesLoaded=0,this.numImages=null,this.resourcesBaseUrl=null,this.imageIds=null,this.audios=new Map,this.numAudiosLoaded=0,this.numAudios=null,this.audioPathsArray=null,this.audioUidsArray=null,this.levelScriptsOnLevelStart=new Map,this.levelScriptsOnAnimationFrame=new Map,this.objectScriptsOnCreate=new Map,this.objectScriptsOnAnimationFrame=new Map,this.util=new n.default,this.ctx=t,this.gameDefinition=e,this.resourcesBaseUrl=i,this.isGameExported=o}return e.prototype.updateProcessEventsSourceCode=function(){this.levelScriptsOnLevelStart=new Map,this.levelScriptsOnAnimationFrame=new Map;for(var e=new r.default,t=this.gameDefinition.levels,i=0;i<t.length;i++){var o=t[i],n=o.scriptOnAnimationFrame,s=e.generateVisualScriptSourceCode(n,this.gameDefinition,0),a=new Function("play",s);this.levelScriptsOnAnimationFrame.set(o.uid,a);var l=o.scriptOnLevelStart,u=e.generateVisualScriptSourceCode(l,this.gameDefinition,0),c=new Function("play",u);this.levelScriptsOnLevelStart.set(o.uid,c)}},e.prototype.loadResources=function(e){var t=this;this.imageIds=this.util.listImageIds(this.gameDefinition),this.numImages=this.imageIds.size;var i=this.util.listAudios(this.gameDefinition,s.default.LIBRARY);this.audioPathsArray=Array.from(i);var o=this.util.listAudios(this.gameDefinition,s.default.UPLOAD);this.audioUidsArray=Array.from(o),this.numAudios=this.audioPathsArray.length+this.audioUidsArray.length;this.loadImages((function(){t.loadAudios(e)}))},e.prototype.loadImages=function(e){var t=this;if(0!=this.imageIds.size)for(var i=Array.from(this.imageIds),o=0;o<i.length;o++){var n=i[o],s=new Image;if(s.onload=function(){t.numImagesLoaded++,t.isImageLoadingCompleted()&&e()},n.startsWith("custom:"))if(this.isGameExported){r=n.substring(7);s.src=this.resourcesBaseUrl+"images/custom/"+r+".png"}else{var r=n.substring(7),a=this.util.findElementByUid(this.gameDefinition.customImages,r);s.src=a.imageData}else s.src=this.resourcesBaseUrl+n;this.images.set(n,s)}else e()},e.prototype.getImage=function(e){return this.images.get(e)},e.prototype.isImageLoadingCompleted=function(){return this.numImagesLoaded==this.numImages},e.prototype.isAudioLoadingCompleted=function(){return this.numAudiosLoaded==this.numAudios},e.prototype.isLoadingCompleted=function(){return this.isImageLoadingCompleted()&&this.isAudioLoadingCompleted()},e.prototype.loadAudios=function(e){if(0!=this.numAudios){for(var t=0;t<this.audioPathsArray.length;t++){var i=this.audioPathsArray[t];this.loadLibraryAudio(i,e)}for(t=0;t<this.audioUidsArray.length;t++){var o=this.audioUidsArray[t];this.loadCustomAudio(o,e)}}else e()},e.prototype.updateNumAudiosLoaded=function(e,t){if("loaded"==e.state())this.numAudiosLoaded++,this.isAudioLoadingCompleted()&&t();else{var i=this;e.once("load",(function(){i.numAudiosLoaded++,i.isAudioLoadingCompleted()&&t()}))}},e.prototype.loadLibraryAudio=function(e,t){var i=this.resourcesBaseUrl+e,n=new o.Howl({src:[i]});this.audios.set(e,n),this.updateNumAudiosLoaded(n,t)},e.prototype.loadCustomAudio=function(e,t){if(this.isGameExported){var i="audio/custom/"+e+".mp3",n=this.resourcesBaseUrl+i;r=new o.Howl({src:[n]});this.audios.set(e,r),this.updateNumAudiosLoaded(r,t)}else{var s=this.util.findElementByUid(this.gameDefinition.customAudios,e),r=new o.Howl({src:[s.audioData]});this.audios.set(s.uid,r),this.updateNumAudiosLoaded(r,t)}},e.prototype.playCustomAudio=function(e,t){var i=this.audios.get(e);if(null!=i){var o=i.play();i.volume(.01*t,o)}else console.log("Custom audio not found: "+e)},e.prototype.playLibraryAudio=function(e,t){var i=this.audios.get(e);if(null!=i){var o=i.play();i.volume(.01*t,o)}else console.log("Library audio not found: "+e)},e.prototype.stopAudio=function(e){var t=this.audios.get(e);null!=t?t.stop():console.log("Library key not found: "+e)},e.prototype.stopAllAudios=function(){for(var e=this.audios.keys(),t=Array.from(e),i=0;i<t.length;i++){var o=t[i];this.stopAudio(o)}},e}();t.default=a},function(e,t,i){(function(i){var o;
/*!
 *  howler.js v2.2.3
 *  howlerjs.com
 *
 *  (c) 2013-2020, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */!function(){"use strict";var n=function(){this.init()};n.prototype={init:function(){var e=this||s;return e._counter=1e3,e._html5AudioPool=[],e.html5PoolSize=10,e._codecs={},e._howls=[],e._muted=!1,e._volume=1,e._canPlayEvent="canplaythrough",e._navigator="undefined"!=typeof window&&window.navigator?window.navigator:null,e.masterGain=null,e.noAudio=!1,e.usingWebAudio=!0,e.autoSuspend=!0,e.ctx=null,e.autoUnlock=!0,e._setup(),e},volume:function(e){var t=this||s;if(e=parseFloat(e),t.ctx||p(),void 0!==e&&e>=0&&e<=1){if(t._volume=e,t._muted)return t;t.usingWebAudio&&t.masterGain.gain.setValueAtTime(e,s.ctx.currentTime);for(var i=0;i<t._howls.length;i++)if(!t._howls[i]._webAudio)for(var o=t._howls[i]._getSoundIds(),n=0;n<o.length;n++){var r=t._howls[i]._soundById(o[n]);r&&r._node&&(r._node.volume=r._volume*e)}return t}return t._volume},mute:function(e){var t=this||s;t.ctx||p(),t._muted=e,t.usingWebAudio&&t.masterGain.gain.setValueAtTime(e?0:t._volume,s.ctx.currentTime);for(var i=0;i<t._howls.length;i++)if(!t._howls[i]._webAudio)for(var o=t._howls[i]._getSoundIds(),n=0;n<o.length;n++){var r=t._howls[i]._soundById(o[n]);r&&r._node&&(r._node.muted=!!e||r._muted)}return t},stop:function(){for(var e=this||s,t=0;t<e._howls.length;t++)e._howls[t].stop();return e},unload:function(){for(var e=this||s,t=e._howls.length-1;t>=0;t--)e._howls[t].unload();return e.usingWebAudio&&e.ctx&&void 0!==e.ctx.close&&(e.ctx.close(),e.ctx=null,p()),e},codecs:function(e){return(this||s)._codecs[e.replace(/^x-/,"")]},_setup:function(){var e=this||s;if(e.state=e.ctx&&e.ctx.state||"suspended",e._autoSuspend(),!e.usingWebAudio)if("undefined"!=typeof Audio)try{void 0===(new Audio).oncanplaythrough&&(e._canPlayEvent="canplay")}catch(t){e.noAudio=!0}else e.noAudio=!0;try{(new Audio).muted&&(e.noAudio=!0)}catch(e){}return e.noAudio||e._setupCodecs(),e},_setupCodecs:function(){var e=this||s,t=null;try{t="undefined"!=typeof Audio?new Audio:null}catch(t){return e}if(!t||"function"!=typeof t.canPlayType)return e;var i=t.canPlayType("audio/mpeg;").replace(/^no$/,""),o=e._navigator?e._navigator.userAgent:"",n=o.match(/OPR\/([0-6].)/g),r=n&&parseInt(n[0].split("/")[1],10)<33,a=-1!==o.indexOf("Safari")&&-1===o.indexOf("Chrome"),l=o.match(/Version\/(.*?) /),u=a&&l&&parseInt(l[1],10)<15;return e._codecs={mp3:!(r||!i&&!t.canPlayType("audio/mp3;").replace(/^no$/,"")),mpeg:!!i,opus:!!t.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!t.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!t.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(t.canPlayType('audio/wav; codecs="1"')||t.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!t.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!t.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(t.canPlayType("audio/x-m4a;")||t.canPlayType("audio/m4a;")||t.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(t.canPlayType("audio/x-m4b;")||t.canPlayType("audio/m4b;")||t.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(t.canPlayType("audio/x-mp4;")||t.canPlayType("audio/mp4;")||t.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!(u||!t.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:!(u||!t.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:!!t.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(t.canPlayType("audio/x-flac;")||t.canPlayType("audio/flac;")).replace(/^no$/,"")},e},_unlockAudio:function(){var e=this||s;if(!e._audioUnlocked&&e.ctx){e._audioUnlocked=!1,e.autoUnlock=!1,e._mobileUnloaded||44100===e.ctx.sampleRate||(e._mobileUnloaded=!0,e.unload()),e._scratchBuffer=e.ctx.createBuffer(1,1,22050);var t=function(i){for(;e._html5AudioPool.length<e.html5PoolSize;)try{var o=new Audio;o._unlocked=!0,e._releaseHtml5Audio(o)}catch(i){e.noAudio=!0;break}for(var n=0;n<e._howls.length;n++)if(!e._howls[n]._webAudio)for(var s=e._howls[n]._getSoundIds(),r=0;r<s.length;r++){var a=e._howls[n]._soundById(s[r]);a&&a._node&&!a._node._unlocked&&(a._node._unlocked=!0,a._node.load())}e._autoResume();var l=e.ctx.createBufferSource();l.buffer=e._scratchBuffer,l.connect(e.ctx.destination),void 0===l.start?l.noteOn(0):l.start(0),"function"==typeof e.ctx.resume&&e.ctx.resume(),l.onended=function(){l.disconnect(0),e._audioUnlocked=!0,document.removeEventListener("touchstart",t,!0),document.removeEventListener("touchend",t,!0),document.removeEventListener("click",t,!0),document.removeEventListener("keydown",t,!0);for(var i=0;i<e._howls.length;i++)e._howls[i]._emit("unlock")}};return document.addEventListener("touchstart",t,!0),document.addEventListener("touchend",t,!0),document.addEventListener("click",t,!0),document.addEventListener("keydown",t,!0),e}},_obtainHtml5Audio:function(){var e=this||s;if(e._html5AudioPool.length)return e._html5AudioPool.pop();var t=(new Audio).play();return t&&"undefined"!=typeof Promise&&(t instanceof Promise||"function"==typeof t.then)&&t.catch((function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")})),new Audio},_releaseHtml5Audio:function(e){var t=this||s;return e._unlocked&&t._html5AudioPool.push(e),t},_autoSuspend:function(){var e=this;if(e.autoSuspend&&e.ctx&&void 0!==e.ctx.suspend&&s.usingWebAudio){for(var t=0;t<e._howls.length;t++)if(e._howls[t]._webAudio)for(var i=0;i<e._howls[t]._sounds.length;i++)if(!e._howls[t]._sounds[i]._paused)return e;return e._suspendTimer&&clearTimeout(e._suspendTimer),e._suspendTimer=setTimeout((function(){if(e.autoSuspend){e._suspendTimer=null,e.state="suspending";var t=function(){e.state="suspended",e._resumeAfterSuspend&&(delete e._resumeAfterSuspend,e._autoResume())};e.ctx.suspend().then(t,t)}}),3e4),e}},_autoResume:function(){var e=this;if(e.ctx&&void 0!==e.ctx.resume&&s.usingWebAudio)return"running"===e.state&&"interrupted"!==e.ctx.state&&e._suspendTimer?(clearTimeout(e._suspendTimer),e._suspendTimer=null):"suspended"===e.state||"running"===e.state&&"interrupted"===e.ctx.state?(e.ctx.resume().then((function(){e.state="running";for(var t=0;t<e._howls.length;t++)e._howls[t]._emit("resume")})),e._suspendTimer&&(clearTimeout(e._suspendTimer),e._suspendTimer=null)):"suspending"===e.state&&(e._resumeAfterSuspend=!0),e}};var s=new n,r=function(e){e.src&&0!==e.src.length?this.init(e):console.error("An array of source files must be passed with any new Howl.")};r.prototype={init:function(e){var t=this;return s.ctx||p(),t._autoplay=e.autoplay||!1,t._format="string"!=typeof e.format?e.format:[e.format],t._html5=e.html5||!1,t._muted=e.mute||!1,t._loop=e.loop||!1,t._pool=e.pool||5,t._preload="boolean"!=typeof e.preload&&"metadata"!==e.preload||e.preload,t._rate=e.rate||1,t._sprite=e.sprite||{},t._src="string"!=typeof e.src?e.src:[e.src],t._volume=void 0!==e.volume?e.volume:1,t._xhr={method:e.xhr&&e.xhr.method?e.xhr.method:"GET",headers:e.xhr&&e.xhr.headers?e.xhr.headers:null,withCredentials:!(!e.xhr||!e.xhr.withCredentials)&&e.xhr.withCredentials},t._duration=0,t._state="unloaded",t._sounds=[],t._endTimers={},t._queue=[],t._playLock=!1,t._onend=e.onend?[{fn:e.onend}]:[],t._onfade=e.onfade?[{fn:e.onfade}]:[],t._onload=e.onload?[{fn:e.onload}]:[],t._onloaderror=e.onloaderror?[{fn:e.onloaderror}]:[],t._onplayerror=e.onplayerror?[{fn:e.onplayerror}]:[],t._onpause=e.onpause?[{fn:e.onpause}]:[],t._onplay=e.onplay?[{fn:e.onplay}]:[],t._onstop=e.onstop?[{fn:e.onstop}]:[],t._onmute=e.onmute?[{fn:e.onmute}]:[],t._onvolume=e.onvolume?[{fn:e.onvolume}]:[],t._onrate=e.onrate?[{fn:e.onrate}]:[],t._onseek=e.onseek?[{fn:e.onseek}]:[],t._onunlock=e.onunlock?[{fn:e.onunlock}]:[],t._onresume=[],t._webAudio=s.usingWebAudio&&!t._html5,void 0!==s.ctx&&s.ctx&&s.autoUnlock&&s._unlockAudio(),s._howls.push(t),t._autoplay&&t._queue.push({event:"play",action:function(){t.play()}}),t._preload&&"none"!==t._preload&&t.load(),t},load:function(){var e=null;if(s.noAudio)this._emit("loaderror",null,"No audio support.");else{"string"==typeof this._src&&(this._src=[this._src]);for(var t=0;t<this._src.length;t++){var i,o;if(this._format&&this._format[t])i=this._format[t];else{if("string"!=typeof(o=this._src[t])){this._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}(i=/^data:audio\/([^;,]+);/i.exec(o))||(i=/\.([^.]+)$/.exec(o.split("?",1)[0])),i&&(i=i[1].toLowerCase())}if(i||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),i&&s.codecs(i)){e=this._src[t];break}}if(e)return this._src=e,this._state="loading","https:"===window.location.protocol&&"http:"===e.slice(0,5)&&(this._html5=!0,this._webAudio=!1),new a(this),this._webAudio&&u(this),this;this._emit("loaderror",null,"No codec support for selected audio sources.")}},play:function(e,t){var i=this,o=null;if("number"==typeof e)o=e,e=null;else{if("string"==typeof e&&"loaded"===i._state&&!i._sprite[e])return null;if(void 0===e&&(e="__default",!i._playLock)){for(var n=0,r=0;r<i._sounds.length;r++)i._sounds[r]._paused&&!i._sounds[r]._ended&&(n++,o=i._sounds[r]._id);1===n?e=null:o=null}}var a=o?i._soundById(o):i._inactiveSound();if(!a)return null;if(o&&!e&&(e=a._sprite||"__default"),"loaded"!==i._state){a._sprite=e,a._ended=!1;var l=a._id;return i._queue.push({event:"play",action:function(){i.play(l)}}),l}if(o&&!a._paused)return t||i._loadQueue("play"),a._id;i._webAudio&&s._autoResume();var u=Math.max(0,a._seek>0?a._seek:i._sprite[e][0]/1e3),c=Math.max(0,(i._sprite[e][0]+i._sprite[e][1])/1e3-u),d=1e3*c/Math.abs(a._rate),h=i._sprite[e][0]/1e3,p=(i._sprite[e][0]+i._sprite[e][1])/1e3;a._sprite=e,a._ended=!1;var f=function(){a._paused=!1,a._seek=u,a._start=h,a._stop=p,a._loop=!(!a._loop&&!i._sprite[e][2])};if(!(u>=p)){var m=a._node;if(i._webAudio){var v=function(){i._playLock=!1,f(),i._refreshBuffer(a);var e=a._muted||i._muted?0:a._volume;m.gain.setValueAtTime(e,s.ctx.currentTime),a._playStart=s.ctx.currentTime,void 0===m.bufferSource.start?a._loop?m.bufferSource.noteGrainOn(0,u,86400):m.bufferSource.noteGrainOn(0,u,c):a._loop?m.bufferSource.start(0,u,86400):m.bufferSource.start(0,u,c),d!==1/0&&(i._endTimers[a._id]=setTimeout(i._ended.bind(i,a),d)),t||setTimeout((function(){i._emit("play",a._id),i._loadQueue()}),0)};"running"===s.state&&"interrupted"!==s.ctx.state?v():(i._playLock=!0,i.once("resume",v),i._clearTimer(a._id))}else{var y=function(){m.currentTime=u,m.muted=a._muted||i._muted||s._muted||m.muted,m.volume=a._volume*s.volume(),m.playbackRate=a._rate;try{var o=m.play();if(o&&"undefined"!=typeof Promise&&(o instanceof Promise||"function"==typeof o.then)?(i._playLock=!0,f(),o.then((function(){i._playLock=!1,m._unlocked=!0,t?i._loadQueue():i._emit("play",a._id)})).catch((function(){i._playLock=!1,i._emit("playerror",a._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),a._ended=!0,a._paused=!0}))):t||(i._playLock=!1,f(),i._emit("play",a._id)),m.playbackRate=a._rate,m.paused)return void i._emit("playerror",a._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");"__default"!==e||a._loop?i._endTimers[a._id]=setTimeout(i._ended.bind(i,a),d):(i._endTimers[a._id]=function(){i._ended(a),m.removeEventListener("ended",i._endTimers[a._id],!1)},m.addEventListener("ended",i._endTimers[a._id],!1))}catch(e){i._emit("playerror",a._id,e)}};"data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"===m.src&&(m.src=i._src,m.load());var E=window&&window.ejecta||!m.readyState&&s._navigator.isCocoonJS;if(m.readyState>=3||E)y();else{i._playLock=!0,i._state="loading";var g=function(){i._state="loaded",y(),m.removeEventListener(s._canPlayEvent,g,!1)};m.addEventListener(s._canPlayEvent,g,!1),i._clearTimer(a._id)}}return a._id}i._ended(a)},pause:function(e){var t=this;if("loaded"!==t._state||t._playLock)return t._queue.push({event:"pause",action:function(){t.pause(e)}}),t;for(var i=t._getSoundIds(e),o=0;o<i.length;o++){t._clearTimer(i[o]);var n=t._soundById(i[o]);if(n&&!n._paused&&(n._seek=t.seek(i[o]),n._rateSeek=0,n._paused=!0,t._stopFade(i[o]),n._node))if(t._webAudio){if(!n._node.bufferSource)continue;void 0===n._node.bufferSource.stop?n._node.bufferSource.noteOff(0):n._node.bufferSource.stop(0),t._cleanBuffer(n._node)}else isNaN(n._node.duration)&&n._node.duration!==1/0||n._node.pause();arguments[1]||t._emit("pause",n?n._id:null)}return t},stop:function(e,t){var i=this;if("loaded"!==i._state||i._playLock)return i._queue.push({event:"stop",action:function(){i.stop(e)}}),i;for(var o=i._getSoundIds(e),n=0;n<o.length;n++){i._clearTimer(o[n]);var s=i._soundById(o[n]);s&&(s._seek=s._start||0,s._rateSeek=0,s._paused=!0,s._ended=!0,i._stopFade(o[n]),s._node&&(i._webAudio?s._node.bufferSource&&(void 0===s._node.bufferSource.stop?s._node.bufferSource.noteOff(0):s._node.bufferSource.stop(0),i._cleanBuffer(s._node)):isNaN(s._node.duration)&&s._node.duration!==1/0||(s._node.currentTime=s._start||0,s._node.pause(),s._node.duration===1/0&&i._clearSound(s._node))),t||i._emit("stop",s._id))}return i},mute:function(e,t){var i=this;if("loaded"!==i._state||i._playLock)return i._queue.push({event:"mute",action:function(){i.mute(e,t)}}),i;if(void 0===t){if("boolean"!=typeof e)return i._muted;i._muted=e}for(var o=i._getSoundIds(t),n=0;n<o.length;n++){var r=i._soundById(o[n]);r&&(r._muted=e,r._interval&&i._stopFade(r._id),i._webAudio&&r._node?r._node.gain.setValueAtTime(e?0:r._volume,s.ctx.currentTime):r._node&&(r._node.muted=!!s._muted||e),i._emit("mute",r._id))}return i},volume:function(){var e,t,i,o=this,n=arguments;if(0===n.length)return o._volume;if(1===n.length||2===n.length&&void 0===n[1]){var r=o._getSoundIds(),a=r.indexOf(n[0]);a>=0?t=parseInt(n[0],10):e=parseFloat(n[0])}else n.length>=2&&(e=parseFloat(n[0]),t=parseInt(n[1],10));if(!(void 0!==e&&e>=0&&e<=1))return(i=t?o._soundById(t):o._sounds[0])?i._volume:0;if("loaded"!==o._state||o._playLock)return o._queue.push({event:"volume",action:function(){o.volume.apply(o,n)}}),o;void 0===t&&(o._volume=e),t=o._getSoundIds(t);for(var l=0;l<t.length;l++)(i=o._soundById(t[l]))&&(i._volume=e,n[2]||o._stopFade(t[l]),o._webAudio&&i._node&&!i._muted?i._node.gain.setValueAtTime(e,s.ctx.currentTime):i._node&&!i._muted&&(i._node.volume=e*s.volume()),o._emit("volume",i._id));return o},fade:function(e,t,i,o){var n=this;if("loaded"!==n._state||n._playLock)return n._queue.push({event:"fade",action:function(){n.fade(e,t,i,o)}}),n;e=Math.min(Math.max(0,parseFloat(e)),1),t=Math.min(Math.max(0,parseFloat(t)),1),i=parseFloat(i),n.volume(e,o);for(var r=n._getSoundIds(o),a=0;a<r.length;a++){var l=n._soundById(r[a]);if(l){if(o||n._stopFade(r[a]),n._webAudio&&!l._muted){var u=s.ctx.currentTime,c=u+i/1e3;l._volume=e,l._node.gain.setValueAtTime(e,u),l._node.gain.linearRampToValueAtTime(t,c)}n._startFadeInterval(l,e,t,i,r[a],void 0===o)}}return n},_startFadeInterval:function(e,t,i,o,n,s){var r=this,a=t,l=i-t,u=Math.abs(l/.01),c=Math.max(4,u>0?o/u:o),d=Date.now();e._fadeTo=i,e._interval=setInterval((function(){var n=(Date.now()-d)/o;d=Date.now(),a+=l*n,a=Math.round(100*a)/100,a=l<0?Math.max(i,a):Math.min(i,a),r._webAudio?e._volume=a:r.volume(a,e._id,!0),s&&(r._volume=a),(i<t&&a<=i||i>t&&a>=i)&&(clearInterval(e._interval),e._interval=null,e._fadeTo=null,r.volume(i,e._id),r._emit("fade",e._id))}),c)},_stopFade:function(e){var t=this._soundById(e);return t&&t._interval&&(this._webAudio&&t._node.gain.cancelScheduledValues(s.ctx.currentTime),clearInterval(t._interval),t._interval=null,this.volume(t._fadeTo,e),t._fadeTo=null,this._emit("fade",e)),this},loop:function(){var e,t,i,o=this,n=arguments;if(0===n.length)return o._loop;if(1===n.length){if("boolean"!=typeof n[0])return!!(i=o._soundById(parseInt(n[0],10)))&&i._loop;e=n[0],o._loop=e}else 2===n.length&&(e=n[0],t=parseInt(n[1],10));for(var s=o._getSoundIds(t),r=0;r<s.length;r++)(i=o._soundById(s[r]))&&(i._loop=e,o._webAudio&&i._node&&i._node.bufferSource&&(i._node.bufferSource.loop=e,e&&(i._node.bufferSource.loopStart=i._start||0,i._node.bufferSource.loopEnd=i._stop,o.playing(s[r])&&(o.pause(s[r],!0),o.play(s[r],!0)))));return o},rate:function(){var e,t,i,o=this,n=arguments;if(0===n.length)t=o._sounds[0]._id;else if(1===n.length){var r=o._getSoundIds(),a=r.indexOf(n[0]);a>=0?t=parseInt(n[0],10):e=parseFloat(n[0])}else 2===n.length&&(e=parseFloat(n[0]),t=parseInt(n[1],10));if("number"!=typeof e)return(i=o._soundById(t))?i._rate:o._rate;if("loaded"!==o._state||o._playLock)return o._queue.push({event:"rate",action:function(){o.rate.apply(o,n)}}),o;void 0===t&&(o._rate=e),t=o._getSoundIds(t);for(var l=0;l<t.length;l++)if(i=o._soundById(t[l])){o.playing(t[l])&&(i._rateSeek=o.seek(t[l]),i._playStart=o._webAudio?s.ctx.currentTime:i._playStart),i._rate=e,o._webAudio&&i._node&&i._node.bufferSource?i._node.bufferSource.playbackRate.setValueAtTime(e,s.ctx.currentTime):i._node&&(i._node.playbackRate=e);var u=o.seek(t[l]),c=(o._sprite[i._sprite][0]+o._sprite[i._sprite][1])/1e3-u,d=1e3*c/Math.abs(i._rate);!o._endTimers[t[l]]&&i._paused||(o._clearTimer(t[l]),o._endTimers[t[l]]=setTimeout(o._ended.bind(o,i),d)),o._emit("rate",i._id)}return o},seek:function(){var e,t,i=this,o=arguments;if(0===o.length)i._sounds.length&&(t=i._sounds[0]._id);else if(1===o.length){var n=i._getSoundIds(),r=n.indexOf(o[0]);r>=0?t=parseInt(o[0],10):i._sounds.length&&(t=i._sounds[0]._id,e=parseFloat(o[0]))}else 2===o.length&&(e=parseFloat(o[0]),t=parseInt(o[1],10));if(void 0===t)return 0;if("number"==typeof e&&("loaded"!==i._state||i._playLock))return i._queue.push({event:"seek",action:function(){i.seek.apply(i,o)}}),i;var a=i._soundById(t);if(a){if(!("number"==typeof e&&e>=0)){if(i._webAudio){var l=i.playing(t)?s.ctx.currentTime-a._playStart:0,u=a._rateSeek?a._rateSeek-a._seek:0;return a._seek+(u+l*Math.abs(a._rate))}return a._node.currentTime}var c=i.playing(t);c&&i.pause(t,!0),a._seek=e,a._ended=!1,i._clearTimer(t),i._webAudio||!a._node||isNaN(a._node.duration)||(a._node.currentTime=e);var d=function(){c&&i.play(t,!0),i._emit("seek",t)};if(c&&!i._webAudio){var h=function(){i._playLock?setTimeout(h,0):d()};setTimeout(h,0)}else d()}return i},playing:function(e){if("number"==typeof e){var t=this._soundById(e);return!!t&&!t._paused}for(var i=0;i<this._sounds.length;i++)if(!this._sounds[i]._paused)return!0;return!1},duration:function(e){var t=this._duration,i=this._soundById(e);return i&&(t=this._sprite[i._sprite][1]/1e3),t},state:function(){return this._state},unload:function(){for(var e=this,t=e._sounds,i=0;i<t.length;i++)t[i]._paused||e.stop(t[i]._id),e._webAudio||(e._clearSound(t[i]._node),t[i]._node.removeEventListener("error",t[i]._errorFn,!1),t[i]._node.removeEventListener(s._canPlayEvent,t[i]._loadFn,!1),t[i]._node.removeEventListener("ended",t[i]._endFn,!1),s._releaseHtml5Audio(t[i]._node)),delete t[i]._node,e._clearTimer(t[i]._id);var o=s._howls.indexOf(e);o>=0&&s._howls.splice(o,1);var n=!0;for(i=0;i<s._howls.length;i++)if(s._howls[i]._src===e._src||e._src.indexOf(s._howls[i]._src)>=0){n=!1;break}return l&&n&&delete l[e._src],s.noAudio=!1,e._state="unloaded",e._sounds=[],e=null,null},on:function(e,t,i,o){var n=this["_on"+e];return"function"==typeof t&&n.push(o?{id:i,fn:t,once:o}:{id:i,fn:t}),this},off:function(e,t,i){var o=this["_on"+e],n=0;if("number"==typeof t&&(i=t,t=null),t||i)for(n=0;n<o.length;n++){var s=i===o[n].id;if(t===o[n].fn&&s||!t&&s){o.splice(n,1);break}}else if(e)this["_on"+e]=[];else{var r=Object.keys(this);for(n=0;n<r.length;n++)0===r[n].indexOf("_on")&&Array.isArray(this[r[n]])&&(this[r[n]]=[])}return this},once:function(e,t,i){return this.on(e,t,i,1),this},_emit:function(e,t,i){for(var o=this["_on"+e],n=o.length-1;n>=0;n--)o[n].id&&o[n].id!==t&&"load"!==e||(setTimeout(function(e){e.call(this,t,i)}.bind(this,o[n].fn),0),o[n].once&&this.off(e,o[n].fn,o[n].id));return this._loadQueue(e),this},_loadQueue:function(e){if(this._queue.length>0){var t=this._queue[0];t.event===e&&(this._queue.shift(),this._loadQueue()),e||t.action()}return this},_ended:function(e){var t=e._sprite;if(!this._webAudio&&e._node&&!e._node.paused&&!e._node.ended&&e._node.currentTime<e._stop)return setTimeout(this._ended.bind(this,e),100),this;var i=!(!e._loop&&!this._sprite[t][2]);if(this._emit("end",e._id),!this._webAudio&&i&&this.stop(e._id,!0).play(e._id),this._webAudio&&i){this._emit("play",e._id),e._seek=e._start||0,e._rateSeek=0,e._playStart=s.ctx.currentTime;var o=1e3*(e._stop-e._start)/Math.abs(e._rate);this._endTimers[e._id]=setTimeout(this._ended.bind(this,e),o)}return this._webAudio&&!i&&(e._paused=!0,e._ended=!0,e._seek=e._start||0,e._rateSeek=0,this._clearTimer(e._id),this._cleanBuffer(e._node),s._autoSuspend()),this._webAudio||i||this.stop(e._id,!0),this},_clearTimer:function(e){if(this._endTimers[e]){if("function"!=typeof this._endTimers[e])clearTimeout(this._endTimers[e]);else{var t=this._soundById(e);t&&t._node&&t._node.removeEventListener("ended",this._endTimers[e],!1)}delete this._endTimers[e]}return this},_soundById:function(e){for(var t=0;t<this._sounds.length;t++)if(e===this._sounds[t]._id)return this._sounds[t];return null},_inactiveSound:function(){this._drain();for(var e=0;e<this._sounds.length;e++)if(this._sounds[e]._ended)return this._sounds[e].reset();return new a(this)},_drain:function(){var e=this._pool,t=0,i=0;if(!(this._sounds.length<e)){for(i=0;i<this._sounds.length;i++)this._sounds[i]._ended&&t++;for(i=this._sounds.length-1;i>=0;i--){if(t<=e)return;this._sounds[i]._ended&&(this._webAudio&&this._sounds[i]._node&&this._sounds[i]._node.disconnect(0),this._sounds.splice(i,1),t--)}}},_getSoundIds:function(e){if(void 0===e){for(var t=[],i=0;i<this._sounds.length;i++)t.push(this._sounds[i]._id);return t}return[e]},_refreshBuffer:function(e){return e._node.bufferSource=s.ctx.createBufferSource(),e._node.bufferSource.buffer=l[this._src],e._panner?e._node.bufferSource.connect(e._panner):e._node.bufferSource.connect(e._node),e._node.bufferSource.loop=e._loop,e._loop&&(e._node.bufferSource.loopStart=e._start||0,e._node.bufferSource.loopEnd=e._stop||0),e._node.bufferSource.playbackRate.setValueAtTime(e._rate,s.ctx.currentTime),this},_cleanBuffer:function(e){var t=s._navigator&&s._navigator.vendor.indexOf("Apple")>=0;if(s._scratchBuffer&&e.bufferSource&&(e.bufferSource.onended=null,e.bufferSource.disconnect(0),t))try{e.bufferSource.buffer=s._scratchBuffer}catch(e){}return e.bufferSource=null,this},_clearSound:function(e){/MSIE |Trident\//.test(s._navigator&&s._navigator.userAgent)||(e.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var a=function(e){this._parent=e,this.init()};a.prototype={init:function(){var e=this._parent;return this._muted=e._muted,this._loop=e._loop,this._volume=e._volume,this._rate=e._rate,this._seek=0,this._paused=!0,this._ended=!0,this._sprite="__default",this._id=++s._counter,e._sounds.push(this),this.create(),this},create:function(){var e=this._parent,t=s._muted||this._muted||this._parent._muted?0:this._volume;return e._webAudio?(this._node=void 0===s.ctx.createGain?s.ctx.createGainNode():s.ctx.createGain(),this._node.gain.setValueAtTime(t,s.ctx.currentTime),this._node.paused=!0,this._node.connect(s.masterGain)):s.noAudio||(this._node=s._obtainHtml5Audio(),this._errorFn=this._errorListener.bind(this),this._node.addEventListener("error",this._errorFn,!1),this._loadFn=this._loadListener.bind(this),this._node.addEventListener(s._canPlayEvent,this._loadFn,!1),this._endFn=this._endListener.bind(this),this._node.addEventListener("ended",this._endFn,!1),this._node.src=e._src,this._node.preload=!0===e._preload?"auto":e._preload,this._node.volume=t*s.volume(),this._node.load()),this},reset:function(){var e=this._parent;return this._muted=e._muted,this._loop=e._loop,this._volume=e._volume,this._rate=e._rate,this._seek=0,this._rateSeek=0,this._paused=!0,this._ended=!0,this._sprite="__default",this._id=++s._counter,this},_errorListener:function(){this._parent._emit("loaderror",this._id,this._node.error?this._node.error.code:0),this._node.removeEventListener("error",this._errorFn,!1)},_loadListener:function(){var e=this._parent;e._duration=Math.ceil(10*this._node.duration)/10,0===Object.keys(e._sprite).length&&(e._sprite={__default:[0,1e3*e._duration]}),"loaded"!==e._state&&(e._state="loaded",e._emit("load"),e._loadQueue()),this._node.removeEventListener(s._canPlayEvent,this._loadFn,!1)},_endListener:function(){var e=this._parent;e._duration===1/0&&(e._duration=Math.ceil(10*this._node.duration)/10,e._sprite.__default[1]===1/0&&(e._sprite.__default[1]=1e3*e._duration),e._ended(this)),this._node.removeEventListener("ended",this._endFn,!1)}};var l={},u=function(e){var t=e._src;if(l[t])return e._duration=l[t].duration,void h(e);if(/^data:[^;]+;base64,/.test(t)){for(var i=atob(t.split(",")[1]),o=new Uint8Array(i.length),n=0;n<i.length;++n)o[n]=i.charCodeAt(n);d(o.buffer,e)}else{var s=new XMLHttpRequest;s.open(e._xhr.method,t,!0),s.withCredentials=e._xhr.withCredentials,s.responseType="arraybuffer",e._xhr.headers&&Object.keys(e._xhr.headers).forEach((function(t){s.setRequestHeader(t,e._xhr.headers[t])})),s.onload=function(){var t=(s.status+"")[0];"0"===t||"2"===t||"3"===t?d(s.response,e):e._emit("loaderror",null,"Failed loading audio file with status: "+s.status+".")},s.onerror=function(){e._webAudio&&(e._html5=!0,e._webAudio=!1,e._sounds=[],delete l[t],e.load())},c(s)}},c=function(e){try{e.send()}catch(t){e.onerror()}},d=function(e,t){var i=function(){t._emit("loaderror",null,"Decoding audio data failed.")},o=function(e){e&&t._sounds.length>0?(l[t._src]=e,h(t,e)):i()};"undefined"!=typeof Promise&&1===s.ctx.decodeAudioData.length?s.ctx.decodeAudioData(e).then(o).catch(i):s.ctx.decodeAudioData(e,o,i)},h=function(e,t){t&&!e._duration&&(e._duration=t.duration),0===Object.keys(e._sprite).length&&(e._sprite={__default:[0,1e3*e._duration]}),"loaded"!==e._state&&(e._state="loaded",e._emit("load"),e._loadQueue())},p=function(){if(s.usingWebAudio){try{"undefined"!=typeof AudioContext?s.ctx=new AudioContext:"undefined"!=typeof webkitAudioContext?s.ctx=new webkitAudioContext:s.usingWebAudio=!1}catch(e){s.usingWebAudio=!1}s.ctx||(s.usingWebAudio=!1);var e=/iP(hone|od|ad)/.test(s._navigator&&s._navigator.platform),t=s._navigator&&s._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),i=t?parseInt(t[1],10):null;if(e&&i&&i<9){var o=/safari/.test(s._navigator&&s._navigator.userAgent.toLowerCase());s._navigator&&!o&&(s.usingWebAudio=!1)}s.usingWebAudio&&(s.masterGain=void 0===s.ctx.createGain?s.ctx.createGainNode():s.ctx.createGain(),s.masterGain.gain.setValueAtTime(s._muted?0:s._volume,s.ctx.currentTime),s.masterGain.connect(s.ctx.destination)),s._setup()}};void 0===(o=function(){return{Howler:s,Howl:r}}.apply(t,[]))||(e.exports=o),t.Howler=s,t.Howl=r,void 0!==i?(i.HowlerGlobal=n,i.Howler=s,i.Howl=r,i.Sound=a):"undefined"!=typeof window&&(window.HowlerGlobal=n,window.Howler=s,window.Howl=r,window.Sound=a)}(),
/*!
 *  Spatial Plugin - Adds support for stereo and 3D audio where Web Audio is supported.
 *  
 *  howler.js v2.2.3
 *  howlerjs.com
 *
 *  (c) 2013-2020, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */
function(){"use strict";var e;HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(e){if(!this.ctx||!this.ctx.listener)return this;for(var t=this._howls.length-1;t>=0;t--)this._howls[t].stereo(e);return this},HowlerGlobal.prototype.pos=function(e,t,i){return this.ctx&&this.ctx.listener?(t="number"!=typeof t?this._pos[1]:t,i="number"!=typeof i?this._pos[2]:i,"number"!=typeof e?this._pos:(this._pos=[e,t,i],void 0!==this.ctx.listener.positionX?(this.ctx.listener.positionX.setTargetAtTime(this._pos[0],Howler.ctx.currentTime,.1),this.ctx.listener.positionY.setTargetAtTime(this._pos[1],Howler.ctx.currentTime,.1),this.ctx.listener.positionZ.setTargetAtTime(this._pos[2],Howler.ctx.currentTime,.1)):this.ctx.listener.setPosition(this._pos[0],this._pos[1],this._pos[2]),this)):this},HowlerGlobal.prototype.orientation=function(e,t,i,o,n,s){if(!this.ctx||!this.ctx.listener)return this;var r=this._orientation;return t="number"!=typeof t?r[1]:t,i="number"!=typeof i?r[2]:i,o="number"!=typeof o?r[3]:o,n="number"!=typeof n?r[4]:n,s="number"!=typeof s?r[5]:s,"number"!=typeof e?r:(this._orientation=[e,t,i,o,n,s],void 0!==this.ctx.listener.forwardX?(this.ctx.listener.forwardX.setTargetAtTime(e,Howler.ctx.currentTime,.1),this.ctx.listener.forwardY.setTargetAtTime(t,Howler.ctx.currentTime,.1),this.ctx.listener.forwardZ.setTargetAtTime(i,Howler.ctx.currentTime,.1),this.ctx.listener.upX.setTargetAtTime(o,Howler.ctx.currentTime,.1),this.ctx.listener.upY.setTargetAtTime(n,Howler.ctx.currentTime,.1),this.ctx.listener.upZ.setTargetAtTime(s,Howler.ctx.currentTime,.1)):this.ctx.listener.setOrientation(e,t,i,o,n,s),this)},Howl.prototype.init=(e=Howl.prototype.init,function(t){return this._orientation=t.orientation||[1,0,0],this._stereo=t.stereo||null,this._pos=t.pos||null,this._pannerAttr={coneInnerAngle:void 0!==t.coneInnerAngle?t.coneInnerAngle:360,coneOuterAngle:void 0!==t.coneOuterAngle?t.coneOuterAngle:360,coneOuterGain:void 0!==t.coneOuterGain?t.coneOuterGain:0,distanceModel:void 0!==t.distanceModel?t.distanceModel:"inverse",maxDistance:void 0!==t.maxDistance?t.maxDistance:1e4,panningModel:void 0!==t.panningModel?t.panningModel:"HRTF",refDistance:void 0!==t.refDistance?t.refDistance:1,rolloffFactor:void 0!==t.rolloffFactor?t.rolloffFactor:1},this._onstereo=t.onstereo?[{fn:t.onstereo}]:[],this._onpos=t.onpos?[{fn:t.onpos}]:[],this._onorientation=t.onorientation?[{fn:t.onorientation}]:[],e.call(this,t)}),Howl.prototype.stereo=function(e,i){var o=this;if(!o._webAudio)return o;if("loaded"!==o._state)return o._queue.push({event:"stereo",action:function(){o.stereo(e,i)}}),o;var n=void 0===Howler.ctx.createStereoPanner?"spatial":"stereo";if(void 0===i){if("number"!=typeof e)return o._stereo;o._stereo=e,o._pos=[e,0,0]}for(var s=o._getSoundIds(i),r=0;r<s.length;r++){var a=o._soundById(s[r]);if(a){if("number"!=typeof e)return a._stereo;a._stereo=e,a._pos=[e,0,0],a._node&&(a._pannerAttr.panningModel="equalpower",a._panner&&a._panner.pan||t(a,n),"spatial"===n?void 0!==a._panner.positionX?(a._panner.positionX.setValueAtTime(e,Howler.ctx.currentTime),a._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),a._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):a._panner.setPosition(e,0,0):a._panner.pan.setValueAtTime(e,Howler.ctx.currentTime)),o._emit("stereo",a._id)}}return o},Howl.prototype.pos=function(e,i,o,n){var s=this;if(!s._webAudio)return s;if("loaded"!==s._state)return s._queue.push({event:"pos",action:function(){s.pos(e,i,o,n)}}),s;if(i="number"!=typeof i?0:i,o="number"!=typeof o?-.5:o,void 0===n){if("number"!=typeof e)return s._pos;s._pos=[e,i,o]}for(var r=s._getSoundIds(n),a=0;a<r.length;a++){var l=s._soundById(r[a]);if(l){if("number"!=typeof e)return l._pos;l._pos=[e,i,o],l._node&&(l._panner&&!l._panner.pan||t(l,"spatial"),void 0!==l._panner.positionX?(l._panner.positionX.setValueAtTime(e,Howler.ctx.currentTime),l._panner.positionY.setValueAtTime(i,Howler.ctx.currentTime),l._panner.positionZ.setValueAtTime(o,Howler.ctx.currentTime)):l._panner.setPosition(e,i,o)),s._emit("pos",l._id)}}return s},Howl.prototype.orientation=function(e,i,o,n){var s=this;if(!s._webAudio)return s;if("loaded"!==s._state)return s._queue.push({event:"orientation",action:function(){s.orientation(e,i,o,n)}}),s;if(i="number"!=typeof i?s._orientation[1]:i,o="number"!=typeof o?s._orientation[2]:o,void 0===n){if("number"!=typeof e)return s._orientation;s._orientation=[e,i,o]}for(var r=s._getSoundIds(n),a=0;a<r.length;a++){var l=s._soundById(r[a]);if(l){if("number"!=typeof e)return l._orientation;l._orientation=[e,i,o],l._node&&(l._panner||(l._pos||(l._pos=s._pos||[0,0,-.5]),t(l,"spatial")),void 0!==l._panner.orientationX?(l._panner.orientationX.setValueAtTime(e,Howler.ctx.currentTime),l._panner.orientationY.setValueAtTime(i,Howler.ctx.currentTime),l._panner.orientationZ.setValueAtTime(o,Howler.ctx.currentTime)):l._panner.setOrientation(e,i,o)),s._emit("orientation",l._id)}}return s},Howl.prototype.pannerAttr=function(){var e,i,o,n=this,s=arguments;if(!n._webAudio)return n;if(0===s.length)return n._pannerAttr;if(1===s.length){if("object"!=typeof s[0])return(o=n._soundById(parseInt(s[0],10)))?o._pannerAttr:n._pannerAttr;e=s[0],void 0===i&&(e.pannerAttr||(e.pannerAttr={coneInnerAngle:e.coneInnerAngle,coneOuterAngle:e.coneOuterAngle,coneOuterGain:e.coneOuterGain,distanceModel:e.distanceModel,maxDistance:e.maxDistance,refDistance:e.refDistance,rolloffFactor:e.rolloffFactor,panningModel:e.panningModel}),n._pannerAttr={coneInnerAngle:void 0!==e.pannerAttr.coneInnerAngle?e.pannerAttr.coneInnerAngle:n._coneInnerAngle,coneOuterAngle:void 0!==e.pannerAttr.coneOuterAngle?e.pannerAttr.coneOuterAngle:n._coneOuterAngle,coneOuterGain:void 0!==e.pannerAttr.coneOuterGain?e.pannerAttr.coneOuterGain:n._coneOuterGain,distanceModel:void 0!==e.pannerAttr.distanceModel?e.pannerAttr.distanceModel:n._distanceModel,maxDistance:void 0!==e.pannerAttr.maxDistance?e.pannerAttr.maxDistance:n._maxDistance,refDistance:void 0!==e.pannerAttr.refDistance?e.pannerAttr.refDistance:n._refDistance,rolloffFactor:void 0!==e.pannerAttr.rolloffFactor?e.pannerAttr.rolloffFactor:n._rolloffFactor,panningModel:void 0!==e.pannerAttr.panningModel?e.pannerAttr.panningModel:n._panningModel})}else 2===s.length&&(e=s[0],i=parseInt(s[1],10));for(var r=n._getSoundIds(i),a=0;a<r.length;a++)if(o=n._soundById(r[a])){var l=o._pannerAttr;l={coneInnerAngle:void 0!==e.coneInnerAngle?e.coneInnerAngle:l.coneInnerAngle,coneOuterAngle:void 0!==e.coneOuterAngle?e.coneOuterAngle:l.coneOuterAngle,coneOuterGain:void 0!==e.coneOuterGain?e.coneOuterGain:l.coneOuterGain,distanceModel:void 0!==e.distanceModel?e.distanceModel:l.distanceModel,maxDistance:void 0!==e.maxDistance?e.maxDistance:l.maxDistance,refDistance:void 0!==e.refDistance?e.refDistance:l.refDistance,rolloffFactor:void 0!==e.rolloffFactor?e.rolloffFactor:l.rolloffFactor,panningModel:void 0!==e.panningModel?e.panningModel:l.panningModel};var u=o._panner;u?(u.coneInnerAngle=l.coneInnerAngle,u.coneOuterAngle=l.coneOuterAngle,u.coneOuterGain=l.coneOuterGain,u.distanceModel=l.distanceModel,u.maxDistance=l.maxDistance,u.refDistance=l.refDistance,u.rolloffFactor=l.rolloffFactor,u.panningModel=l.panningModel):(o._pos||(o._pos=n._pos||[0,0,-.5]),t(o,"spatial"))}return n},Sound.prototype.init=function(e){return function(){var t=this._parent;this._orientation=t._orientation,this._stereo=t._stereo,this._pos=t._pos,this._pannerAttr=t._pannerAttr,e.call(this),this._stereo?t.stereo(this._stereo):this._pos&&t.pos(this._pos[0],this._pos[1],this._pos[2],this._id)}}(Sound.prototype.init),Sound.prototype.reset=function(e){return function(){var t=this._parent;return this._orientation=t._orientation,this._stereo=t._stereo,this._pos=t._pos,this._pannerAttr=t._pannerAttr,this._stereo?t.stereo(this._stereo):this._pos?t.pos(this._pos[0],this._pos[1],this._pos[2],this._id):this._panner&&(this._panner.disconnect(0),this._panner=void 0,t._refreshBuffer(this)),e.call(this)}}(Sound.prototype.reset);var t=function(e,t){"spatial"===(t=t||"spatial")?(e._panner=Howler.ctx.createPanner(),e._panner.coneInnerAngle=e._pannerAttr.coneInnerAngle,e._panner.coneOuterAngle=e._pannerAttr.coneOuterAngle,e._panner.coneOuterGain=e._pannerAttr.coneOuterGain,e._panner.distanceModel=e._pannerAttr.distanceModel,e._panner.maxDistance=e._pannerAttr.maxDistance,e._panner.refDistance=e._pannerAttr.refDistance,e._panner.rolloffFactor=e._pannerAttr.rolloffFactor,e._panner.panningModel=e._pannerAttr.panningModel,void 0!==e._panner.positionX?(e._panner.positionX.setValueAtTime(e._pos[0],Howler.ctx.currentTime),e._panner.positionY.setValueAtTime(e._pos[1],Howler.ctx.currentTime),e._panner.positionZ.setValueAtTime(e._pos[2],Howler.ctx.currentTime)):e._panner.setPosition(e._pos[0],e._pos[1],e._pos[2]),void 0!==e._panner.orientationX?(e._panner.orientationX.setValueAtTime(e._orientation[0],Howler.ctx.currentTime),e._panner.orientationY.setValueAtTime(e._orientation[1],Howler.ctx.currentTime),e._panner.orientationZ.setValueAtTime(e._orientation[2],Howler.ctx.currentTime)):e._panner.setOrientation(e._orientation[0],e._orientation[1],e._orientation[2])):(e._panner=Howler.ctx.createStereoPanner(),e._panner.pan.setValueAtTime(e._stereo,Howler.ctx.currentTime)),e._panner.connect(e._node),e._paused||e._parent.pause(e._id,!0).play(e._id,!0)}}()}).call(this,i(16))},function(e,t,i){"use strict";t.__esModule=!0;var o=i(12),n=i(18),s=i(0),r=i(13),a=function(){function e(){this.util=new s.default,this.environment=new n.default,this.regexpEngineVersion=new RegExp("{engineVersion}","g"),this.regexpFps=new RegExp("{fps}","g"),this.regexpScore=new RegExp("{score}","g"),this.regexpRandom=new RegExp("{random}","g"),this.regexpAccelerometerX=new RegExp("{accelerometer.x}","g"),this.regexpAccelerometerY=new RegExp("{accelerometer.y}","g"),this.regexpAccelerometerZ=new RegExp("{accelerometer.z}","g"),this.regexpLastTouchX=new RegExp("{lastTouchX}","g"),this.regexpLastTouchY=new RegExp("{lastTouchY}","g"),this.regexpMousePosX=new RegExp("{mousePosX}","g"),this.regexpMousePosY=new RegExp("{mousePosY}","g"),this.regexpScreenX=new RegExp("{screenX}","g"),this.regexpScreenY=new RegExp("{screenY}","g"),this.regexpLoopCurrentIndex=new RegExp("{loop.currentIndex}","g"),this.regexpLevelName=new RegExp("{levelDefinition.name}","g"),this.regexpCurrentLevelFrame=new RegExp("{level.currentFrame}","g"),this.regexLocalStorageVariable=new RegExp("{localStorage.\\w+}"),this.regexDistanceLoopObjects=new RegExp("{distanceLoopObjects\\(\\w+,\\w+\\)}"),this.regexMap=new Map}return e.prototype.findRegexByString=function(e){var t=this.regexMap.get(e);return null==t&&(t=new RegExp(e,"g"),this.regexMap.set(e,t)),t},e.prototype.initObjectVariablesRegexp=function(e){},e.prototype.evaluateExpression=function(e,t,i){return e=this.replaceVariables(e,t,i)},e.prototype.replaceVariables=function(e,t,i){return e=e.replace(this.regexpEngineVersion,this.environment.templateVersion)},e.prototype.replaceVariables_OLD=function(e,t,i){var n=this;e=(e=(e=e.replace(this.regexpScore,""+t.score)).replace(this.regexpRandom,""+Math.random())).replace(this.regexpFps,""+Math.round(100*t.level.fps)/100);var s=t.level.variables;null!=s&&s.forEach((function(t,i){e=e.replace(n.findRegexByString("{levelVariable."+i+"}"),""+t)}));var r=t.globalVariables;return null!=r&&r.forEach((function(t,i){e=e.replace(n.findRegexByString("{globalVariable."+i+"}"),""+t)})),null!=i&&i.variables.forEach((function(t,i){t instanceof o.default?(e=(e=(e=(e=(e=(e=(e=e.replace(n.findRegexByString("{loopObject.variable."+i+".x}"),""+t.x)).replace(n.findRegexByString("{loopObject.variable."+i+".y}"),""+t.y)).replace(n.findRegexByString("{loopObject.variable."+i+".speedX}"),""+t.speedX)).replace(n.findRegexByString("{loopObject.variable."+i+".speedY}"),""+t.speedY)).replace(n.findRegexByString("{loopObject.variable."+i+".width}"),""+2*t.halfWidth)).replace(n.findRegexByString("{loopObject.variable."+i+".height}"),""+2*t.halfHeight)).replace(n.findRegexByString("{loopObject.variable."+i+".alpha}"),""+t.alpha),t.variables.forEach((function(t,o){e=e.replace(n.findRegexByString("{loopObject.variable."+i+".variable."+o+"}"),""+t)}))):"number"==typeof t&&(e=e.replace(n.findRegexByString("{loopObject.variable."+i+"}"),""+t))})),e=(e=(e=(e=(e=t.mousePos?(e=e.replace(this.regexpMousePosX,""+t.mousePos.x)).replace(this.regexpMousePosY,""+t.mousePos.y):(e=e.replace(this.regexpMousePosX,"0")).replace(this.regexpMousePosY,"0")).replace(this.regexpScreenX,""+t.screenX)).replace(this.regexpScreenY,""+t.screenY)).replace(this.regexpLevelName,""+t.level.levelDefinition.name)).replace(this.regexpCurrentLevelFrame,""+t.level.currentFrame),e=this.replaceLevelArrayVariables(e,t,i),e=this.replaceLocalStorageVariables(e,t,i),e=this.replaceDistanceLoopObjects(e,t,i)},e.prototype.replaceLevelArrayVariables=function(e,t,i){for(var o=t.level.levelDefinition.levelVariables,n=0;n<o.length;n++)if(o[n].type==r.default.ARRAY){var s=o[n].name;e=this.replaceLevelArrayVariable(e,t,i,s)}return e},e.prototype.replaceLevelArrayVariable=function(e,t,i,o){for(var n=t.level.variables.get(o),s=new RegExp("{levelVariable."+o+"\\[\\d+\\]}"),r=s.exec(e);r;){var a=new RegExp("\\d+").exec(r[0]),l=parseInt(a[0]);e=e.replace(s,n[l]),r=s.exec(e)}return e},e.prototype.replaceLocalStorageVariables=function(e,t,i){for(var o=this.regexLocalStorageVariable.exec(e);o;){var n=o[0].substring(14,o[0].length-1);e=e.replace(this.regexLocalStorageVariable,localStorage.getItem(n)),o=this.regexLocalStorageVariable.exec(e)}return e},e.prototype.replaceDistanceLoopObjects=function(e,t,i){for(var n=this.regexDistanceLoopObjects.exec(e);n;){var s=n[0].substring(21,n[0].length-2).split(","),r=s[0],a=s[1],l=i.variables.get(r),u=i.variables.get(a),c=0;l instanceof o.default&&u instanceof o.default&&(c=this.util.distanceObjects(l,u)),e=e.replace(this.regexDistanceLoopObjects,"("+c+")"),n=this.regexDistanceLoopObjects.exec(e)}return e},e}();t.default=a},function(e,t,i){"use strict";t.__esModule=!0;var o=i(1),n=i(20),s=i(0),r=i(21),a=i(3),l=i(5),u=i(22),c=function(){function e(){this.expressionEvaluator=new n.default,this.progressBarColor=new o.default(32,32,128,100),this.util=new s.default,this.renderUtil=new u.default,this.logoImage=new Image,this.logoImageHalfWidth=100,this.logoImageHalfHeight=23,this.logoX=300,this.logoY=423,this.mousePos=null,this.logoImage.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMkAAAAuCAYAAACChz0/AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAABf0SURBVHja7F19bBvnef/py6ac6njeWljGCB1doLVMVBZdbA3dyjG9AexsBQm9qZviYLFMoEJsoBO9qYvdQrQirbCLGjPdAnHgrpLcwI7WETVdREpDbBBVKTC9P0ZKGhi3RaejykL0ukEnqonoD4n74+493sd75FG2U6flAxCU7vO9931+z/dzBB4BcQ19VumbI39XqEK/K1T1EMDgANgBdAHwAkgAYKVtYek7AaBfOoXsI5RIrQwuP0mTIQHcD8AtbQqmVgZvVNikApJymKhV+rMfgFPD9GDyOWSrLLRTE0x+1e5Yu8OSDbFaOwDwEqDCZHtqZXDytwiSCQBun+MukrOLiNXaBQD2Jw3MFXoCQSKBIyhpAyfZ7ljLwLWWgmMtA8f6HRkoobpWZKssyFZZEKvhkK2yIJB7Bx0PZoGeHgk2CSTnMgi9z2Glph47Nv8GwvpmvP3gk8Ivq7eGAfSnVgZTHyJAngcQDrjuwvf5esT+cQSdW14CAPdvE7gV+giAhGvoG5ZMKgCA6wEPW34ZHfdn4Fozx8PpKiuYfA5MazMgCEBXF+B2A9EoFl9/A2NffQ2Lq9X41Kc+jqe+9griv6oiQAtLJs/khwCSMwD6p/94FraJG4jVcBWQVAgAUFtCe0Ql7QHbuoDA3QgcaxnY8iWsj/37Aa8XcIpKxwaI/0ejQDgsfvf3A243Fp/+U/z8f+7jP+NpLC5m8Uz3CQROHYb/7iQitTu9wc37vWjo4yVNFn7c2sU2IbogobpW2VSssElFk9AAclRyYJ0A4Ll/G777/0HXHK2twMwMwHGidiBaAgCCQcDvl7yYfhE0Xq/q9J99/Vv4l3ontm9n8POf/Rp7qv8XnU+zBUClUojVcBiq+xwidc1IrQxWPY6J4Br64o61jHP8g+8qtchIamXwWIVNfr+pmsIsHAEIk8/Bd+8WLuf+VQ+Q1lYgHhcZeWICGBmRtYNMJ08CiUQBJNGobgCf/pNPof3eTwEAzzRV47PZn4tACgYBngficbg+wxKfJ/GYAHIGgNN37xaS1dvQXf9XACBI81ChCqkBwjX0DXMNfXmuoS//6mZPPg/oP62t+fzSUj7f06PfTigeF7dZreLfRhSP5/MXLojHAfn8/v35vNWav1nDyZ93anfmWz721TzX0NfzGJ65h2voy/+95bn8MjbnD275cl56/ucrHFEhmk9iJ056x/0Z+O9S/NWjR0WzyekEUhrtMjNT+JtojeVlUbsEg6IpptQqk/rrZydjSNY0Ilm9DelqFrEaDsmaRrLbyTX0taZWBmcehUAAMALA3XF/BoHcO+jc8hK5V38lP1Ihqk/CNfRdB+C1rQuYfv876iOtVtG0cjoBu11kfhrl8wUgvPqqet/16+K5e/aUHFgWm8HgrhwdG9r0tBxahphfiULMryTKceYlDeEF0MXkc/DfnUTH/RklQCp+SIXomkQyZbwAcD73I/2R0agcrUI0KvoNqSK8SY4lkS5BED9OJ7C0BLCsXusQ4nkwPK/SNo61DMbv3UKyphGR2p32SO3OrmyVpUsauyD5KwnJl9ASKwUh3CRS13F/Br57txCrtaPtY39LwNefWhl8tcIWFdJpEqXp4bt3C4G7EfVRPT2iBmDZgslE8h03bug1SSIhahK/v+DI87z4SSTEa2miXDoSBPHYcBgYGUH3XQ8idc1wrGVUORqlWQbImXwVOdYysK0LcKzfgefBT2FbFxCp3YlQXasy899VyYdUqBhIrAB4Jp9jp3/zbdnMAQCcOSMy9THJApmYEP+PRkWQhMPiNzG/4nHx/2hUBJUgiECZ0bgRHFfwbQAREIKkBBS+SqR2J4bqPkdKRKKSNmABMbtPsv1MPlc0uZmtsiBZvQ2xGk4JJAFi/iVYKT2pkCFIJIAkANg992/jfO5HBZBcuCAyuNtdAAHHiQxNtAXJfxCt0toqaon+/gLzm/BBlFqBwsxRAH7isHMNffslsJBPOSQo/JlwBRwVMuuTCABgyy+rtYjbLZpMSic9lRK3jYyIWoQkEMNh8XP4sDpXQjSFgtJVVjmClazeJtZ4qc0k4phHAUS1jrlkFk0CeFVhLtoVHxowEgCERxEZq9DvnybZL0lVdvz9y3KhIqzWgl9Ac9KHh0VwEGfc7RZ9jslJUZuQJCJFkySrtwEAOre8hGyVhZfuzxPnuyLdK/REkZRMW/rCU1/J/7LKWkgM9vSok37Xr+fzR4/m8xxXOGZ4uLBPm3Ccnxf37d+fv1nDqfaR+0iJuzOVVajQk25u8QBYXR+IMkQLiNqERKQSCdHc8vsLESsthcNydCt2cwLBTc/AtZZCqK4V6WoWjrUMyUu4uYY+5ZnRJznKJJl27hLmHY38FVPvowsSeZGZfE7vS0SjhfAt2W63F4oX3W6dKdZt+RLOXxkF4/eLJtnZCcRq7Sq/Q5FF1zrffsnfeNLAoSr6lOfMaoGjpdE4GDGXQXY5hwpAPvqOOxxrmYLTfuaMqDWIhujqKoRoleXubn1gqdfyHCJ1zRhK3oFfOsbzsTsY2mLB5WsvGA4k8tZ7GLoUg+SsP0ng2A8xTOwEAE97MzzP7oKjpRGO3dtLnt95aAixaT5RYbWPNkiigJhHkEtBSHm7MjLldBay5kAhxBsOAyiUkbge8GKSroaTgeT4Sic837yF9MJBdLy4xxAkUuRq5rcICO2mowBGGKsFvhN74TvuAsPWl3XN2DQPVHpSHuUaWRXanEhppdlLtoWleQ+Xy1NSL5VAoqqqAkdZk/B8ASA8L5pWiYS+ILGnRwTLyZMFppBMKtdaCnD7JAPKD883XAi99Z4hSCRmEqQ+cyXxiodNaSR8l8I/KIeKlp/4HHcxlNx8FMCIo6URl6+9ABu3tewFTc4uyial5rkEFMpooo8rmicttldiKlYSiALKaF6TrsFK10go/UWpa9X+EEPkpee/ovH57FC3itPAUIq80qefa+iLSqZyEMXzagmlOS0JTW8tSI5kXdIQVqs+t+F2i448y6rLUC5e1AEsXSW+UShbZSloHq8XWWxGdjlX1HaXJsboIYJcQ98IxJdQjJDjHC2NYKyWciW700iLBFx3MRDbvJ8AZHTsWNnaQ/NMRovrJYDhGvr6UyuDFzVM4ob6ZRuC4jssMTzxkZwKYRIk80WZS7diLqMkmCDd06m4n1FQIgrggFJIlTv/hNILAtILAgB0cQ19/ZLAK2lqe9qb4di9XV53xmqBY/d2pFNLyC7nVCZwbGoekbfeQ+hawp1dzkUBwNbEwtbEUv1GWxPrJGZ0bGpeFtxVConQNf2bb8MW8BdMKSrWEqoMfLJ6G5h8Tm7pPbTly0jWNIoFiV/eIpfId/5gHck/bKY6uYFzBw3t+6ywitg0j9DVOCJjtwve/ekDGzJ/JB+BT60M7pCkJNUUYqwWTM+dpF4/8tZ7SM5lkJxdLAr80XFfUS2TnMsgeHaCMEuCBl5Crja7EuS6wEF2OacEpQCA9Z8+IDMVmcvkXAahq3GEriXIcW5J8Hi19yMMyFgtCF2NIzmXiaZWBglIrjNWi9dojsxQVljF0KUYhl67Kc+jFgS2Jha9x68jNs2j44gT51//iw1p9M72YWSXc/CfPgD/6QNq6Xt2Aq42O1z7dqi2Bc9OILUyWEXMrREAXelqFja3u/gdnU7RDzkg3ii46RlE6pox+sH34VpLwbYuwPacG5ExIPnGD+DoF4BgEL6rLnQv23WLTNBtRAxbD8+zu+B5dhdCV+PoPX4d5y8dNjTbSpGjpRGxaZ5IyC4lAyqlnP/0Ad3iJ2cX0X3kTcLURUl7Td04dm+HY/d2eNqb0dk+jPSC4HS0NMK1b4cs7UJX43Ds3g7fib0qxuo9fh3JuQzOXzqsWljCDADY0bFjOsHDsPVw7dsB174d8J3Yi872YTa7nAuT8fpPH1BdjwJqt0LbeT3tzRsGCBkPATJhYt+JvboxpBeEDQOEzHXg3EH0Hr9OXRctaIgWIgK0VnKWJ2WnlWWLWJB8If/BcUAqJZbVK+q9kjWNCLy4B4zVgt43Mgh83AmGa5SrdGlMa3aiCTA2ChAyYQpzwetpb8blN4/oJIv2HsnZRRxqu2T6PkbMRmOUy9dewMCpt3XjIJJce3zg3EHR1NDMGwGUUnuYYBw7GW+xMWt8Mr8Rc210TXwn9ooSnTIGR0ujaYBkhVWEriVABI6SdwZOvV1UIFNM5YTOcRcVtaAGBcmP8Dzg9yP0PocOQAwRX7yorvWSfBtHSyNcbXb0LufQOdYI/BrAJlDNI0dLI0GtKWajAYSYP0YSXXkNhbnXD8DueXaXKc3WfeTNotel3dfouWxNrIrpbNxWlbbQAroEw6qDDpQ5LsU42eVc0VwPAawkXJ4H0OVqs5cMZoSuxqlal7Fa4GlvVp3vaW9G6Gpc77uklnD+0mHTAGlruSCbbqNjx1TPa2bM5DrSNXgtSPQ2cVeXKqIVqt2NAcsX4bn4OpiJH4vAIZonGkXkVxak/6AwEK1kNFLjxSS077gLgW8eKroQvcevG2ufI041SCQbO7ucc5PF0QJOu4222B0v7imq0bpfuKbyobQ0Pn1cBQIa4Eh0jAaW2NS8DmxE02gX/FDbJXn82vtK5mdJkCj2dxF/pxQRABqF/JU+G/FDzAgE4stox6C9X2ya1wmFUrwYuhpXugRRLUiEZPU2uFRK1a8GSV0rRjf9CMzzfy5qEtIvYrcDfj9sg68DgoDQ1bhpk4jmoyilDU3CapmVsVqQnMsgNjWvjJoYXp8wBs2mTi8Ium0kh1OOz2Gk2UjOxVQisn0YtiYW4++e0I2n+8ibVCeUxqjK+YiM3Vbdm2jNUhJWEcHy2prYkuYkiTbRtKjRupqZE/JMtGMdu7djVOI7I7ONyoNT8wienZCjWYrooc7cimarLG6VueX1irmQixeRrN4mvtL0e+cKJfRXrogVv8EgwLJwuN24/Ged6DzVCLNOndIkIWaa59ldpm16ALJjD4lh0qkldB95E8m5DNILArLCqmosrn07xGiJBshZYRXp1FJJhmeslqJMlRVWVYzpaGlEx4t74Gqzm2aE2NQ8sss5aniVjMeMfe3YvR2Xn90Fxmqhzml2OVcS8FoGNqNFlHPmaW+Ga98OnYmlleKltBkADLwyjtC1hAwGldVRQqBS8wpSFEsCBfUF6SpzK1bDFUrjCUnmVKR2JzqeShWasEin4cxMoZ/E6YTje+fg++sLGDjVLDtb6dQSCTlSJ7PjiNO0dE3OLpY8zsZtxejYMdnMiE3zUPoeJLyo9UciY7epwNaaWrYmVgVuLfMl5zKyxug44txQIpLcs5gZZgYkpRhHyg+Yj0hZLaasBLKu/tMHzPkBJvwiRelS2bmZdGoJ6QVBNxbJD0qQ0DaNaiVnDAASyZpG6ksZZObYbRe1xswMIrU7EavhwORz8N+4IYJEqhTu+KN+HFLY45Gx2wStugm/fO2FsrTG0Gs3kZzLiKHCIo4Yw9bD096MoUsxxKbmdSDR+h1kwmhMZWtiVUBJzmVIqBW2JhbT//V3ugUfnz6+IXCYAUIxAJXLOLFpHoFzB6naUCswSgUrSoVVS5ndpc5RgsisRibrGjw7oVsnxVyGi52v1CSpbJWFj7ybsXsEQRcKtq0LSE7dgUPaHqvh5P7yZPU2OEgDFgDbS17YvsUjNjUP174dyvIMFdFi+YRBImO3kRVW4TuxV8Vs6QUBybmMylkn5oyWwckia80lG7dVJw0Jw9AWytVmN9SENAajRcyICUV8pFIMQcZMk67JuYwp06SUVB449Tb1HkTq0gDRccRJfS4z4Im89R5iU/OiltEEPsxoBhu3Fb7jLlmbGEU5tSazjdtKXSeFNZAoChJNUV84UrvT7yG9IoBoWl25go4HswhuegYOAGhtRWAmoop6OZZnC5XBTieY/H8jOZcRQUJxYjuOOHUAoSXrtMxMc8TTCwLVScwKq4bnaBeVRKJo1wmcOyhm2BXPwVgtCJw7aAgIrSRTRl4Yq8U8SDRzRBbWrIlEGIdk25V+DtGQOpAYzOf5S4d12rFY+L7YuuoEmknzyX/6AELXElSzm7FaDM1bmq+pGA9vVpMAwEiortXv//YIbF1dhVcIjYwAk5PwPPgphsY5+D7Pim9yFARE3s3A9X+36TVfJNypic4UYyaSbSYxfe1E8NkB89JSZHwBAFtK2g29dlNedC3jM2w9xt89UdQPKebEh67GZUYkWs9MZIimLcjCmjE3ssKq6LC32alJWwIg7XYiVLTzQGO+4NmJouU3BPC2JlZ+blqykwZKWpSUYevhO7FXBLfmGsXWhAZCMpelqoRVIBl///LMoae6owOLn3ZfDgYLNVwjI8COHfKre4I3W4Gb83Cs3yn8FEN4QpUzSVezZZsExfIh5ZIit9EPIKiNmWslHZmwyNhtw3FsxAdg2PqSTGQIBJqpRXInlH1aQUDKUIoxL+06NH+kWASuFJXKKRlFtsgaarWu77gLwbMTprS41vSmaMFEqXOrlT6H1Jnoj9Q1I/SN6wUn3m4X38QI8Y0q/ns/gf/eT8QXveWXxZdCkJovQUDsrcSGQPKoKDY1T+ztqFRdmzDyixQRDgAIphcEWauUSwOvjMsm3kONX5LkNMlt5KsQjVUuUaNnUs7JTPjUTPjYjFAwGsfQazd1phLD1oNh602NUWt6U4QRX+pcWZOQHnd+ZXDG3tDnH7B8Mej4y5fh+PdR0Ywi7bosWzCr7HYRHHbFRPn9GFj8NDr+xvlQxW8biQalFwRSGk0kBIllR2PTvNMoSy2ZZeHUyuBJrqHPPXDqbWe5cfeBV8YxdClmWGJSbtSJBAyMQKJ9huRcBqFrCdOhdDJnNGlsJjBAghA0DWFWE8kBk6l5qjlEtNTAqbd1c+poaURn+7BYlKmYJ+J3kQpt8v/o2DEjkJTUJFXEcWfyOSjf3mhv6Btm8rmu85afwPP1zoIjb0Q8j+zJU+j98Toidc2mJsjT3ozAuYOqBScqXOlsarPoJYiH+NJr8k6uYSgas7QVxLGpeRLO9aZWBm9InW9BSPVJJAlIleqzi4hN86K0U5S7B84d1C2q8rlI9KjM5zKdxyDhcSUzpBcE6n219U1ZYRW7m86W9P9I2c303End3LR95p/k6l6lxI9N8xtZ0yg29gLChPTtRPFGrZI/9yeDxPWAx+jqG+LWM2eA/n7YmcAFAH7fvVvw71oG0/OyXnNEo8DICCJjtzGw+jmkq1kBYul9qRlgIdUBFTmGPGhU8eBFAaLtuCO/hUhsWa2/0fvyDxG6luBTK4M7NOftl85zm1iQsHQseXZviXPKfa5yqAuK37ikMI6S8dxaICiEhiFI0qkltLVcAGO1YPaXX9MJjhLV0jwKDWJkDkrNldMsOB5H+7fK3NL2uPPZgZN2JhAd2vT0yNAvwHqOj8O1dkl+gR35dd1I7U6kqz1ANRLSAs24HvAY/YdPyq9C7f1mHK5/7ldJcTsTIEzo1Ewg/wh/GzEIoJ8GEEUlQFgChnL3JMQuPNJT7aYxHZ8d0Eqhw3Ym0KoBiswYH8KL9yYBHJNAbsg4XEOfW1k5QKJfyjC3UXUDSQwb5XAk8moE5cM8u7JluOiBtP2plcGybkauQc6TNYljLYPxD74rHhWPq3rc7buHrAoJRUN1GECYXxm80mt5DqG6VvjvTsL/zqui5hEERD7hQqgjYFgZfOgLrxkWBdIettRkaWiYsVq6tFJPUalrT60Mpsg1pR53mREepsfdTA9KuYtY7mIb0FIJLf6wZPq3LR9iXT8UqlVGtwBQ8x389z+7jETiIhKJi7hxA/bCywF4XiPxH7LHvexFN9NjHZvmg9nlXJcy7t778g8JQPqVAJF63OVrP6Ie95LPRRjlQ2QS7+O8eKmol9InKeeZN9jjLvNeiR53UHrc5Z9eAAD8Lve425lA3NHS6CRtwNICBQGcNHKAP+Qed1NMZ7LHXZ6jEj3uRe9H6XFXgbnYHJkNy34EetzVIBn94Ptw/dsI9aVz6nhDVO5x77Z8SdXj3m35EuD1IjJ2G+N1P4DjF2KdTeQTLvKrtjqaXThtaqIfpsfdzgSOKgIKUQkgkzSpRxJYtBbecnrczSQRs8Iq6XHHI+xxN6yLozEOGW+xHncpwIHUyqDMLw/Td240Fm20jUTLXG32h7oX4R3a9WkkvTAEqZVB/P8AGtFSZxUrFg4AAAAASUVORK5CYII="}return e.prototype.renderLoading=function(e){var t=e.numImages,i=e.numImagesLoaded,n=t+e.numAudios,s=i+e.numAudiosLoaded,r=100;n>0&&(r=Math.floor(100*s/n));var a=s+" of "+n+" ("+r+"%)",l=e.ctx;l.fillStyle="#dddddd",l.fillRect(0,0,e.gameDefinition.canvasWidth,e.gameDefinition.canvasHeight),l.font="16px sans-serif",l.textAlign="center",l.fillStyle="#000000",l.fillText("Loading... "+a,300,250),l.font="14px sans-serif",l.fillText("made with",300,390),null!=this.mousePos&&this.isInsideLogo(this.mousePos.x,this.mousePos.y)?(l.shadowBlur=5,l.shadowColor="#000000"):(l.shadowBlur=0,l.shadowColor="#00000000"),l.drawImage(this.logoImage,this.logoX-this.logoImageHalfWidth,this.logoY-this.logoImageHalfHeight),l.shadowBlur=0,l.shadowColor="#00000000",this.drawPercentageBar(l,100,260,400,10,s,n,!1,1,this.progressBarColor,o.default.WHITE,o.default.BLACK)},e.prototype.isInsideLogo=function(e,t){return e>=this.logoX-this.logoImageHalfWidth&&e<=this.logoX+this.logoImageHalfWidth&&t>=this.logoY-this.logoImageHalfHeight&&t<=this.logoY+this.logoImageHalfHeight},e.prototype.render=function(e){var t=e.play,i=t.game,o=t.game.ctx;o.clearRect(0,0,i.gameDefinition.canvasWidth,i.gameDefinition.canvasHeight),this.rotateCanvas(e.canvasAngle,i),this.drawBackground(e);var n=t.level.customObjectArray;if(null!=n)for(var s=0;s<n.length;s++)this.drawCustomObject(n[s],e,o);var r=t.level.levelDefinition.texts;if(null!=r)for(s=0;s<r.length;s++){var a=this.buildFillStyleFromColor(r[s].color),l=r[s].fontSize+"px "+r[s].fontFamily;this.util.drawText(o,r[s].text,r[s].x,r[s].y,l,a,r[s].align,"middle")}this.drawCustomElements(t),this.renderInfo(e),this.renderCustomTexts(e),this.renderDynamicTexts(e),this.rotateCanvas(-e.canvasAngle,i),this.drawButtons(e)},e.prototype.drawButtons=function(e){for(var t=e.play.game.ctx,i=0;i<e.buttonArray.length;i++){var o=e.buttonArray[i];this.drawButton(t,o)}},e.prototype.rotateCanvas=function(e,t){var i=t.ctx;i.translate(t.gameDefinition.canvasWidth/2,t.gameDefinition.canvasHeight/2),i.rotate(e),i.translate(-t.gameDefinition.canvasWidth/2,-t.gameDefinition.canvasHeight/2)},e.prototype.rotateCanvasAt=function(e,t,i,o){var n=t.ctx;n.translate(i,o),n.rotate(e),n.translate(-i,-o)},e.prototype.renderCustomTexts=function(e){var t=e.play,i=t.game.ctx,o=t.game.gameDefinition.customTexts;if(null!=o)for(var n=0;n<o.length;n++){var s=o[n];null!=s.levelIndex&&s.levelIndex!=t.currentLevelIndex||(i.font=s.font,i.fillStyle=s.fillStyle,i.fillText(s.text,s.x,s.y))}},e.prototype.renderDynamicTexts=function(e){var t=e.play,i=t.game.ctx,o=t.game.gameDefinition.dynamicTexts;if(null!=o)for(var n=0;n<o.length;n++){var s=o[n];if(null==s.levelIndex||s.levelIndex==t.currentLevelIndex){var r=this.expressionEvaluator.replaceVariables(s.text,e.play,null);i.font=s.font,i.fillStyle=s.fillStyle,i.fillText(r,s.x,s.y)}}},e.prototype.renderInfo=function(e){var t=e.play,i=t.game.ctx;i.fillStyle="#000000",t.gameOver?(i.font="30px Arial",i.fillText("GAME OVER",t.game.gameDefinition.canvasWidth/2-100,t.game.gameDefinition.canvasHeight/2-60)):t.paused&&(i.font="30px Arial",i.fillText("PAUSED",t.game.gameDefinition.canvasWidth/2-100,t.game.gameDefinition.canvasHeight/2-60)),i.font="10px Arial"},e.prototype.drawPercentageBar=function(e,t,i,o,n,s,r,a,l,u,c,d){var h=this.buildFillStyleFromColor(u),p=this.buildFillStyleFromColor(c),f=this.buildFillStyleFromColor(d);if(this.drawBar(e,t-l,i-l,o+2*l,n+2*l,f),this.drawBar(e,t,i,o,n,p),this.drawBar(e,t,i,o*s/r,n,h),a)for(var m=o/r,v=1;v<r;v++)this.drawBar(e,Math.round(t+m*v-l/2),i,l,n,f)},e.prototype.drawBar=function(e,t,i,o,n,s){e.fillStyle=s,e.beginPath(),e.rect(t,i,o,n),e.closePath(),e.fill()},e.prototype.buildFillStyleFromColor=function(e){return this.util.buildFillStyleFromColor(e)},e.prototype.drawBackground=function(e){var t=e.play;if(e.levelDefinition.backgroundType==l.default.SOLID_COLOR){var i=e.levelDefinition.backgroundColor;t.game.ctx.fillStyle=this.buildFillStyleFromColor(i),t.game.ctx.fillRect(0,0,t.game.gameDefinition.canvasWidth,t.game.gameDefinition.canvasHeight)}else if(e.levelDefinition.backgroundType==l.default.IMAGE){var o=t.game.getImage(e.levelDefinition.backgroundImage.imageId),n=e.levelDefinition.backgroundImageWidth||64,s=e.levelDefinition.backgroundImageHeight||64,r=-t.screenX%n,a=-t.screenY%s;a>0&&(a-=s),r>0&&(r-=n);for(var u=this.calculateSafetyMarginX(e),c=this.calculateSafetyMarginY(e),d=r-=u,h=a-=c;h<t.game.gameDefinition.canvasHeight/t.zoom+s+c;){for(;d<t.game.gameDefinition.canvasWidth/t.zoom+n+u;)t.game.ctx.drawImage(o,d*t.zoom,h*t.zoom,n*t.zoom+1,s*t.zoom+1),d+=n;d=r,h+=s}}},e.prototype.calculateSafetyMarginX=function(e){var t=e.play,i=Math.sqrt(t.game.gameDefinition.canvasWidth*t.game.gameDefinition.canvasWidth+t.game.gameDefinition.canvasHeight*t.game.gameDefinition.canvasHeight)/2-t.game.gameDefinition.canvasWidth/2;return i=(i/=t.zoom)-i%e.levelDefinition.backgroundImageWidth+e.levelDefinition.backgroundImageWidth},e.prototype.calculateSafetyMarginY=function(e){var t=e.play,i=Math.sqrt(t.game.gameDefinition.canvasWidth*t.game.gameDefinition.canvasWidth+t.game.gameDefinition.canvasHeight*t.game.gameDefinition.canvasHeight)/2-t.game.gameDefinition.canvasHeight/2;return i=(i/=t.zoom)-i%e.levelDefinition.backgroundImageHeight+e.levelDefinition.backgroundImageHeight},e.prototype.drawCustomElements=function(e){for(var t=e.game.ctx,i=0;i<e.customElementsToDraw.length;i++){var o=e.customElementsToDraw[i];if("LINE"==o.type)t.strokeStyle=this.buildFillStyleFromColor(o.color),t.lineWidth=o.lineWidth,t.beginPath(),t.moveTo(o.x1,o.y1),t.lineTo(o.x2,o.y2),t.stroke();else if("RECT"==o.type)t.beginPath(),t.rect(o.x,o.y,o.width,o.height),t.closePath(),"FILL"==o.drawType?(t.fillStyle=this.buildFillStyleFromColor(o.color),t.fill()):"STROKE"==o.drawType?(t.strokeStyle=this.buildFillStyleFromColor(o.borderColor),t.lineWidth=o.borderSize,t.stroke()):"FILL_AND_STROKE"==o.drawType&&(t.fillStyle=this.buildFillStyleFromColor(o.color),t.strokeStyle=this.buildFillStyleFromColor(o.borderColor),t.lineWidth=o.borderSize,t.fill(),t.stroke());else if("CIRCLE"==o.type)t.beginPath(),t.arc(o.x,o.y,o.radius,0,2*Math.PI),t.closePath(),"FILL"==o.drawType?(t.fillStyle=this.buildFillStyleFromColor(o.color),t.fill()):"STROKE"==o.drawType?(t.strokeStyle=this.buildFillStyleFromColor(o.borderColor),t.lineWidth=o.borderSize,t.stroke()):"FILL_AND_STROKE"==o.drawType&&(t.fillStyle=this.buildFillStyleFromColor(o.color),t.strokeStyle=this.buildFillStyleFromColor(o.borderColor),t.lineWidth=o.borderSize,t.fill(),t.stroke());else if("TEXT"==o.type)t.font=o.fontSize+"px "+o.fontFamily,t.fillStyle=this.buildFillStyleFromColor(o.color),t.textAlign=o.textAlign,t.fillText(o.text,o.x,o.y);else if("IMAGE"==o.type){var n=e.game.getImage(o.imageId);t.globalAlpha=o.alpha,this.rotateCanvasAt(-o.rotation,e.game,o.x+o.width/2,o.y+o.height/2),t.drawImage(n,o.x,o.y,o.width,o.height),this.rotateCanvasAt(o.rotation,e.game,o.x+o.width/2,o.y+o.height/2),t.globalAlpha=1}else"PERCENTAGE_BAR"==o.type&&(t.globalAlpha=o.alpha,this.drawPercentageBar(t,o.x,o.y,o.width,o.height,o.value,o.maxValue,o.split,o.borderSize,o.color,o.backgroundColor,o.borderColor),t.globalAlpha=1)}},e.prototype.drawCustomObject=function(e,t,i){var o=t.play.game.getImage(e.image.imageId),n=t.play,s=n.zoom;i.save(),i.globalAlpha=e.alpha,this.rotateCanvasAt(-e.imageAngle,n.game,e.x*s-n.screenX*s,e.y*s-n.screenY*s),e.type.renderType==a.default.IMAGE?i.drawImage(o,e.x*s-n.screenX*s-e.halfWidth*s,e.y*s-n.screenY*s-e.halfHeight*s,2*e.halfWidth*s,2*e.halfHeight*s):e.type.renderType==a.default.CIRCLE?(i.beginPath(),i.ellipse(e.x*s-n.screenX*s,e.y*s-n.screenY*s,e.halfWidth*s,e.halfHeight*s,0,0,2*Math.PI),i.closePath(),e.type.drawType==r.default.FILL?(i.fillStyle=this.buildFillStyleFromColor(e.type.color),i.fill()):e.type.drawType==r.default.STROKE?(i.strokeStyle=this.buildFillStyleFromColor(e.type.borderColor),i.lineWidth=e.type.borderSize,i.stroke()):e.type.drawType==r.default.FILL_AND_STROKE&&(i.fillStyle=this.buildFillStyleFromColor(e.type.color),i.strokeStyle=this.buildFillStyleFromColor(e.type.borderColor),i.lineWidth=e.type.borderSize,i.fill(),i.stroke())):e.type.renderType==a.default.RECTANGLE&&(i.beginPath(),i.rect(e.x*s-n.screenX*s-e.halfWidth*s,e.y*s-n.screenY*s-e.halfHeight*s,2*e.halfWidth*s,2*e.halfHeight*s),i.closePath(),e.type.drawType==r.default.FILL?(i.fillStyle=this.buildFillStyleFromColor(e.type.color),i.fill()):e.type.drawType==r.default.STROKE?(i.strokeStyle=this.buildFillStyleFromColor(e.type.borderColor),i.lineWidth=e.type.borderSize,i.stroke()):e.type.drawType==r.default.FILL_AND_STROKE&&(i.fillStyle=this.buildFillStyleFromColor(e.type.color),i.strokeStyle=this.buildFillStyleFromColor(e.type.borderColor),i.lineWidth=e.type.borderSize,i.fill(),i.stroke())),this.rotateCanvasAt(e.imageAngle,n.game,e.x*s-n.screenX*s,e.y*s-n.screenY*s),i.restore()},e.prototype.drawButton=function(e,t){e.fillStyle=this.buildFillStyleFromColor(t.backgroundColor),e.strokeStyle=this.buildFillStyleFromColor(t.borderColor),e.lineWidth=t.borderSize;var i=t.borderRadius,o=t.fontSize+"px Arial",n=this.buildFillStyleFromColor(t.textColor);this.renderUtil.drawRoundRect(e,t.x-t.width/2,t.y-t.height/2,t.width,t.height,i,!0,!0),this.util.drawText(e,t.text,t.x,t.y+1,o,n,"center","middle")},e}();t.default=c},function(e,t,i){"use strict";t.__esModule=!0;var o=i(41),n=i(23),s=i(42),r=i(44),a=i(24),l=i(0),u=i(25),c=i(26),d=function(){function e(e){this.gameOver=!1,this.paused=!1,this.mousePos=null,this.lastTouchX=0,this.lastTouchY=0,this.accelerometer={x:0,y:0,z:0},this.isLeftMouseButtonDown=!1,this.util=new l.default,this.zoom=1,this.globalVariables=new Map,this.objectTypesMap=new Map,this.eventHandler=null,this.keyDownCodes=new Array,this.keyUpCodes=new Array,this.isKeyDownCodes=new Map,this.mouseDownList=new Array,this.mouseUpList=new Array,this.customElementsToDraw=new Array,this.touchStartList=new Array,this.touchMoveList=new Array,this.touchEndList=new Array,this.game=e,this.screenX=0,this.screenY=0,this.score=0,this.gameOver=!1,this.mousePos=null,this.eventHandler=new o.default,this.eventHandler.initObjectVariablesRegexp(this),this.resetGlobalVariables();for(var t=this.game.gameDefinition.customObjectTypes,i=0;i<t.length;i++)this.objectTypesMap.set(t[i].uid,t[i]);this.currentLevelIndex=0;var n=e.gameDefinition.levels[this.currentLevelIndex];this.level=new s.default(this,n),this.levelBuilder=new r.default(this.level)}return e.prototype.restart=function(){this.stopAllAudios(),this.score=0,this.gameOver=!1,this.mousePos=null,this.resetGlobalVariables(),this.goToLevelIndex(0)},e.prototype.resetGlobalVariables=function(){var e=this.game.gameDefinition.globalVariables;if(null!=e)for(var t=0;t<e.length;t++)this.globalVariables.set(e[t].name,e[t].initialValue)},e.prototype.setGlobalVariable=function(e,t){this.globalVariables.set(e,t)},e.prototype.addToGlobalVariable=function(e,t){var i=this.globalVariables.get(e);this.globalVariables.set(e,i+t)},e.prototype.clearCustomElementsToDraw=function(){this.customElementsToDraw=new Array},e.prototype.goToLevelIndex=function(e){if(!(e>=this.game.gameDefinition.levels.length||e<0)){this.currentLevelIndex=e,this.screenX=0,this.screenY=0;var t=this.game.gameDefinition.levels[this.currentLevelIndex];this.level=new s.default(this,t),this.level.currentFrame=-1}},e.prototype.goToLevel=function(e){for(var t=0;t<this.game.gameDefinition.levels.length;t++){this.game.gameDefinition.levels[t].uid==e.uid&&(this.currentLevelIndex=t)}this.screenX=0,this.screenY=0,this.level=new s.default(this,e)},e.prototype.goToLevelUid=function(e){var t=this.findLevelByUid(e);this.goToLevel(t)},e.prototype.findLevelByUid=function(e){for(var t=0;t<this.game.gameDefinition.levels.length;t++){var i=this.game.gameDefinition.levels[t];if(i.uid==e)return i}},e.prototype.goToNextLevel=function(){this.goToLevelIndex(this.currentLevelIndex+1)},e.prototype.goToPreviousLevel=function(){this.goToLevelIndex(this.currentLevelIndex-1)},e.prototype.update=function(){if(this.level.update(),this.updateLevel(),1==this.level.levelDefinition.centerCameraAtObject)for(var e=this.level.customObjectArray,t=0;t<e.length;t++){var i=e[t];i.type.id==this.level.levelDefinition.centerCameraAtObjectTypeId&&(this.setCameraCenterX(i.x),this.setCameraCenterY(i.y))}this.keyUpCodes=new Array,this.keyDownCodes=new Array,this.mouseDownList=new Array,this.mouseUpList=new Array,this.touchStartList=new Array,this.touchMoveList=new Array,this.touchEndList=new Array,this.level.currentFrame++},e.prototype.setCameraCenterX=function(e){this.screenX=e-this.game.gameDefinition.canvasWidth/2/this.zoom},e.prototype.setCameraCenterY=function(e){this.screenY=e-this.game.gameDefinition.canvasHeight/2/this.zoom},e.prototype.muliplyZoom=function(e){this.setZoom(this.zoom*e)},e.prototype.setZoom=function(e){var t=this.game.gameDefinition.canvasWidth/this.zoom,i=this.game.gameDefinition.canvasWidth/e-t,o=this.game.gameDefinition.canvasHeight/this.zoom,n=this.game.gameDefinition.canvasHeight/e-o;this.zoom=e,this.screenX-=i/2,this.screenY-=n/2},e.prototype.updateLevel=function(){this.game,this.util},e.prototype.registerKeyDown=function(e){this.keyDownCodes.push(e),this.isKeyDownCodes.set(e,!0)},e.prototype.registerKeyUp=function(e){this.keyUpCodes.push(e),this.isKeyDownCodes.set(e,!1)},e.prototype.isKeyDown=function(e){var t=this.isKeyDownCodes.get(e);return null!=t&&t},e.prototype.isAnyKeyDown=function(e){for(var t=0;t<e.length;t++){if(1==this.isKeyDownCodes.get(e[t]))return!0}return!1},e.prototype.onKeyDown=function(e){for(var t=0;t<this.keyDownCodes.length;t++)if(this.keyDownCodes[t]==e)return!0;return!1},e.prototype.onKeyUp=function(e){for(var t=0;t<this.keyUpCodes.length;t++)if(this.keyUpCodes[t]==e)return!0;return!1},e.prototype.checkEveryXSeconds=function(e,t){var i=this.eventHandler.secondsCounterMap.get(e);return null==i&&(i=new a.default(t,this.level.currentFrame,Date.now()),this.eventHandler.secondsCounterMap.set(e,i)),i.evaluateCondition(this.level.currentFrame,Date.now())},e.prototype.checkEveryXFrames=function(e,t){var i=this.eventHandler.frameCounterMap.get(e);return null==i&&(i=new n.default(t,this.level.currentFrame),this.eventHandler.frameCounterMap.set(e,i)),i.evaluateCondition(this.level.currentFrame)},e.prototype.buildImageObject=function(e,t){var i=new u.default;if(i.imageId=t,"UPLOAD"==e)i.imageSourceType=c.default.UPLOAD;else if("LIBRARY"==e){i.imageSourceType=c.default.LIBRARY;var o=t.substring(7);i.customImage=this.util.findElementByUid(this.game.gameDefinition.customImages,o)}return i},e.prototype.playLibraryAudio=function(e,t){this.game.playLibraryAudio(e,t)},e.prototype.playCustomAudio=function(e,t){this.game.playCustomAudio(e,t)},e.prototype.stopAllAudios=function(){this.game.stopAllAudios()},e.prototype.getFPS=function(){return Math.round(100*this.level.fps)/100},e.prototype.getMouseX=function(){return null==this.mousePos?0:this.mousePos.x},e.prototype.getMouseY=function(){return null==this.mousePos?0:this.mousePos.y},e.prototype.getGlobalVariable=function(e){return this.globalVariables.get(e)},e.prototype.getLevelVariable=function(e){return this.level.variables.get(e)},e.prototype.getCurrentLevel=function(){return this.level},e}();t.default=d},function(e,t,i){"use strict";t.__esModule=!0;var o=i(1),n=i(20),s=i(23),r=i(24),a=i(0),l=i(2),u=i(9),c=i(14),d=function(){function e(){this.expressionEvaluator=new n.default,this.frameCounterMap=new Map,this.secondsCounterMap=new Map,this.util=new a.default,this.dynamicSourceCode=!0}return e.prototype.initObjectVariablesRegexp=function(e){this.expressionEvaluator.initObjectVariablesRegexp(e)},e.prototype.evaluateConditions=function(e,t,i){for(var o=0;o<e.length;o++)if(!this.evaluateCondition(e[o],t,i))return!1;return!0},e.prototype.evaluateColorExpression=function(e,t,i){var n=null;if(null!=e&&null!=e.red){var s=this.expressionEvaluator.evaluateExpression(""+e.red,t,i),r=this.expressionEvaluator.evaluateExpression(""+e.green,t,i),a=this.expressionEvaluator.evaluateExpression(""+e.blue,t,i);n=new o.default(s,r,a)}return n},e.prototype.evaluateCondition=function(e,t,i){if(e.type==u.default.COLLISION){if(this.listCollisions(e,t,i).length>0)return!0}else if(e.type==u.default.KEYDOWN){for(var o=0;o<t.keyDownCodes.length;o++)if(t.keyDownCodes[o]==e.keyCode)return!0}else if(e.type==u.default.REPEAT_WHILE_KEY_IS_DOWN){if(t.isKeyDown(e.keyCode))return!0}else if(e.type==u.default.KEYUP){for(o=0;o<t.keyUpCodes.length;o++)if(t.keyUpCodes[o]==e.keyCode)return!0}else{if(e.type==u.default.MOUSEDOWN)return t.mouseDownList.length>0;if(e.type==u.default.MOUSEUP)return t.mouseUpList.length>0;if(e.type==u.default.REPEAT_WHILE_MOUSE_IS_DOWN)return t.isLeftMouseButtonDown;if(e.type==u.default.ALWAYS)return!0;if(e.type==u.default.EXPRESSION)return this.expressionEvaluator.evaluateExpression(e.expression,t,i);if(e.type==u.default.ON_LEVEL_START)return 0==t.level.currentFrame;if(e.type==u.default.ON_BUTTON_CLICK){if(t.mouseDownList.length>0)for(var n=0;n<t.level.buttonArray.length;n++){if((l=t.level.buttonArray[n]).uid==e.button.uid)return l.isInsideButton(t.mousePos.x,t.mousePos.y)}}else if(e.type==u.default.MOUSE_OVER_BUTTON)for(var a=0;a<t.level.buttonArray.length;a++){var l;if((l=t.level.buttonArray[a]).uid==e.button.uid)if(null!=t.mousePos)return l.isInsideButton(t.mousePos.x,t.mousePos.y)}else{if(e.type==u.default.MOUSE_OVER_OBJECT){if(null==t.mousePos)return!1;for(var d=this.getObjectsByObjectSelector(e.objectSelectorDefinition,t,i),h=0;h<d.length;h++){var p=d[h];if(this.util.isInsideObject(t.mousePos.x,t.mousePos.y,p))return!0}return!1}if(e.type==u.default.CLICK_ON_OBJECT){if(!(t.mouseDownList.length>0))return!1;if(null==t.mousePos)return!1;d=this.getObjectsByObjectSelector(e.objectSelectorDefinition,t,i);for(var f=0;f<d.length;f++){p=d[f];if(this.util.isInsideObject(t.mousePos.x,t.mousePos.y,p))return!0}return!1}var m;if(e.type==u.default.EVERY_X_FRAMES)return null==(m=this.frameCounterMap.get(e.uid))&&(m=new s.default(e.frames,t.level.currentFrame),this.frameCounterMap.set(e.uid,m)),m.evaluateCondition(t.level.currentFrame);if(e.type==u.default.EVERY_X_SECONDS)return null==(m=this.secondsCounterMap.get(e.uid))&&(m=new r.default(e.seconds,t.level.currentFrame,Date.now()),this.secondsCounterMap.set(e.uid,m)),m.evaluateCondition(t.level.currentFrame,Date.now());if(e.type==u.default.DISTANCE_BETWEEN){var v=this.expressionEvaluator.evaluateExpression(e.x1,t,i),y=this.expressionEvaluator.evaluateExpression(e.y1,t,i),E=this.expressionEvaluator.evaluateExpression(e.x2,t,i),g=this.expressionEvaluator.evaluateExpression(e.y2,t,i),b=this.expressionEvaluator.evaluateExpression(e.distance,t,i),_=this.util.distance(v,y,E,g);if(e.relation==c.default.EQUAL)return _==b;if(e.relation==c.default.GREATER)return _>b;if(e.relation==c.default.SMALLER)return _<b;if(e.relation==c.default.GREATER_OR_EQUAL)return _>=b;if(e.relation==c.default.SMALLER_OR_EQUAL)return _<=b;if(e.relation==c.default.DIFFERENT)return _!=b}}}return!1},e.prototype.listCollisions=function(e,t,i){for(var o=this.getObjectsByObjectSelector(e.object1,t,i),n=this.getObjectsByObjectSelector(e.object2,t,i),s=[],r=0;r<o.length;r++)for(var a=0;a<n.length;a++)this.util.testCollision(o[r],n[a])&&(s.push(o[r]),s.push(n[a]));return s},e.prototype.getObjectsByObjectSelector=function(e,t,i){var o=new Array;if(e.type==l.default.ALL_OBJECTS)o=t.level.customObjectArray;else if(e.type==l.default.LOOP_OBJECT){var n=e.loopVariableName;o.push(i.variables.get(n))}else if(e.type==l.default.ALL_OBJECTS_OF_TYPE)for(var s=0;s<t.level.customObjectArray.length;s++)t.level.customObjectArray[s].type.uid==e.objectType.uid&&o.push(t.level.customObjectArray[s]);return o},e.prototype.getObjectsFromType=function(e,t,i){var o=[],n=e.split(":");if(1==n.length)"customObject"==e&&(o=t.level.customObjectArray);else if(2==n.length){if("loopObject"==n[0]){var s=n[1];o.push(i.variables.get(s))}}else if(3==n.length&&"customObject"==n[0]&&"typeId"==n[1])for(var r=0;r<t.level.customObjectArray.length;r++)t.level.customObjectArray[r].type.id==n[2]&&o.push(t.level.customObjectArray[r]);return o},e}();t.default=d},function(e,t,i){"use strict";t.__esModule=!0;var o=i(43),n=i(12),s=i(0),r=function(){function e(e,t){this.variables=new Map,this.canvasAngle=0,this.currentFrame=0,this.fps=0,this.fpsFrames=0,this.fpsLastTime=performance.now(),this.play=e,this.levelDefinition=t,this.customObjectArray=[],this.buttonArray=[];var i=this.levelDefinition.levelVariables;if(null!=i)for(var o=0;o<i.length;o++)this.variables.set(i[o].name,i[o].initialValue);this.util=new s.default,this.initialize()}return e.prototype.initialize=function(){var e=this.levelDefinition.initialObjects;if(null!=e)for(var t=0;t<e.length;t++){var i=e[t],n=i.repeatTimes;null!=n&&0!=n||(n=1);var s=i.repeatTimes2;null!=s&&0!=s||(s=1);for(var r=0;r<n;r++)for(var a=0;a<s;a++)this.addCustomObject(i.objectType,i.x+r*this.util.zeroIfNull(i.dx)+a*this.util.zeroIfNull(i.dx2),i.y+r*this.util.zeroIfNull(i.dy)+a*this.util.zeroIfNull(i.dy2))}for(t=0;t<this.levelDefinition.buttons.length;t++){var l=this.levelDefinition.buttons[t],u=new o.default;u.definition=l,u.uid=l.uid,u.x=l.x,u.y=l.y,u.width=l.width,u.height=l.height,u.borderSize=l.borderSize,u.borderRadius=l.borderRadius,u.fontSize=l.fontSize,u.text=l.text,u.name=l.name,u.backgroundColor=l.backgroundColor,u.borderColor=l.borderColor,u.textColor=l.textColor,this.buttonArray.push(u)}},e.prototype.getVariable=function(e){var t=this.variables.get(e);return null==t?(this.variables.set(e,0),0):t},e.prototype.setVariable=function(e,t){this.variables.set(e,t)},e.prototype.addToVariable=function(e,t){var i=this.variables.get(e);null==i?this.variables.set(e,t):this.variables.set(e,i+t)},e.prototype.addCustomObject=function(e,t,i){var o=new n.default(t,i,this,e);return this.customObjectArray.push(o),o},e.prototype.update=function(){(this.updateCustomObjects(),this.updateButtons(),this.updateFps(),0==this.currentFrame)&&this.play.game.levelScriptsOnLevelStart.get(this.levelDefinition.uid)(this.play);this.play.game.levelScriptsOnAnimationFrame.get(this.levelDefinition.uid)(this.play)},e.prototype.updateFps=function(){this.fpsFrames++;var e=performance.now(),t=e-this.fpsLastTime;t>100&&(this.fps=1e3*this.fpsFrames/t,this.fpsFrames=0,this.fpsLastTime=e)},e.prototype.updateButtons=function(){for(var e=0;e<this.buttonArray.length;e++){var t=this.buttonArray[e];null!=this.play.mousePos&&t.isInsideButton(this.play.mousePos.x,this.play.mousePos.y)?(t.backgroundColor=t.definition.backgroundColorMouseOver,t.borderColor=t.definition.borderColorMouseOver,t.borderSize=t.definition.borderSizeMouseOver):(t.backgroundColor=t.definition.backgroundColor,t.borderColor=t.definition.borderColor,t.borderSize=t.definition.borderSize)}},e.prototype.updateCustomObjects=function(){for(var e=0;e<this.customObjectArray.length;e++)this.customObjectArray[e].update();if(0!=this.levelDefinition.electricConstant)for(var t=0;t<this.customObjectArray.length;t++)for(var i=0;i<this.customObjectArray.length;i++){var o=this.customObjectArray[t],n=this.customObjectArray[i];if(null!=o.electricCharge&&null!=n.electricCharge){var s=n.x-o.x,r=n.y-o.y;if((f=Math.sqrt(Math.pow(s,2)+Math.pow(r,2)))>10){var a=this.levelDefinition.electricConstant,l=o.electricCharge,u=n.electricCharge,c=-1*a*l*u*s/Math.pow(f,3),d=-1*a*l*u*r/Math.pow(f,3);o.speedX+=c/o.mass,o.speedY+=d/o.mass}}}if(this.levelDefinition.applyGravitationalForceBetweenObjects&&0!=this.levelDefinition.gravitationalConstant)for(var h=this.levelDefinition.gravitationalConstant,p=0;p<this.customObjectArray.length;p++)for(i=0;i<this.customObjectArray.length;i++){o=this.customObjectArray[p],n=this.customObjectArray[i];if(0!=o.mass&&0!=n.mass){var f;s=n.x-o.x,r=n.y-o.y;if((f=Math.sqrt(Math.pow(s,2)+Math.pow(r,2)))>3){c=h*o.mass*n.mass*s/Math.pow(f,3),d=h*o.mass*n.mass*r/Math.pow(f,3);o.speedX+=c/o.mass,o.speedY+=d/o.mass}}}this.removeObjectsMarkedToRemove()},e.prototype.removeObjectsMarkedToRemove=function(){for(var e=this.customObjectArray.length-1;e>=0;e--)this.customObjectArray[e].markedToRemove&&this.customObjectArray.splice(e,1)},e.prototype.getName=function(){return this.levelDefinition.name},e.prototype.getCurrentFrame=function(){return this.currentFrame},e}();t.default=r},function(e,t,i){"use strict";t.__esModule=!0;var o=function(){function e(){}return e.prototype.isInsideButton=function(e,t){return null!=e&&(null!=t&&(!(e<this.x-this.width/2)&&(!(e>this.x+this.width/2)&&(!(t<this.y-this.height/2)&&!(t>this.y+this.height/2)))))},e}();t.default=o},function(e,t,i){"use strict";t.__esModule=!0;var o=i(0),n=function(e){this.level=e,this.x=400,this.util=new o.default};t.default=n},function(e,t,i){"use strict";t.__esModule=!0;var o=function(){function e(e,t,i,o){void 0===o&&(o="100"),this.red=e,this.green=t,this.blue=i,this.alpha=o}return e.prototype.duplicate=function(){return new e(this.red,this.green,this.blue,this.alpha)},e}();t.default=o},function(e,t,i){"use strict";var o;t.__esModule=!0,function(e){e.OBJECT="OBJECT",e.GAME="GAME",e.LEVEL="LEVEL",e.MATH="MATH",e.TOUCH="TOUCH",e.ACCELEROMETER="ACCELEROMETER",e.MOUSE="MOUSE",e.OTHERS="OTHERS"}(o||(o={})),t.default=o},function(e,t,i){"use strict";t.__esModule=!0;var o=function(){};t.default=o},function(e,t,i){"use strict";t.__esModule=!0;var o=function(){};t.default=o},function(e,t,i){"use strict";t.__esModule=!0;var o=function(){function e(){}return e.prototype.duplicate=function(){var t=new e;return t.category=this.category,t.type=this.type,t.objectSelectorDefinition=this.objectSelectorDefinition.duplicate(),t.sourceObjectSelectorDefinition=this.sourceObjectSelectorDefinition.duplicate(),t.targetObjectSelectorDefinition=this.targetObjectSelectorDefinition.duplicate(),t.textType=this.textType,t.variableTextType=this.variableTextType,t.valueTextType=this.valueTextType,t.button=this.button,t.value=this.value,t.expression=this.expression,t.variable=this.variable,t.levelVariable=this.levelVariable,t.attribute=this.attribute,t.x=this.x,t.y=this.y,t.x1=this.x1,t.y1=this.y1,t.x2=this.x2,t.y2=this.y2,t.sourceX=this.sourceX,t.sourceY=this.sourceY,t.targetX=this.targetX,t.targetY=this.targetY,t.width=this.width,t.height=this.height,t.fillStyle=this.fillStyle,t.angle=this.angle,t.speed=this.speed,t.speedX=this.speedX,t.speedY=this.speedY,t.force=this.force,t.radius=this.radius,t.text=this.text,t.alpha=this.alpha,t.rotation=this.rotation,t.font=this.font,t.fontSize=this.fontSize,t.fontFamily=this.fontFamily,t.textAlign=this.textAlign,t.drawType=this.drawType,t.image=this.image.duplicate(),t.maxValue=this.maxValue,t.lineWidth=this.lineWidth,t.borderSize=this.borderSize,t.color=this.color.duplicate(),t.backgroundColor=this.backgroundColor.duplicate(),t.borderColor=this.borderColor.duplicate(),t.sourceType=this.sourceType,t.targetType=this.targetType,t.split=this.split,t.customObjectTypeId=this.customObjectTypeId,t.customObjectType=this.customObjectType,t.levelDefinition=this.levelDefinition,t.audio=this.audio.duplicate(),t.volume=this.volume,t},e}();t.default=o},function(e,t,i){"use strict";t.__esModule=!0;var o=function(){};t.default=o},function(e,t,i){"use strict";t.__esModule=!0;var o=function(){};t.default=o},function(e,t,i){"use strict";t.__esModule=!0;var o=function(){};t.default=o},function(e,t,i){"use strict";t.__esModule=!0;var o=i(54),n=i(32),s=i(33),r=i(0),a=i(56),l=i(1),u=i(31),c=function(){function e(e,t){this.vm=null,this.resourcesBaseUrl=null,this.util=new r.default,this.previewCanvas=document.getElementById("previewCanvas"),this.ctxPreview=null,this.levelPreviewRenderer=null,this.currentPreviewCanvasDragObject=null,this.currentPreviewCanvasDragText=null,this.currentPreviewCanvasDragButton=null,this.selectedObject=null,this.selectedText=null,this.selectedButton=null,this.dragOffsetX=0,this.dragOffsetY=0,this.lastDragX=0,this.lastDragY=0,this.draggingBackground=!1,this.previewCanvasMouseX=0,this.previewCanvasMouseY=0,this.dragStartRealWorldX=0,this.dragStartRealWorldY=0,this.dragStartRealWorldObjectX=0,this.dragStartRealWorldObjectY=0,this.newOffsetX=0,this.newOffsetY=0,this.zoom=1,this.lockObjects=!1,this.gridConfig=new a.default,this.newGridConfig=null,this.vm=e,this.resourcesBaseUrl=t,this.levelPreviewRenderer=new o.default(t,e),null!=this.previewCanvas&&(this.ctxPreview=this.previewCanvas.getContext("2d"))}return e.prototype.convertToWorldPositionX=function(e){return e/this.zoom+this.newOffsetX},e.prototype.convertToWorldPositionY=function(e){return e/this.zoom+this.newOffsetY},e.prototype.updateDragStartRealWorld=function(e){this.dragStartRealWorldX=this.convertToWorldPositionX(e.x),this.dragStartRealWorldY=this.convertToWorldPositionY(e.y)},e.prototype.updateDragStartRealWorldObject=function(e){this.dragStartRealWorldObjectX=e.x,this.dragStartRealWorldObjectY=e.y},e.prototype.deselectElements=function(){this.selectedObject=null,this.selectedText=null,this.selectedButton=null},e.prototype.editGridConfig=function(){this.newGridConfig=new a.default,this.newGridConfig.gridWidth=this.gridConfig.gridWidth,this.newGridConfig.gridHeight=this.gridConfig.gridHeight,this.newGridConfig.gridOriginX=this.gridConfig.gridOriginX,this.newGridConfig.gridOriginY=this.gridConfig.gridOriginY,this.newGridConfig.drawGrid=this.gridConfig.drawGrid,this.newGridConfig.snapToGrid=this.gridConfig.snapToGrid},e.prototype.updateGridConfig=function(){this.gridConfig=new a.default,this.gridConfig.gridWidth=Math.max(2,Number(this.newGridConfig.gridWidth)),this.gridConfig.gridHeight=Math.max(2,Number(this.newGridConfig.gridHeight)),this.gridConfig.gridOriginX=Number(this.newGridConfig.gridOriginX),this.gridConfig.gridOriginY=Number(this.newGridConfig.gridOriginY),this.gridConfig.drawGrid=this.newGridConfig.drawGrid,this.gridConfig.snapToGrid=this.newGridConfig.snapToGrid},e.prototype.updatePreviewCanvas=function(e,t){this.levelPreviewRenderer.currentMousePos=t},e.prototype.previewCanvasMouseWheel=function(e){this.zoom*=1-.001*e.deltaY,this.updateZoom()},e.prototype.previewCanvasMouseMove=function(e){var t=this.vm.gameParamsJson,i=t.canvasWidth,o=t.canvasHeight,n=this.util.getMousePos(this.previewCanvas,e,i,o);if(null!=this.currentPreviewCanvasDragObject){var s=this.convertToWorldPositionX(n.x)-this.dragStartRealWorldX,r=this.convertToWorldPositionY(n.y)-this.dragStartRealWorldY,a=this.dragStartRealWorldObjectX+s,l=this.dragStartRealWorldObjectY+r;this.gridConfig.snapToGrid&&(a=this.util.snapToGrid(a,this.gridConfig.gridWidth,this.gridConfig.gridOriginX),l=this.util.snapToGrid(l,this.gridConfig.gridHeight,this.gridConfig.gridOriginY)),this.currentPreviewCanvasDragObject.x=a,this.currentPreviewCanvasDragObject.y=l}if(null!=this.currentPreviewCanvasDragText){s=this.convertToWorldPositionX(n.x)-this.dragStartRealWorldX,r=this.convertToWorldPositionY(n.y)-this.dragStartRealWorldY,a=this.dragStartRealWorldObjectX+s,l=this.dragStartRealWorldObjectY+r;this.gridConfig.snapToGrid&&(a=this.util.snapToGrid(a,this.gridConfig.gridWidth,this.gridConfig.gridOriginX),l=this.util.snapToGrid(l,this.gridConfig.gridHeight,this.gridConfig.gridOriginY)),this.currentPreviewCanvasDragText.x=a,this.currentPreviewCanvasDragText.y=l}if(null!=this.currentPreviewCanvasDragButton){s=this.convertToWorldPositionX(n.x)-this.dragStartRealWorldX,r=this.convertToWorldPositionY(n.y)-this.dragStartRealWorldY,a=this.dragStartRealWorldObjectX+s,l=this.dragStartRealWorldObjectY+r;this.gridConfig.snapToGrid&&(a=this.util.snapToGrid(a,this.gridConfig.gridWidth,this.gridConfig.gridOriginX),l=this.util.snapToGrid(l,this.gridConfig.gridHeight,this.gridConfig.gridOriginY)),this.currentPreviewCanvasDragButton.x=a,this.currentPreviewCanvasDragButton.y=l}this.draggingBackground&&(this.levelPreviewRenderer.offsetX-=(Number(n.x)-this.lastDragX)/Number(this.zoom),this.levelPreviewRenderer.offsetY-=(Number(n.y)-this.lastDragY)/Number(this.zoom),this.newOffsetX=this.levelPreviewRenderer.offsetX,this.newOffsetY=this.levelPreviewRenderer.offsetY,this.lastDragX=n.x,this.lastDragY=n.y),this.updatePreviewCanvas(e,n),this.previewCanvasMouseX=Math.floor(n.x/this.zoom+this.levelPreviewRenderer.offsetX),this.previewCanvasMouseY=Math.floor(n.y/this.zoom+this.levelPreviewRenderer.offsetY)},e.prototype.updateCanvasOffset=function(){this.levelPreviewRenderer.offsetX=Number(this.newOffsetX),this.levelPreviewRenderer.offsetY=Number(this.newOffsetY)},e.prototype.resetCanvasOffset=function(){this.newOffsetX=0,this.newOffsetY=0,this.updateCanvasOffset()},e.prototype.updateZoom=function(){this.levelPreviewRenderer.zoom=Number(this.zoom)},e.prototype.resetZoom=function(){this.zoom=1,this.updateZoom()},e.prototype.zoomIn=function(){this.zoom*=1.2,this.updateZoom()},e.prototype.zoomOut=function(){this.zoom*=.8,this.updateZoom()},e.prototype.previewCanvasMouseUp=function(e){this.currentPreviewCanvasDragObject=null,this.currentPreviewCanvasDragText=null,this.currentPreviewCanvasDragButton=null,this.draggingBackground=!1},e.prototype.previewCanvasMouseDown=function(e){this.selectedObject=null,this.selectedText=null,this.selectedButton=null;var t=this.vm.gameParamsJson,i=t.canvasWidth,o=t.canvasHeight,n=this.util.getMousePos(this.previewCanvas,e,i,o),s=this.vm.gameParamsJson.levels[this.vm.currentLevelIndex];if(0==this.lockObjects){for(var r=0;r<s.initialObjects.length;r++){var a=s.initialObjects[r];this.util.isInside(n.x+this.levelPreviewRenderer.offsetX*this.zoom,n.y+this.levelPreviewRenderer.offsetY*this.zoom,(a.x-a.objectType.width/2)*this.zoom,(a.y-a.objectType.height/2)*this.zoom,a.objectType.width*this.zoom,a.objectType.height*this.zoom)&&(this.currentPreviewCanvasDragObject=a,this.selectedObject=a,this.updateDragStartRealWorld(n),this.updateDragStartRealWorldObject(a))}for(r=0;r<s.texts.length;r++){var l=s.texts[r];this.util.isInside(n.x+this.levelPreviewRenderer.offsetX*this.zoom,n.y+this.levelPreviewRenderer.offsetY*this.zoom,this.util.getTextLeftX(l,this.ctxPreview)*this.zoom,(l.y-l.fontSize/2)*this.zoom,this.util.measureText(l,this.ctxPreview)*this.zoom,l.fontSize*this.zoom)&&(this.currentPreviewCanvasDragText=l,this.selectedText=l,this.currentPreviewCanvasDragObject=null,this.selectedObject=null,this.updateDragStartRealWorld(n),this.dragStartRealWorldObjectX=Number(l.x),this.dragStartRealWorldObjectY=Number(l.y))}for(r=0;r<s.buttons.length;r++){var u=s.buttons[r],c=u.x-u.width/2,d=u.y-u.height/2,h=u.width,p=u.height;this.util.isInside(n.x+this.levelPreviewRenderer.offsetX*this.zoom,n.y+this.levelPreviewRenderer.offsetY*this.zoom,c*this.zoom,d*this.zoom,h*this.zoom,p*this.zoom)&&(this.currentPreviewCanvasDragButton=u,this.selectedButton=u,this.dragOffsetX=n.x-u.x,this.dragOffsetY=n.y-u.y,this.updateDragStartRealWorld(n),this.dragStartRealWorldObjectX=Number(u.x),this.dragStartRealWorldObjectY=Number(u.y))}}null==this.currentPreviewCanvasDragObject&&null==this.currentPreviewCanvasDragText&&null==this.currentPreviewCanvasDragButton&&(this.draggingBackground=!0,this.lastDragX=n.x,this.lastDragY=n.y)},e.prototype.editSelectedElement=function(){null!=this.selectedObject&&this.vm.editCustomObject(this.selectedObject),null!=this.selectedText&&this.vm.editLevelText(this.selectedText),null!=this.selectedButton&&this.vm.editButton(this.selectedButton)},e.prototype.cloneSelectedObject=function(){var e;null!=this.selectedObject&&((e=new n.default).x=this.selectedObject.x+this.selectedObject.objectType.width,e.y=this.selectedObject.y,e.objectType=this.selectedObject.objectType,this.vm.gameParamsJson.levels[this.vm.currentLevelIndex].initialObjects.push(e),this.selectedObject=e);null!=this.selectedText&&((e=new s.default).uid=this.util.uid(),e.x=this.selectedText.x+this.selectedText.fontSize,e.y=this.selectedText.y+this.selectedText.fontSize,e.align=this.selectedText.align,e.fontFamily=this.selectedText.fontFamily,e.fontSize=this.selectedText.fontSize,e.text=this.selectedText.text,e.color=new l.default(this.selectedText.color.red,this.selectedText.color.green,this.selectedText.color.blue),this.vm.gameParamsJson.levels[this.vm.currentLevelIndex].texts.push(e),this.selectedText=e);null!=this.selectedButton&&((e=new u.default).uid=this.util.uid(),e.x=this.selectedButton.x+this.selectedButton.height,e.y=this.selectedButton.y+this.selectedButton.height,e.name=this.selectedButton.name+"(2)",e.text=this.selectedButton.text,e.borderRadius=this.selectedButton.borderRadius,e.borderSize=this.selectedButton.borderSize,e.borderSizeMouseOver=this.selectedButton.borderSizeMouseOver,e.fontSize=this.selectedButton.fontSize,e.width=this.selectedButton.width,e.height=this.selectedButton.height,e.textColor=this.selectedButton.textColor,e.borderColorMouseOver=this.selectedButton.borderColorMouseOver,e.borderColor=this.selectedButton.borderColor,e.backgroundColorMouseOver=this.selectedButton.backgroundColorMouseOver,e.backgroundColor=this.selectedButton.backgroundColor,this.vm.gameParamsJson.levels[this.vm.currentLevelIndex].buttons.push(e),this.selectedButton=e)},e.prototype.deleteSelectedElement=function(){for(var e=this.vm.gameParamsJson.levels[this.vm.currentLevelIndex],t=0;t<e.initialObjects.length;t++)if(e.initialObjects[t]==this.selectedObject)return e.initialObjects.splice(t,1),void(this.selectedObject=null);for(t=0;t<e.texts.length;t++)if(e.texts[t]==this.selectedText)return e.texts.splice(t,1),void(this.selectedText=null);for(t=0;t<e.buttons.length;t++)if(e.buttons[t]==this.selectedButton)return e.buttons.splice(t,1),void(this.selectedButton=null)},e.prototype.drawPreview=function(){this.previewCanvas=document.getElementById("previewCanvas"),null!=this.previewCanvas&&(this.ctxPreview=this.previewCanvas.getContext("2d")),null!=this.ctxPreview&&this.levelPreviewRenderer.render(this.vm.oldLevel,this.vm.gameParamsJson,this.ctxPreview,this)},e}();t.default=c},function(e,t,i){"use strict";t.__esModule=!0;var o=i(1),n=i(55),s=i(0),r=i(5),a=i(22),l=i(3),u=function(){function e(e,t){this.imageLoader=null,this.util=new s.default,this.renderUtil=new a.default,this.currentMousePos=null,this.offsetX=0,this.offsetY=0,this.zoom=1,this.imageLoader=new n.default(e,t)}return e.prototype.renderLevelBorder=function(e){e.save(),e.beginPath(),e.rect(-this.offsetX*this.zoom,-this.offsetY*this.zoom,600*this.zoom,500*this.zoom),e.strokeStyle="#333333",e.lineWidth=3,e.globalAlpha=.5,e.stroke(),e.restore()},e.prototype.renderTextDefinitionBorder=function(e,t){var i=this.util.measureText(e,t),n=e.x-i/2,s=e.y-e.fontSize/2,r=i,a=e.fontSize;"left"==e.align?n+=r/2:"right"==e.align&&(n-=r/2),t.beginPath(),t.rect(n*this.zoom-this.offsetX*this.zoom,s*this.zoom-this.offsetY*this.zoom,r*this.zoom,a*this.zoom),t.closePath(),t.strokeStyle=this.util.buildFillStyleFromColor(new o.default(0,0,255,100)),t.lineWidth=2,t.stroke()},e.prototype.renderTextBorder=function(e,t,i){if(null!=this.currentMousePos){null!=t.selectedText&&this.renderTextDefinitionBorder(t.selectedText,i);for(var n=e.texts,s=0;s<n.length;s++){var r=n[s],a=this.util.measureText(r,i),l=r.x-a/2,u=r.y-r.fontSize/2,c=a,d=r.fontSize;"left"==r.align?l+=c/2:"right"==r.align&&(l-=c/2),this.util.isInside(this.currentMousePos.x+this.offsetX*this.zoom,this.currentMousePos.y+this.offsetY*this.zoom,l*this.zoom,u*this.zoom,c*this.zoom,d*this.zoom)&&(i.beginPath(),i.rect(l*this.zoom-this.offsetX*this.zoom,u*this.zoom-this.offsetY*this.zoom,c*this.zoom,d*this.zoom),i.closePath(),i.strokeStyle=this.util.buildFillStyleFromColor(new o.default(0,0,255,50)),i.lineWidth=2,i.stroke())}}},e.prototype.renderButtonBorder=function(e,t,i){if(null!=this.currentMousePos){if(null!=t.selectedButton){var n=(c=t.selectedButton).x-c.width/2,s=c.y-c.height/2,r=c.width,a=c.height;i.beginPath(),i.rect(n*this.zoom-this.offsetX*this.zoom-2,s*this.zoom-this.offsetY*this.zoom-2,r*this.zoom+4,a*this.zoom+4),i.closePath(),i.strokeStyle=this.util.buildFillStyleFromColor(new o.default(0,0,255,100)),i.lineWidth=2,i.stroke()}for(var l=e.buttons,u=0;u<l.length;u++){var c;n=(c=l[u]).x-c.width/2,s=c.y-c.height/2,r=c.width,a=c.height;this.util.isInside(this.currentMousePos.x+this.offsetX*this.zoom,this.currentMousePos.y+this.offsetY*this.zoom,n*this.zoom,s*this.zoom,r*this.zoom,a*this.zoom)&&(i.beginPath(),i.rect(n*this.zoom-this.offsetX*this.zoom-2,s*this.zoom-this.offsetY*this.zoom-2,r*this.zoom+4,a*this.zoom+4),i.closePath(),i.strokeStyle=this.util.buildFillStyleFromColor(new o.default(0,0,255,50)),i.lineWidth=2,i.stroke())}}},e.prototype.renderObjectBorder=function(e,t,i){if(null!=this.currentMousePos){if(null!=t.selectedObject){var n=t.selectedObject.x-t.selectedObject.objectType.width/2,s=t.selectedObject.y-t.selectedObject.objectType.height/2,r=t.selectedObject.objectType.width,a=t.selectedObject.objectType.height;i.beginPath(),i.rect(n*this.zoom-this.offsetX*this.zoom,s*this.zoom-this.offsetY*this.zoom,r*this.zoom,a*this.zoom),i.closePath(),i.strokeStyle=this.util.buildFillStyleFromColor(new o.default(0,0,255,100)),i.lineWidth=2,i.stroke()}for(var l=e.initialObjects,u=0;u<l.length;u++){var c=l[u],d=c.objectType;if(null!=d){n=c.x-d.width/2,s=c.y-d.height/2,r=d.width,a=d.height;this.util.isInside(this.currentMousePos.x+this.offsetX*this.zoom,this.currentMousePos.y+this.offsetY*this.zoom,n*this.zoom,s*this.zoom,r*this.zoom,a*this.zoom)&&(i.beginPath(),i.rect(n*this.zoom-this.offsetX*this.zoom,s*this.zoom-this.offsetY*this.zoom,r*this.zoom,a*this.zoom),i.closePath(),i.strokeStyle=this.util.buildFillStyleFromColor(new o.default(0,0,255,50)),i.lineWidth=2,i.stroke())}}}},e.prototype.render=function(e,t,i,o){i.clearRect(0,0,600,500),null!=e&&null!=t&&(this.drawBackground(e,i),this.renderLevelBorder(i),this.renderObjects(e,i),this.renderTexts(e,i),this.renderButtons(i,e),this.renderObjectBorder(e,o,i),this.renderTextBorder(e,o,i),this.renderButtonBorder(e,o,i)),o.gridConfig.drawGrid&&this.renderGrid(i,o)},e.prototype.renderTexts=function(e,t){var i=e.texts;if(null!=i)for(var o=0;o<i.length;o++){var n=this.util.buildFillStyleFromColor(i[o].color),s=i[o].fontSize*this.zoom+"px "+i[o].fontFamily;this.util.drawText(t,i[o].text,i[o].x*this.zoom-this.offsetX*this.zoom,i[o].y*this.zoom-this.offsetY*this.zoom,s,n,i[o].align,"middle")}},e.prototype.renderObjects=function(e,t){for(var i=e.initialObjects,o=0;o<i.length;o++){var n=i[o];null!=n.objectType&&this.drawCustomObject(n,t,this.offsetX,this.offsetY,this.zoom)}},e.prototype.drawCustomObject=function(e,t,i,o,n){var s=this.imageLoader.loadAndGetImage(e.objectType.image.imageId);e.objectType.renderType==l.default.IMAGE&&null!=s&&t.drawImage(s,e.x*n-i*n-e.objectType.width/2*n,e.y*n-o*n-e.objectType.height/2*n,e.objectType.width*n,e.objectType.height*n)},e.prototype.renderGrid=function(e,t){e.strokeStyle="#999999",e.lineWidth=1,e.globalAlpha=.5;for(var i=t.gridConfig.gridWidth,o=t.gridConfig.gridHeight,n=(-this.offsetX+t.gridConfig.gridOriginX)%i,s=(-this.offsetY+t.gridConfig.gridOriginY)%o,r=(n+i+600)/this.zoom,a=(s+o+500)/this.zoom,l=n;l<r;l+=i)e.beginPath(),e.moveTo(l*this.zoom+.5*this.zoom,0+.5*this.zoom),e.lineTo(l*this.zoom+.5*this.zoom,500+.5*this.zoom),e.stroke();for(var u=s;u<a;u+=o)e.beginPath(),e.moveTo(0+.5*this.zoom,u*this.zoom+.5*this.zoom),e.lineTo(600+.5*this.zoom,u*this.zoom+.5*this.zoom),e.stroke();e.globalAlpha=1},e.prototype.drawBackground=function(e,t){if(e.backgroundType==r.default.SOLID_COLOR){var i=e.backgroundColor;return t.fillStyle=this.util.buildFillStyleFromColor(i),void t.fillRect(0,0,600,500)}var o=this.imageLoader.loadAndGetImage(e.backgroundImage.imageId);if(null!=o){var n=e.backgroundImageWidth,s=e.backgroundImageHeight,a=-this.offsetX%n,l=-this.offsetY%s;l>0&&(l-=s),a>0&&(a-=n);for(var u=a,c=l;c<500/this.zoom+s;){for(;u<600/this.zoom+n;)t.drawImage(o,u*this.zoom,c*this.zoom,n*this.zoom+1,s*this.zoom+1),u+=n;u=a,c+=s}}},e.prototype.renderButtons=function(e,t){for(var i=0;i<t.buttons.length;i++){var o=t.buttons[i];this.renderButton(e,o)}},e.prototype.renderButton=function(e,t){e.fillStyle=this.util.buildFillStyleFromColor(t.backgroundColor),e.strokeStyle=this.util.buildFillStyleFromColor(t.borderColor),e.lineWidth=t.borderSize;var i=t.borderRadius,o=t.fontSize*this.zoom+"px Arial",n=this.util.buildFillStyleFromColor(t.textColor);this.renderUtil.drawRoundRect(e,t.x*this.zoom-t.width/2*this.zoom-this.offsetX*this.zoom,t.y*this.zoom-t.height/2*this.zoom-this.offsetY*this.zoom,t.width*this.zoom,t.height*this.zoom,i*this.zoom,!0,!0),this.util.drawText(e,t.text,t.x*this.zoom-this.offsetX*this.zoom,t.y*this.zoom+1*this.zoom-this.offsetY*this.zoom,o,n,"center","middle")},e}();t.default=u},function(e,t,i){"use strict";t.__esModule=!0;var o=i(0),n=function(){function e(e,t){this.imageIds=new Set,this.images=new Map,this.numImagesLoaded=0,this.resourcesBaseUrl=null,this.actionTemplateController=null,this.util=new o.default,this.resourcesBaseUrl=e,this.actionTemplateController=t}return e.prototype.loadImage=function(e,t){if(this.imageIds.has(e))null!=t&&t();else{this.imageIds.add(e);var i=this,o=new Image;if(o.onload=function(){i.numImagesLoaded++,null!=t&&t()},e.startsWith("custom:")){var n=e.substring(7),s=this.util.findElementByUid(this.actionTemplateController.gameParamsJson.customImages,n);o.src=s.imageData}else o.src=this.resourcesBaseUrl+e;this.images.set(e,o)}},e.prototype.loadImages=function(e,t){if(0!=e.size)for(var i=Array.from(e),o=0;o<i.length;o++){var n=i[o];this.loadImage(n,t)}else t()},e.prototype.getImage=function(e){return this.images.get(e)},e.prototype.loadAndGetImage=function(e){return this.loadImage(e,null),this.images.get(e)},e}();t.default=n},function(e,t,i){"use strict";t.__esModule=!0;var o=function(){this.drawGrid=!0,this.snapToGrid=!1,this.gridWidth=20,this.gridHeight=20,this.gridOriginX=0,this.gridOriginY=0};t.default=o},function(e,t,i){"use strict";t.__esModule=!0;var o=function(){};t.default=o},function(e,t,i){"use strict";t.__esModule=!0;var o=function(){function e(){}return e.prototype.duplicate=function(){var t=new e;return t.audioSourceType=this.audioSourceType,t.audioPath=this.audioPath,t.customAudio=this.customAudio,t},e}();t.default=o},function(e,t,i){"use strict";t.__esModule=!0;var o=function(){};t.default=o},function(e,t,i){"use strict";t.__esModule=!0;var o=i(0),n=function(){function e(e){this.errorMessage=null,this.errorField=null,this.newCustomObjectTypeBehaviour=null,this.oldCustomObjectTypeBehaviour=null,this.customObjectTypeBehaviourTypes=[{code:"KEYBOARD_MOVEMENT",name:"Keyboard movement"},{code:"MOUSE_MOVEMENT",name:"Mouse movement"},{code:"STOP_ON_OBJECT",name:"Stop on object"},{code:"BOUNCE_ON_OBJECT",name:"Bounce on object"},{code:"JUMP_ON_PLATFORM",name:"Jump on platform"}],this.mainController=e,this.util=new o.default}return e.prototype.addCustomObjectTypeBehaviour=function(e){this.mainController.gameParamsJson.customObjectTypes[e].behaviours.push({type:"KEYBOARD_MOVEMENT",keyboardMovementDirections:"8_DIRECTIONS",keyboardMovementKeys:"ARROW_KEYS_OR_WASD_KEYS",keyboardMovementType:"SET_SPEED_ON_KEY_DOWN",speedX:3,speedY:3,accelerationX:.1,accelerationY:.1})},e.prototype.deleteCustomObjectTypeBehaviour=function(e,t){this.mainController.gameParamsJson.customObjectTypes[this.mainController.currentCustomObjectTypeIndex].behaviours.splice(t,1)},e.prototype.editCustomObjectTypeBehaviour=function(e){this.errorMessage=null,this.mainController.setCurrentScreen("EDIT_CUSTOM_OBJECT_TYPE_BEHAVIOUR"),this.oldCustomObjectTypeBehaviour=e,this.newCustomObjectTypeBehaviour=JSON.parse(JSON.stringify(e))},e.prototype.validate=function(){if(this.errorMessage=null,this.errorField=null,"KEYBOARD_MOVEMENT"==this.newCustomObjectTypeBehaviour.type){if(null==this.newCustomObjectTypeBehaviour.keyboardMovementDirections)return this.errorMessage='Field "Directions" is required.',!1;if(null==this.newCustomObjectTypeBehaviour.keyboardMovementKeys)return this.errorMessage='Field "Keyboard keys" is required.',!1;if(null==this.newCustomObjectTypeBehaviour.keyboardMovementType)return this.errorMessage='Field "Movement type" is required.',!1;if("SET_SPEED_ON_KEY_DOWN"==this.newCustomObjectTypeBehaviour.keyboardMovementType&&("8_DIRECTIONS"==this.newCustomObjectTypeBehaviour.keyboardMovementDirections||"LEFT_AND_RIGHT"==this.newCustomObjectTypeBehaviour.keyboardMovementDirections)&&this.util.isEmpty(this.newCustomObjectTypeBehaviour.speedX))return this.errorMessage='Field "speedX" is required.',this.errorField="speedX",!1;if("SET_SPEED_ON_KEY_DOWN"==this.newCustomObjectTypeBehaviour.keyboardMovementType&&("8_DIRECTIONS"==this.newCustomObjectTypeBehaviour.keyboardMovementDirections||"UP_AND_DOWN"==this.newCustomObjectTypeBehaviour.keyboardMovementDirections)&&this.util.isEmpty(this.newCustomObjectTypeBehaviour.speedY))return this.errorMessage='Field "speedY" is required.',this.errorField="speedY",!1;if("SET_ACCELERATION_ON_KEY_DOWN"==this.newCustomObjectTypeBehaviour.keyboardMovementType&&("8_DIRECTIONS"==this.newCustomObjectTypeBehaviour.keyboardMovementDirections||"LEFT_AND_RIGHT"==this.newCustomObjectTypeBehaviour.keyboardMovementDirections)&&this.util.isEmpty(this.newCustomObjectTypeBehaviour.accelerationX))return this.errorMessage='Field "accelerationX" is required.',this.errorField="accelerationX",!1;if("SET_ACCELERATION_ON_KEY_DOWN"==this.newCustomObjectTypeBehaviour.keyboardMovementType&&("8_DIRECTIONS"==this.newCustomObjectTypeBehaviour.keyboardMovementDirections||"UP_AND_DOWN"==this.newCustomObjectTypeBehaviour.keyboardMovementDirections)&&this.util.isEmpty(this.newCustomObjectTypeBehaviour.accelerationY))return this.errorMessage='Field "accelerationY" is required.',this.errorField="accelerationY",!1}else if("MOUSE_MOVEMENT"==this.newCustomObjectTypeBehaviour.type){if(null==this.newCustomObjectTypeBehaviour.mouseMovementType)return this.errorMessage='Field "Mouse movement type" is required.',this.errorField="mouseMovementType",!1;if(this.util.isEmpty(this.newCustomObjectTypeBehaviour.factorX))return this.errorMessage='Field "factorX" is required.',this.errorField="factorX",!1;if(this.util.isEmpty(this.newCustomObjectTypeBehaviour.factorY))return this.errorMessage='Field "factorY" is required.',this.errorField="factorY",!1}else if("STOP_ON_OBJECT"==this.newCustomObjectTypeBehaviour.type){if(null==this.newCustomObjectTypeBehaviour.objectSelector)return this.errorMessage='Field "Object type" is required.',this.errorField="objectSelector",!1;var e=this.mainController.gameParamsJson.customObjectTypes[this.mainController.currentCustomObjectTypeIndex];if(this.newCustomObjectTypeBehaviour.objectSelector==e.uid)return this.errorMessage='"Object type" cannot be the same as the current object type.',this.errorField="objectSelector",!1}else if("BOUNCE_ON_OBJECT"==this.newCustomObjectTypeBehaviour.type){if(null==this.newCustomObjectTypeBehaviour.objectSelector)return this.errorMessage='Field "Object type" is required.',this.errorField="objectSelector",!1;if(this.util.isEmpty(this.newCustomObjectTypeBehaviour.bounceSpeed))return this.errorMessage='Field "Bounce speed" is required.',this.errorField="bounceSpeed",!1;e=this.mainController.gameParamsJson.customObjectTypes[this.mainController.currentCustomObjectTypeIndex];if(this.newCustomObjectTypeBehaviour.objectSelector==e.uid)return this.errorMessage='"Object type" cannot be the same as the current object type.',this.errorField="objectSelector",!1}else if("JUMP_ON_PLATFORM"==this.newCustomObjectTypeBehaviour.type){if(null==this.newCustomObjectTypeBehaviour.objectSelector)return this.errorMessage="Platform object type is required.",this.errorField="objectSelector",!1;e=this.mainController.gameParamsJson.customObjectTypes[this.mainController.currentCustomObjectTypeIndex];if(this.newCustomObjectTypeBehaviour.objectSelector==e.uid)return this.errorMessage='"Platform object type" cannot be the same as the current object type.',this.errorField="objectSelector",!1;if(null==this.newCustomObjectTypeBehaviour.jumpKey)return this.errorMessage='Field "Jump key" is required.',this.errorField="jumpKey",!1;if(this.util.isEmpty(this.newCustomObjectTypeBehaviour.jumpSpeed))return this.errorMessage='Field "Jump speed" is required.',this.errorField="jumpSpeed",!1}return!0},e.prototype.updateCustomObjectTypeBehaviour=function(){this.validate()&&(this.mainController.setCurrentTab2("CUSTOM_OBJECT_TYPE_BEHAVIOURS"),this.oldCustomObjectTypeBehaviour.type=this.newCustomObjectTypeBehaviour.type,this.oldCustomObjectTypeBehaviour.keyboardMovementType=this.newCustomObjectTypeBehaviour.keyboardMovementType,this.oldCustomObjectTypeBehaviour.keyboardMovementDirections=this.newCustomObjectTypeBehaviour.keyboardMovementDirections,this.oldCustomObjectTypeBehaviour.keyboardMovementKeys=this.newCustomObjectTypeBehaviour.keyboardMovementKeys,this.oldCustomObjectTypeBehaviour.mouseMovementType=this.newCustomObjectTypeBehaviour.mouseMovementType,this.oldCustomObjectTypeBehaviour.speedX=Number(this.newCustomObjectTypeBehaviour.speedX),this.oldCustomObjectTypeBehaviour.speedY=Number(this.newCustomObjectTypeBehaviour.speedY),this.oldCustomObjectTypeBehaviour.accelerationX=Number(this.newCustomObjectTypeBehaviour.accelerationX),this.oldCustomObjectTypeBehaviour.accelerationY=Number(this.newCustomObjectTypeBehaviour.accelerationY),this.oldCustomObjectTypeBehaviour.factorX=Number(this.newCustomObjectTypeBehaviour.factorX),this.oldCustomObjectTypeBehaviour.factorY=Number(this.newCustomObjectTypeBehaviour.factorY),this.oldCustomObjectTypeBehaviour.objectSelector=this.newCustomObjectTypeBehaviour.objectSelector,this.oldCustomObjectTypeBehaviour.bounceSpeed=Number(this.newCustomObjectTypeBehaviour.bounceSpeed),this.oldCustomObjectTypeBehaviour.jumpKey=this.newCustomObjectTypeBehaviour.jumpKey,this.oldCustomObjectTypeBehaviour.jumpSpeed=Number(this.newCustomObjectTypeBehaviour.jumpSpeed),this.oldCustomObjectTypeBehaviour=null,this.newCustomObjectTypeBehaviour=null)},e.prototype.cancelChangesCustomObjectTypeBehaviour=function(){this.errorMessage=null,this.errorField=null,this.mainController.setCurrentTab2("CUSTOM_OBJECT_TYPE_BEHAVIOURS"),this.oldCustomObjectTypeBehaviour=null,this.newCustomObjectTypeBehaviour=null},e}();t.default=n},function(e,t,i){"use strict";t.__esModule=!0;var o=i(15),n=i(4),s=i(2),r=i(27),a=i(0),l=function(){function e(e){this.genericService=new r.default,this.newLoop=null,this.oldLoop=null,this.currentBlock=null,this.loopTypes=this.genericService.getLoopTypes(),this.loopObjectSelectorTypes=[{value:s.default.ALL_OBJECTS_OF_TYPE,name:"All objects of type..."}],this.errorMessage=null,this.errorField=null,this.mainController=e,this.util=new a.default}return e.prototype.deleteLoop=function(e,t){this.mainController.gameParamsJson.events[e].loops.splice(t,1)},e.prototype.editLoop=function(e,t){this.mainController.setCurrentScreen("EDIT_LOOP"),this.oldLoop=e,this.newLoop=JSON.parse(JSON.stringify(this.oldLoop)),this.currentBlock=t,null==this.newLoop.objectSelectorDefinition.objectType&&(this.newLoop.objectSelectorDefinition.objectType=new o.default)},e.prototype.cancelChangesLoop=function(){"LEVELS"==this.mainController.currentTab?this.mainController.setCurrentTab2("LEVEL_EVENTS"):"VISUAL_SCRIPTS"==this.mainController.currentTab&&this.mainController.setCurrentTab("VISUAL_SCRIPTS"),this.errorMessage=null,this.errorField=null,this.oldLoop=null,this.newLoop=null,this.mainController.visualScriptController.selectBlock(this.currentBlock)},e.prototype.validate=function(){if(this.errorMessage=null,this.errorField=null,null==this.newLoop.type)return this.errorMessage='Field "Loop type" is required.',this.errorField="type",!1;if(this.newLoop.type==n.default.REPEAT_X_TIMES){if(null==this.newLoop.times)return this.errorMessage='Field "times" is required.',this.errorField="times",!1}else if(this.newLoop.type==n.default.OBJECT){if(null==this.newLoop.objectSelectorDefinition.type)return this.errorMessage='Field "objectSelector" is required.',this.errorField="objectSelectorDefinition.type",!1;if(null==this.newLoop.objectSelectorDefinition.objectType||null==this.newLoop.objectSelectorDefinition.objectType.uid)return this.errorMessage='Field "customObjectTypeId" is required.',this.errorField="customObjectTypeId",!1;if(this.util.isEmpty(this.newLoop.loopVariableName))return this.errorMessage='Field "loopVariableName" is required.',this.errorField="loopVariableName",!1;if(this.newLoop.loopVariableName.includes(" "))return this.errorMessage='Field "loopVariableName" cannot contain white spaces.',this.errorField="loopVariableName",!1;if(!this.newLoop.loopVariableName.match(/^[a-zA-Z0-9_]+$/i))return this.errorMessage='Field "loopVariableName" can contain only letters, numbers and underscore.',this.errorField="loopVariableName",!1}else if(this.newLoop.type==n.default.NUMBER){if(this.util.isEmpty(this.newLoop.from))return this.errorMessage='Field "from" is required.',this.errorField="from",!1;if(this.util.isEmpty(this.newLoop.to))return this.errorMessage='Field "to" is required.',this.errorField="to",!1;if(this.util.isEmpty(this.newLoop.increment))return this.errorMessage='Field "increment" is required.',this.errorField="increment",!1;if(this.util.isEmpty(this.newLoop.loopVariableName))return this.errorMessage='Field "loopVariableName" is required.',this.errorField="loopVariableName",!1;if(this.newLoop.loopVariableName.includes(" "))return this.errorMessage='Field "loopVariableName" cannot contain white spaces.',this.errorField="loopVariableName",!1;if(!this.newLoop.loopVariableName.match(/^[a-zA-Z0-9_]+$/i))return this.errorMessage='Field "loopVariableName" can contain only letters, numbers and underscore.',this.errorField="loopVariableName",!1;if(0==this.newLoop.increment)return this.errorMessage="Increment cannot be 0.",this.errorField="increment",!1;if(this.newLoop.from>this.newLoop.to&&this.newLoop.increment>0)return this.errorMessage="Increment must be negative.",this.errorField="increment",!1;if(this.newLoop.from<this.newLoop.to&&this.newLoop.increment<0)return this.errorMessage="Increment must be positive.",this.errorField="increment",!1}return!0},e.prototype.updateLoop=function(){if(this.validate()){if("LEVELS"==this.mainController.currentTab?this.mainController.setCurrentTab2("LEVEL_EVENTS"):"VISUAL_SCRIPTS"==this.mainController.currentTab&&this.mainController.setCurrentTab("VISUAL_SCRIPTS"),this.oldLoop.type=this.newLoop.type,this.oldLoop.loopVariableName=this.newLoop.loopVariableName,this.oldLoop.from=Number(this.newLoop.from),this.oldLoop.to=Number(this.newLoop.to),this.oldLoop.increment=Number(this.newLoop.increment),this.oldLoop.times=Number(this.newLoop.times),this.newLoop.type==n.default.OBJECT){var e=this.newLoop.objectSelectorDefinition.objectType.uid;this.oldLoop.objectSelectorDefinition=this.newLoop.objectSelectorDefinition,this.oldLoop.objectSelectorDefinition.objectType=this.util.findCustomObjectDefinitionByUid(this.mainController.gameParamsJson.customObjectTypes,e)}this.oldLoop=null,this.newLoop=null,this.mainController.visualScriptController.selectBlock(this.currentBlock),this.mainController.saveJsonToLocalStorage()}},e.prototype.fillLoopVariableName=function(){if(null==this.newLoop.loopVariableName||""==this.newLoop.loopVariableName)for(var e=0;e<this.mainController.gameParamsJson.customObjectTypes.length;e++)if(this.mainController.gameParamsJson.customObjectTypes[e].uid==this.newLoop.objectSelectorDefinition.objectType.uid){var t=this.mainController.gameParamsJson.customObjectTypes[e].id;this.newLoop.loopVariableName=t.replace(/ /gi,"")}},e}();t.default=l},function(e,t,i){"use strict";t.__esModule=!0;var o=i(0),n=function(e){this.mainController=e,this.util=new o.default};t.default=n},function(e,t,i){"use strict";t.__esModule=!0;var o=function(){};t.default=o},function(e,t,i){"use strict";t.__esModule=!0;var o=i(65),n=i(66),s=i(8),r=i(67),a=i(68),l=i(15),u=i(29),c=i(69),d=i(9),h=i(70),p=i(4),f=i(10),m=i(11),v=i(0),y=function(){function e(e){this.selectedBlockUid="",this.startSelected=!1,this.endSelected=!1,this.newComment="",this.mainController=e,this.util=new v.default}return e.prototype.selectBlock=function(e){this.unselectBlock(),this.selectedBlock=e,this.selectedBlockUid=e.uid},e.prototype.unselectBlock=function(){this.selectedBlock=null,this.selectedBlockUid="",this.startSelected=!1,this.endSelected=!1},e.prototype.toggleBlock=function(e){this.selectedBlockUid==e.uid?this.unselectBlock():(this.unselectBlock(),this.selectBlock(e))},e.prototype.getBlockSiblings=function(e,t){var i=e.parentBlock;if(null==i)return t.blocks;if(i.blockType==s.default.LOOP)return i.loopBlock.blocks;if(i.blockType==s.default.CONDITION){var o=i.conditionBlock.ifBlocks,n=o.findIndex((function(t){return t.uid==e.uid}));if(-1!=n)return o;var r=i.conditionBlock.elseBlocks;return-1!=(n=r.findIndex((function(t){return t.uid==e.uid})))?r:null}return null},e.prototype.moveBlock=function(e,t,i){var o=this.getBlockSiblings(e,t),n=o.findIndex((function(t){return t.uid==e.uid}));this.util.arrayMove(o,n,n+i)},e.prototype.moveBlockUp=function(e,t){this.moveBlock(e,t,-1)},e.prototype.moveBlockDown=function(e,t){this.moveBlock(e,t,1)},e.prototype.duplicateBlock=function(e,t){var i=e.duplicate(e.parentBlock);if(null==e.parentBlock){var o=t.blocks.findIndex((function(t){return t.uid==e.uid}));t.blocks.splice(o+1,0,i)}else if(e.parentBlock.blockType==s.default.LOOP){o=e.parentBlock.loopBlock.blocks.findIndex((function(t){return t.uid==e.uid}));e.parentBlock.loopBlock.blocks.splice(o+1,0,i)}else if(e.parentBlock.blockType==s.default.CONDITION){-1!=(o=e.parentBlock.conditionBlock.ifBlocks.findIndex((function(t){return t.uid==e.uid})))||(o=e.parentBlock.conditionBlock.elseBlocks.findIndex((function(t){return t.uid==e.uid}))),e.parentBlock.conditionBlock.ifBlocks.splice(o+1,0,i)}this.selectBlock(i)},e.prototype.generateVisualScriptSourceCode=function(e){return(new m.default).generateVisualScriptSourceCode(e,this.mainController.gameParamsJson,0)},e.prototype.editCommentBlock=function(e){this.newComment=e.comment,this.mainController.currentBlock=e,this.mainController.setCurrentScreen("EDIT_COMMENT_BLOCK")},e.prototype.updateBlockComment=function(){"LEVELS"==this.mainController.currentTab?this.mainController.setCurrentTab2("LEVEL_EVENTS"):"VISUAL_SCRIPTS"==this.mainController.currentTab&&this.mainController.setCurrentTab("VISUAL_SCRIPTS"),this.mainController.currentBlock.comment=this.newComment,this.newComment="",this.mainController.saveJsonToLocalStorage()},e.prototype.cancelChangesBlockComment=function(){"LEVELS"==this.mainController.currentTab?this.mainController.setCurrentTab2("LEVEL_EVENTS"):"VISUAL_SCRIPTS"==this.mainController.currentTab&&this.mainController.setCurrentTab("VISUAL_SCRIPTS"),this.newComment=""},e.prototype.buildCommentBlock=function(e){var t=new n.default;return t.uid=this.util.uid(),t.blockType=s.default.COMMENT,t.comment="Add comment here...",t.parentBlock=e,t},e.prototype.addActionBlock=function(e){var t=this.buildActionBlock(null);e.blocks.push(t),this.selectBlock(t)},e.prototype.buildBlock=function(e,t){return e==s.default.ACTION?this.buildActionBlock(t):e==s.default.CONDITION?this.buildConditionBlock(t):e==s.default.LOOP?this.buildLoopBlock(t):e==s.default.COMMENT?this.buildCommentBlock(t):null},e.prototype.addBlock=function(e,t,i,o){var n=null;"BEFORE"==o||"AFTER"==o?n=i.parentBlock:"INSIDE"==o||"INSIDE_ELSE"==o?n=i:("END"==o||"START"==o)&&(n=null);var r=this.buildBlock(e,n);if(null==n)if("BEFORE"==o){var a=t.blocks.findIndex((function(e){return e.uid==i.uid}));t.blocks.splice(a,0,r)}else if("AFTER"==o){a=t.blocks.findIndex((function(e){return e.uid==i.uid}));t.blocks.splice(a+1,0,r)}else"END"==o?t.blocks.push(r):"START"==o&&t.blocks.unshift(r);else if(n.blockType==s.default.LOOP){if("INSIDE"==o)n.loopBlock.blocks.push(r);else if("BEFORE"==o){a=n.loopBlock.blocks.findIndex((function(e){return e.uid==i.uid}));n.loopBlock.blocks.splice(a,0,r)}else if("AFTER"==o){a=n.loopBlock.blocks.findIndex((function(e){return e.uid==i.uid}));n.loopBlock.blocks.splice(a+1,0,r)}}else if(n.blockType==s.default.CONDITION)if("INSIDE"==o)n.conditionBlock.ifBlocks.push(r);else if("INSIDE_ELSE"==o)n.conditionBlock.elseBlocks.push(r);else if("BEFORE"==o){a=n.conditionBlock.ifBlocks.findIndex((function(e){return e.uid==i.uid}));n.conditionBlock.ifBlocks.splice(a,0,r)}else if("AFTER"==o){a=n.conditionBlock.ifBlocks.findIndex((function(e){return e.uid==i.uid}));n.conditionBlock.ifBlocks.splice(a+1,0,r)}this.selectBlock(r)},e.prototype.addActionBlockToConditionIfBlocks=function(e){var t=this.buildActionBlock(e);e.conditionBlock.ifBlocks.push(t),this.selectBlock(t)},e.prototype.addLoopToConditionIfBlocks=function(e){var t=this.buildLoopBlock(e);e.conditionBlock.ifBlocks.push(t),this.selectBlock(t)},e.prototype.buildActionBlock=function(e){var t=this.mainController.buildEventAction(),i=new o.default;i.uid=this.util.uid(),i.action=t;var r=new n.default;return r.uid=this.util.uid(),r.description="",r.blockType=s.default.ACTION,r.actionBlock=i,r.parentBlock=e,r},e.prototype.addActionToLoop=function(e){var t=this.buildActionBlock(e);e.loopBlock.blocks.push(t),this.selectBlock(t)},e.prototype.addLoopToLoop=function(e){var t=this.buildLoopBlock(e);e.loopBlock.blocks.push(t),this.selectBlock(t)},e.prototype.addConditionToLoop=function(e){var t=this.buildConditionBlock(e);e.loopBlock.blocks.push(t),this.selectBlock(t)},e.prototype.buildConditionBlock=function(e){var t=new c.default;t.uid=this.util.uid(),t.category=u.default.EXPRESSION,t.type=d.default.EXPRESSION,t.expression="true",t.keyCode=null,t.distance=null,t.relation=null,t.x1=null,t.y1=null,t.x2=null,t.y2=null,t.button=null;var i=new r.default;i.uid=this.util.uid(),i.condition=t,i.ifBlocks=new Array,i.elseBlocks=new Array;var o=new n.default;return o.uid=this.util.uid(),o.description="",o.blockType=s.default.CONDITION,o.conditionBlock=i,o.parentBlock=e,o},e.prototype.buildLoopBlock=function(e){var t=new h.default;t.type=p.default.REPEAT_X_TIMES,t.times=3,t.loopVariableName="",t.from=null,t.increment=null,t.to=null,t.objectSelectorDefinition=new f.default,t.objectSelectorDefinition.objectType=new l.default;var i=new a.default;i.uid=this.util.uid(),i.loop=t,i.blocks=new Array;var o=new n.default;return o.uid=this.util.uid(),o.description="",o.blockType=s.default.LOOP,o.loopBlock=i,o.parentBlock=e,o},e.prototype.addLoopBlock=function(e){var t=this.buildLoopBlock(null);e.blocks.push(t),this.selectBlock(t)},e.prototype.deleteBlock=function(e,t){var i=e.parentBlock;if(null==i){var o=t.blocks.findIndex((function(t){return t.uid==e.uid}));t.blocks.splice(o,1)}else{var n=new Array;i.blockType==s.default.CONDITION?n=i.conditionBlock.ifBlocks:i.blockType==s.default.LOOP&&(n=i.loopBlock.blocks);o=n.findIndex((function(t){return t.uid==e.uid}));n.splice(o,1)}},e}();t.default=y},function(e,t,i){"use strict";t.__esModule=!0;var o=i(0),n=function(){function e(){}return e.prototype.duplicate=function(){var t=new o.default,i=new e;return i.uid=t.uid(),i.description=this.description,i.action=this.action.duplicate(),i},e}();t.default=n},function(e,t,i){"use strict";t.__esModule=!0;var o=i(0),n=function(){function e(){this.mouseOver=!1}return e.prototype.duplicate=function(t){var i,n,s,r=new o.default,a=new e;return a.uid=r.uid(),a.description=this.description,a.comment=this.comment,a.blockType=this.blockType,a.actionBlock=null===(i=this.actionBlock)||void 0===i?void 0:i.duplicate(),a.conditionBlock=null===(n=this.conditionBlock)||void 0===n?void 0:n.duplicate(a),a.loopBlock=null===(s=this.loopBlock)||void 0===s?void 0:s.duplicate(a),a.parentBlock=t,a.mouseOver=!1,a},e}();t.default=n},function(e,t,i){"use strict";t.__esModule=!0;var o=i(0),n=function(){function e(){}return e.prototype.duplicate=function(t){var i=new o.default,n=new e;n.uid=i.uid(),n.description=this.description,n.condition=this.condition.duplicate();for(var s=new Array,r=0;r<this.ifBlocks.length;r++){var a=this.ifBlocks[r].duplicate(t);s.push(a)}n.ifBlocks=s;var l=new Array;for(r=0;r<this.elseBlocks.length;r++){var u=this.elseBlocks[r].duplicate(t);l.push(u)}return n.elseBlocks=l,n},e}();t.default=n},function(e,t,i){"use strict";t.__esModule=!0;var o=i(0),n=function(){function e(){}return e.prototype.duplicate=function(t){var i=new o.default,n=new e;n.uid=i.uid(),n.description=this.description,n.loop=this.loop.duplicate();for(var s=new Array,r=0;r<this.blocks.length;r++){var a=this.blocks[r].duplicate(t);s.push(a)}return n.blocks=s,n},e}();t.default=n},function(e,t,i){"use strict";t.__esModule=!0;var o=i(0),n=function(){function e(){}return e.prototype.duplicate=function(){var t,i,n,s=new o.default,r=new e;return r.uid=s.uid(),r.category=this.category,r.type=this.type,r.expression=this.expression,r.keyCode=this.keyCode,r.button=this.button,r.frames=this.frames,r.seconds=this.seconds,r.x1=this.x1,r.y1=this.y1,r.x2=this.x2,r.y2=this.y2,r.relation=this.relation,r.distance=this.distance,r.objectSelectorDefinition=null===(t=this.objectSelectorDefinition)||void 0===t?void 0:t.duplicate(),r.object1=null===(i=this.object1)||void 0===i?void 0:i.duplicate(),r.object2=null===(n=this.object2)||void 0===n?void 0:n.duplicate(),r},e}();t.default=n},function(e,t,i){"use strict";t.__esModule=!0;var o=function(){function e(){}return e.prototype.duplicate=function(){var t=new e;return t.type=this.type,t.objectSelectorDefinition=this.objectSelectorDefinition.duplicate(),t.loopVariableName=this.loopVariableName,t.from=this.from,t.to=this.to,t.increment=this.increment,t.times=this.times,t},e}();t.default=o},function(e,t,i){"use strict";t.__esModule=!0;var o=i(0),n=function(){function e(e){this.mainController=e,this.util=new o.default}return e.prototype.updateCurrentScript=function(){this.mainController.currentScript=null;var e=this.mainController.gameParamsJson.levels,t=this.util.findLevelDefinitionByUid(e,this.levelUid);null==t&&(t=e[0],this.levelUid=t.uid),null==this.scriptTrigger&&(this.scriptTrigger="onAnimationFrame"),"onAnimationFrame"==this.scriptTrigger?this.mainController.currentScript=t.scriptOnAnimationFrame:"onLevelStart"==this.scriptTrigger&&(this.mainController.currentScript=t.scriptOnLevelStart)},e}();t.default=n},function(e,t,i){(function(i){var o,n,s;n=[],void 0===(s="function"==typeof(o=function(){"use strict";function t(e,t,i){var o=new XMLHttpRequest;o.open("GET",e),o.responseType="blob",o.onload=function(){a(o.response,t,i)},o.onerror=function(){console.error("could not download file")},o.send()}function o(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(e){}return 200<=t.status&&299>=t.status}function n(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(i){var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var s="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof i&&i.global===i?i:void 0,r=s.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),a=s.saveAs||("object"!=typeof window||window!==s?function(){}:"download"in HTMLAnchorElement.prototype&&!r?function(e,i,r){var a=s.URL||s.webkitURL,l=document.createElement("a");i=i||e.name||"download",l.download=i,l.rel="noopener","string"==typeof e?(l.href=e,l.origin===location.origin?n(l):o(l.href)?t(e,i,r):n(l,l.target="_blank")):(l.href=a.createObjectURL(e),setTimeout((function(){a.revokeObjectURL(l.href)}),4e4),setTimeout((function(){n(l)}),0))}:"msSaveOrOpenBlob"in navigator?function(e,i,s){if(i=i||e.name||"download","string"!=typeof e)navigator.msSaveOrOpenBlob(function(e,t){return void 0===t?t={autoBom:!1}:"object"!=typeof t&&(console.warn("Deprecated: Expected third argument to be a object"),t={autoBom:!t}),t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\ufeff",e],{type:e.type}):e}(e,s),i);else if(o(e))t(e,i,s);else{var r=document.createElement("a");r.href=e,r.target="_blank",setTimeout((function(){n(r)}))}}:function(e,i,o,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),"string"==typeof e)return t(e,i,o);var a="application/octet-stream"===e.type,l=/constructor/i.test(s.HTMLElement)||s.safari,u=/CriOS\/[\d]+/.test(navigator.userAgent);if((u||a&&l||r)&&"undefined"!=typeof FileReader){var c=new FileReader;c.onloadend=function(){var e=c.result;e=u?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=e:location=e,n=null},c.readAsDataURL(e)}else{var d=s.URL||s.webkitURL,h=d.createObjectURL(e);n?n.location=h:location.href=h,n=null,setTimeout((function(){d.revokeObjectURL(h)}),4e4)}});s.saveAs=a.saveAs=a,e.exports=a})?o.apply(t,n):o)||(e.exports=s)}).call(this,i(16))}]);