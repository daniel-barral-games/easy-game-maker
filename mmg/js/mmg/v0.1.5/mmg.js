var EasyGameMakerLibrary=function(e){var t={};function i(o){if(t[o])return t[o].exports;var n=t[o]={i:o,l:!1,exports:{}};return e[o].call(n.exports,n,n.exports,i),n.l=!0,n.exports}return i.m=e,i.c=t,i.d=function(e,t,o){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(i.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(o,n,function(t){return e[t]}.bind(null,n));return o},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=27)}([function(module,exports,__webpack_require__){"use strict";exports.__esModule=!0;var ObjectSelectorDefinition_1=__webpack_require__(12),ObjectSelectorType_1=__webpack_require__(2),Shape_1=__webpack_require__(13),Color_1=__webpack_require__(1),RenderType_1=__webpack_require__(3),BackgroundType_1=__webpack_require__(4),EventActionType_1=__webpack_require__(5),Util=function(){function Util(){}return Util.prototype.listImageIds=function(e){for(var t=new Set,i=0;i<e.customObjectTypes.length;i++){var o=e.customObjectTypes[i];o.renderType==RenderType_1.default.IMAGE&&t.add(o.image.imageId)}for(i=0;i<e.levels.length;i++){var n=e.levels[i];n.backgroundType==BackgroundType_1.default.IMAGE&&t.add(n.backgroundImage.imageId)}for(i=0;i<e.events.length;i++)for(var s=e.events[i],a=0;a<s.actions.length;a++){var r=s.actions[a];(r.type==EventActionType_1.default.DRAW_IMAGE||r.type==EventActionType_1.default.SET_OBJECT_IMAGE)&&t.add(r.image.imageId)}return t},Util.prototype.snapToGrid=function(e,t,i){var o=(e-i)%t;return o<0&&(o+=t),o>t/2&&(o-=t),e-o},Util.prototype.getTextLeftX=function(e,t){var i=this.measureText(e,t),o=e.x-i/2;return"left"==e.align?o+=i/2:"right"==e.align&&(o-=i/2),o},Util.prototype.measureText=function(e,t){t.font=e.fontSize+"px "+e.fontFamily;var i=e.text;return t.measureText(i).width},Util.prototype.isInside=function(e,t,i,o,n,s){return!(e<i)&&(!(e>i+n)&&(!(t<o)&&!(t>o+s)))},Util.prototype.isInsideInitialObject=function(e,t,i){if(null==e.objectType)return!1;var o={x:e.x,y:e.y,halfWidth:e.objectType.width/2,halfHeight:e.objectType.height/2},n={x:t,y:i,halfWidth:1,halfHeight:1};return!!this.testCollisionRectangleRectangle(o,n)},Util.prototype.getMousePos=function(e,t,i,o){return this.getTransformedXY(e,t,i,o)},Util.prototype.getTransformedXY=function(e,t,i,o){var n=e.getBoundingClientRect();if(!(null!=window.document.fullscreenElement))return{x:t.clientX-n.left,y:t.clientY-n.top};var s=window.screen.width,a=window.screen.height,r=a/o,l=s/i,u=Math.min(l,r),c=s-i*u,d=a-o*u;return{x:(t.clientX-n.left)/u-c/2/u,y:(t.clientY-n.top)/u-d/2/u}},Util.prototype.drawText=function(e,t,i,o,n,s,a,r){e.font=n,e.fillStyle=s,e.textAlign=a,e.textBaseline=r,e.fillText(t,i,o)},Util.prototype.buildFillStyleFromColor=function(e){return"rgb("+e.red+","+e.green+","+e.blue+","+e.alpha/100+")"},Util.prototype.newColor=function(e,t,i,o){return void 0===o&&(o=100),new Color_1.default(e,t,i,o)},Util.prototype.uid=function(){return this.randomString()},Util.prototype.randomString=function(){return Math.random().toString(36).substr(2)},Util.prototype.arrayMove=function(e,t,i){var o=e[t];e.splice(t,1),e.splice(i,0,o)},Util.prototype.buildObjectSelector=function(e,t){if(null==e)return null;var i=new ObjectSelectorDefinition_1.default;return i.type=e.type,i.loopVariableName=e.loopVariableName,e.type==ObjectSelectorType_1.default.ALL_OBJECTS_OF_TYPE&&(i.objectType=this.findCustomObjectDefinitionByUid(t,e.objectType.uid)),i},Util.prototype.getLoopVariableNames=function(e){for(var t=new Array,i=e.loops,o=0;o<i.length;o++){var n=i[o];t.push(n.loopVariableName)}return t},Util.prototype.numberOrNull=function(e){return null==e?null:Number(e)},Util.prototype.zeroIfNull=function(e){return null==e?0:e},Util.prototype.oneIfNull=function(e){return null==e?1:e},Util.prototype.findEnemyTypeByEnemyTypeId=function(e,t){for(var i=null,o=0;o<e.length;o++)e[o].enemyId==t&&(i=e[o]);return i},Util.prototype.findBonusTypeByBonusTypeId=function(e,t){for(var i=null,o=0;o<e.length;o++)e[o].bonusTypeId==t&&(i=e[o]);return i},Util.prototype.findObstacleTypeByObstacleTypeId=function(e,t){for(var i=null,o=0;o<e.length;o++)e[o].obstacleTypeId==t&&(i=e[o]);return i},Util.prototype.findTypeById=function(e,t){for(var i=null,o=0;o<e.length;o++)e[o].id==t&&(i=e[o]);return i},Util.prototype.findLevelDefinitionByUid=function(e,t){for(var i=null,o=0;o<e.length;o++)e[o].uid==t&&(i=e[o]);return i},Util.prototype.findCustomObjectDefinitionByUid=function(e,t){for(var i=null,o=0;o<e.length;o++)e[o].uid==t&&(i=e[o]);return i},Util.prototype.findElementByUid=function(e,t){for(var i=null,o=0;o<e.length;o++)e[o].uid==t&&(i=e[o]);return i},Util.prototype.stopObject=function(e,t){(e.shape==Shape_1.default.CIRCLE&&t.shape==Shape_1.default.CIRCLE||e.shape==Shape_1.default.RECTANGLE&&t.shape==Shape_1.default.RECTANGLE||e.shape==Shape_1.default.CIRCLE&&t.shape==Shape_1.default.RECTANGLE||e.shape==Shape_1.default.RECTANGLE&&t.shape==Shape_1.default.CIRCLE)&&this.stopRectangleByRectangle(e,t)},Util.prototype.stopRectangleByRectangle=function(e,t){var i=this.absoluteDiff(e.x,t.x-t.halfWidth-e.halfWidth),o=this.absoluteDiff(e.x,t.x+t.halfWidth+e.halfWidth),n=this.absoluteDiff(e.y,t.y-t.halfHeight-e.halfWidth),s=this.absoluteDiff(e.y,t.y+t.halfHeight+e.halfWidth);n<s&&n<o&&n<i?(e.y-=n,e.ySpeed=0):s<o&&s<i?(e.y+=s,e.ySpeed=0):o<i?(e.x+=o,e.xSpeed=0):(e.x-=i,e.xSpeed=0)},Util.prototype.absoluteDiff=function(e,t){return Math.abs(e-t)},Util.prototype.testCollisionObjectLists=function(e,t){for(var i=0;i<e.length;i++)for(var o=0;o<t.length;o++)if(this.testCollision(e[i],t[o]))return!0;return!1},Util.prototype.testCollision=function(e,t){return e.shape==Shape_1.default.CIRCLE&&t.shape==Shape_1.default.RECTANGLE?this.testCollisionCircleRectangle(e,t):e.shape==Shape_1.default.RECTANGLE&&t.shape==Shape_1.default.CIRCLE?this.testCollisionCircleRectangle(t,e):e.shape==Shape_1.default.CIRCLE&&t.shape==Shape_1.default.CIRCLE?this.testCollisionBallBonus(e,t):e.shape==Shape_1.default.RECTANGLE&&t.shape==Shape_1.default.RECTANGLE&&this.testCollisionRectangleRectangle(e,t)},Util.prototype.testCollisionCircleRectangle=function(e,t){return e.y+e.radius>t.y-t.halfHeight&&e.y-e.radius<t.y+t.halfHeight&&e.x+e.radius>t.x-t.halfWidth&&e.x-e.radius<t.x+t.halfWidth},Util.prototype.testCollisionRectangleRectangle=function(e,t){return e.y+e.halfHeight>t.y-t.halfHeight&&e.y-e.halfHeight<t.y+t.halfHeight&&e.x+e.halfWidth>t.x-t.halfWidth&&e.x-e.halfWidth<t.x+t.halfWidth},Util.prototype.testCollisionBallBonus=function(e,t){var i=e.x,o=t.x,n=e.y,s=t.y;return Math.sqrt((o-i)*(o-i)+(s-n)*(s-n))<e.radius+t.radius},Util.prototype.distanceObjects=function(e,t){return this.distance(e.x,e.y,t.x,t.y)},Util.prototype.distance=function(e,t,i,o){return Math.sqrt((i-e)*(i-e)+(o-t)*(o-t))},Util.prototype.randomBetween=function(e,t){return e+Math.random()*(t-e)},Util.prototype.randomIntegerBetween=function(e,t){return Math.floor(Math.random()*t)+e},Util.prototype.readTextFile=function(e){var t=new XMLHttpRequest;t.open("GET",e,!1),t.onreadystatechange=function(){if(4===t.readyState&&(200===t.status||0==t.status)){var e=t.responseText;alert(e)}},t.send(null)},Util.prototype.isInsideObject=function(e,t,i){return null!=e&&(null!=t&&(!(e<i.x-i.halfWidth)&&(!(e>i.x+i.halfWidth)&&(!(t<i.y-i.halfHeight)&&!(t>i.y+i.halfHeight)))))},Util.prototype.getCookie=function(e){for(var t=e+"=",i=decodeURIComponent(document.cookie).split(";"),o=0;o<i.length;o++){for(var n=i[o];" "==n.charAt(0);)n=n.substring(1);if(0==n.indexOf(t))return n.substring(t.length,n.length)}return""},Util.prototype.getObjectsByType=function(e,t){for(var i=new Array,o=0;o<t.level.customObjectArray.length;o++)t.level.customObjectArray[o].type.uid==e&&i.push(t.level.customObjectArray[o]);return i},Util.prototype.checkButtonClick=function(e,t){return!!(t.mouseDownList.length>0&&this.checkMouseOverButton(e,t))},Util.prototype.checkMouseOverButton=function(e,t){if(null!=t.mousePos)for(var i=0;i<t.level.buttonArray.length;i++){var o=t.level.buttonArray[i];if(o.uid==e)return o.isInsideButton(t.mousePos.x,t.mousePos.y)}return!1},Util.prototype.checkButtonTouch=function(e,t){return t.touchStartList.length>0&&this.checkPositionOverButton(e,t,t.lastTouchX,t.lastTouchY)},Util.prototype.checkPositionOverButton=function(e,t,i,o){for(var n=0;n<t.level.buttonArray.length;n++){var s=t.level.buttonArray[n];if(s.uid==e)return s.isInsideButton(i,o)}return!1},Util.prototype.requestCanvasFullscreen=function(){var e=document.getElementById("myCanvas"),t=e;e.requestFullscreen?e.requestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullscreen?t.webkitRequestFullscreen():t.msRequestFullscreen&&t.msRequestFullscreen()},Util.prototype.decycle=function(e,t){var i=new WeakMap;return function e(o,n){var s,a;return void 0!==t&&(o=t(o)),"object"!=typeof o||null===o||o instanceof Boolean||o instanceof Date||o instanceof Number||o instanceof RegExp||o instanceof String?o:void 0!==(s=i.get(o))?{$ref:s}:(i.set(o,n),Array.isArray(o)?(a=[],o.forEach((function(t,i){a[i]=e(t,n+"["+i+"]")}))):(a={},Object.keys(o).forEach((function(t){a[t]=e(o[t],n+"["+JSON.stringify(t)+"]")}))),a)}(e,"$")},Util.prototype.retrocycle=function($){var px=/^\$(?:\[(?:\d+|"(?:[^\\"\u0000-\u001f]|\\(?:[\\"\/bfnrt]|u[0-9a-zA-Z]{4}))*")\])*$/;return function rez(value){value&&"object"==typeof value&&(Array.isArray(value)?value.forEach((function(element,i){if("object"==typeof element&&null!==element){var path=element.$ref;"string"==typeof path&&px.test(path)?value[i]=eval(path):rez(element)}})):Object.keys(value).forEach((function(name){var item=value[name];if("object"==typeof item&&null!==item){var path=item.$ref;"string"==typeof path&&px.test(path)?value[name]=eval(path):rez(item)}})))}($),$},Util}();exports.default=Util},function(e,t,i){"use strict";t.__esModule=!0;var o=function(){function e(e,t,i,o){void 0===o&&(o=100),this.red=e,this.green=t,this.blue=i,this.alpha=o}return e.BLACK=new e(0,0,0,100),e.WHITE=new e(255,255,255,100),e.RED=new e(255,0,0,100),e.GREEN=new e(0,255,0,100),e.BLUE=new e(0,0,255,100),e}();t.default=o},function(e,t,i){"use strict";var o;t.__esModule=!0,function(e){e.ALL_OBJECTS="ALL_OBJECTS",e.ALL_OBJECTS_OF_TYPE="ALL_OBJECTS_OF_TYPE",e.LOOP_OBJECT="LOOP_OBJECT"}(o||(o={})),t.default=o},function(e,t,i){"use strict";var o;t.__esModule=!0,function(e){e.IMAGE="IMAGE",e.CIRCLE="CIRCLE",e.RECTANGLE="RECTANGLE"}(o||(o={})),t.default=o},function(e,t,i){"use strict";var o;t.__esModule=!0,function(e){e.SOLID_COLOR="SOLID_COLOR",e.IMAGE="IMAGE"}(o||(o={})),t.default=o},function(e,t,i){"use strict";var o;t.__esModule=!0,function(e){e.GO_TO_NEXT_LEVEL="GO_TO_NEXT_LEVEL",e.GO_TO_PREVIOUS_LEVEL="GO_TO_PREVIOUS_LEVEL",e.GO_TO_LEVEL="GO_TO_LEVEL",e.GAME_OVER="GAME_OVER",e.CREATE_CUSTOM_OBJECT="CREATE_CUSTOM_OBJECT",e.CONSOLE_LOG="CONSOLE_LOG",e.SET_CAMERA_CENTER_X="SET_CAMERA_CENTER_X",e.SET_CAMERA_CENTER_Y="SET_CAMERA_CENTER_Y",e.REQUEST_FULLSCREEN="REQUEST_FULLSCREEN",e.DRAW_LINE="DRAW_LINE",e.DRAW_RECT="DRAW_RECT",e.DRAW_CIRCLE="DRAW_CIRCLE",e.DRAW_TEXT="DRAW_TEXT",e.DRAW_IMAGE="DRAW_IMAGE",e.DRAW_PERCENTAGE_BAR="DRAW_PERCENTAGE_BAR",e.SET_CANVAS_ANGLE="SET_CANVAS_ANGLE",e.SET_CUSTOM_OBJECT_SPEED_AND_ANGLE="SET_CUSTOM_OBJECT_SPEED_AND_ANGLE",e.SET_OBJECT_SPEED_AND_TARGET="SET_OBJECT_SPEED_AND_TARGET",e.APPLY_FORCE_TO_OBJECT="APPLY_FORCE_TO_OBJECT",e.SET_BUTTON_ATTRIBUTE="SET_BUTTON_ATTRIBUTE",e.SHOOT_OBJECT="SHOOT_OBJECT",e.MULTIPLY_ZOOM="MULTIPLY_ZOOM",e.SET_ZOOM="SET_ZOOM",e.SET_LOCAL_STORAGE_VARIABLE="SET_LOCAL_STORAGE_VARIABLE",e.REMOVE_OBJECT="REMOVE_OBJECT",e.ADD_TO_SCORE="ADD_TO_SCORE",e.SET_SCORE="SET_SCORE",e.SET_CUSTOM_OBJECT_ATTRIBUTE="SET_CUSTOM_OBJECT_ATTRIBUTE",e.ADD_TO_CUSTOM_OBJECT_ATTRIBUTE="ADD_TO_CUSTOM_OBJECT_ATTRIBUTE",e.SET_OBJECT_VARIABLE="SET_OBJECT_VARIABLE",e.SET_OBJECT_IMAGE_ANGLE="SET_OBJECT_IMAGE_ANGLE",e.SET_OBJECT_IMAGE="SET_OBJECT_IMAGE",e.SET_LEVEL_VARIABLE="SET_LEVEL_VARIABLE",e.ADD_TO_LEVEL_VARIABLE="ADD_TO_LEVEL_VARIABLE",e.SET_GLOBAL_VARIABLE="SET_GLOBAL_VARIABLE",e.ADD_TO_GLOBAL_VARIABLE="ADD_TO_GLOBAL_VARIABLE"}(o||(o={})),t.default=o},function(e,t,i){"use strict";var o;t.__esModule=!0,function(e){e.COLLISION="COLLISION",e.KEYDOWN="KEYDOWN",e.KEYUP="KEYUP",e.EXPRESSION="EXPRESSION",e.ALWAYS="ALWAYS",e.ON_LEVEL_START="ON_LEVEL_START",e.ON_BUTTON_CLICK="ON_BUTTON_CLICK",e.EVERY_X_FRAMES="EVERY_X_FRAMES",e.EVERY_X_SECONDS="EVERY_X_SECONDS",e.DISTANCE_BETWEEN="DISTANCE_BETWEEN",e.MOUSEDOWN="MOUSEDOWN",e.MOUSEUP="MOUSEUP",e.REPEAT_WHILE_MOUSE_IS_DOWN="REPEAT_WHILE_MOUSE_IS_DOWN",e.REPEAT_WHILE_KEY_IS_DOWN="REPEAT_WHILE_KEY_IS_DOWN",e.MOUSE_OVER_OBJECT="MOUSE_OVER_OBJECT",e.MOUSE_OVER_BUTTON="MOUSE_OVER_BUTTON",e.CLICK_ON_OBJECT="CLICK_ON_OBJECT",e.TOUCH_ON_BUTTON="TOUCH_ON_BUTTON",e.TOUCH_ON_OBJECT="TOUCH_ON_OBJECT",e.ON_TOUCH_START="ON_TOUCH_START",e.ON_TOUCH_MOVE="ON_TOUCH_MOVE",e.ON_TOUCH_END="ON_TOUCH_END"}(o||(o={})),t.default=o},function(e,t,i){"use strict";t.__esModule=!0;var o=i(0),n=i(13),s=function(){function e(e,t,i,s){this.imageAngle=0,this.shape=n.default.RECTANGLE,this.variables=new Map,this.markedToRemove=!1,this.isOnPlatform=!1,this.play=i.play,this.level=i,this.type=s,this.x=e,this.y=t,this.halfWidth=s.width/2,this.halfHeight=s.height/2,this.image=s.image,this.speedX=0,this.speedY=0,this.electricCharge=s.electricCharge,this.mass=s.mass,this.alpha=s.alpha;var a=s.objectVariables;if(null!=a)for(var r=0;r<a.length;r++){var l=a[r];this.variables.set(l.name,l.initialValue)}this.util=new o.default}return e.prototype.update=function(){if(this.x+=this.speedX,this.y+=this.speedY,null!=this.type.applyGravity&&1==this.type.applyGravity&&(this.speedY+=this.level.levelDefinition.gravity),null!=this.type.behaviours)for(var e=0;e<this.type.behaviours.length;e++){var t=this.type.behaviours[e];if("KEYBOARD_MOVEMENT"==t.type){var i=0;this.play.isKeyDown("ArrowRight")&&(i+=1),this.play.isKeyDown("ArrowLeft")&&(i-=1);var o=0;this.play.isKeyDown("ArrowUp")&&(o-=1),this.play.isKeyDown("ArrowDown")&&(o+=1),"SET_SPEED_ON_KEY_DOWN"==t.keyboardMovementType?(this.speedX=i*t.speedX,this.speedY=o*t.speedY):"SET_ACCELERATION_ON_KEY_DOWN"==t.keyboardMovementType?(this.speedX+=i*t.accelerationX,this.speedY+=o*t.accelerationY):t.keyboardMovementType}else if("MOUSE_MOVEMENT"==t.type){if(null!=this.play.mousePos){var n=this.play.mousePos.x-this.x,s=this.play.mousePos.y-this.y;n+=this.play.screenX,s+=this.play.screenY,"SET_SPEED_BY_MOUSE_DISTANCE"==t.mouseMovementType?(this.speedX=t.factorX*n,this.speedY=t.factorY*s):"SET_ACCELERATION_BY_MOUSE_DISTANCE"==t.mouseMovementType?(this.speedX+=t.factorX*n,this.speedY+=t.factorY*s):"SET_POSITION_BY_MOUSE_POSITION"==t.mouseMovementType&&(this.x=t.factorX*this.play.mousePos.x,this.y=t.factorY*this.play.mousePos.y)}}else if("STOP_ON_OBJECT"==t.type||"BOUNCE_ON_OBJECT"==t.type){for(var a=new Array,r=0;r<this.play.level.customObjectArray.length;r++)this.play.level.customObjectArray[r].type.id==t.objectSelector&&a.push(this.play.level.customObjectArray[r]);for(var l=0;l<a.length;l++){var u=a[l];if(this.util.testCollision(this,u)){var c=null,d=null;d=this.speedY>=0?u.y-u.halfHeight-this.halfHeight:u.y+u.halfHeight+this.halfHeight,c=this.speedX>=0?u.x-u.halfWidth-this.halfWidth:u.x+u.halfWidth+this.halfWidth,Math.abs(c-this.x)<Math.abs(d-this.y)?(this.x=c,"STOP_ON_OBJECT"==t.type?this.speedX=0:"BOUNCE_ON_OBJECT"==t.type&&(this.speedX>0?this.speedX=-t.bounceSpeed:this.speedX=t.bounceSpeed)):(this.y=d,"STOP_ON_OBJECT"==t.type?this.speedY=0:"BOUNCE_ON_OBJECT"==t.type&&(this.speedY>0?this.speedY=-t.bounceSpeed:this.speedY=t.bounceSpeed))}}}else if("JUMP_ON_PLATFORM"==t.type){a=new Array;for(var h=0;h<this.play.level.customObjectArray.length;h++)this.play.level.customObjectArray[h].type.id==t.objectSelector&&a.push(this.play.level.customObjectArray[h]);for(var p=0;p<a.length;p++){u=a[p];if(this.util.testCollision(this,u)){c=null,d=null;d=this.speedY>=0?u.y-u.halfHeight-this.halfHeight:u.y+u.halfHeight+this.halfHeight,c=this.speedX>=0?u.x-u.halfWidth-this.halfWidth:u.x+u.halfWidth+this.halfWidth,Math.abs(c-this.x)<Math.abs(d-this.y)?(this.x=c,this.speedX=0):(this.y=d,this.speedY>=0&&(this.isOnPlatform=!0),1==this.isOnPlatform&&this.play.isKeyDown(t.jumpKey)?this.speedY=-t.jumpSpeed:this.speedY=0)}}}}},e.prototype.getVariable=function(e){var t=this.variables.get(e);return null==t?(this.variables.set(e,0),0):t},e.prototype.setVariable=function(e,t){this.variables.set(e,t)},e.prototype.addToVariable=function(e,t){var i=this.variables.get(e);null==i?this.variables.set(e,t):this.variables.set(e,i+t)},e.prototype.drawShape=function(e){e.fillStyle="#000000",e.beginPath(),e.rect(this.x-this.play.screenX-this.halfWidth,this.y-this.play.screenY-this.halfHeight,2*this.halfWidth,2*this.halfHeight),e.closePath(),e.fill()},e}();t.default=s},function(e,t,i){"use strict";var o;t.__esModule=!0,function(e){e.STRING="STRING",e.NUMBER="NUMBER",e.BOOLEAN="BOOLEAN",e.ARRAY="ARRAY",e.MATRIX="MATRIX"}(o||(o={})),t.default=o},function(e,t,i){"use strict";var o;t.__esModule=!0,function(e){e.OBJECT="OBJECT",e.NUMBER="NUMBER"}(o||(o={})),t.default=o},function(e,t,i){"use strict";var o;t.__esModule=!0,function(e){e.EQUAL="EQUAL",e.GREATER="GREATER",e.SMALLER="SMALLER",e.GREATER_OR_EQUAL="GREATER_OR_EQUAL",e.SMALLER_OR_EQUAL="SMALLER_OR_EQUAL",e.DIFFERENT="DIFFERENT"}(o||(o={})),t.default=o},function(e,t,i){"use strict";t.__esModule=!0;var o=i(30),n=i(2),s=i(5),a=i(6),r=i(9),l=i(10),u=function(){function e(){this.expressionEvaluatorDynamic=new o.default}return e.prototype.generateProcessEventsSourceCode=function(e){for(var t=this,i="",o=new Map,n=e.events,s=0;s<n.length;s++){var a=n[s].levelDefinition.uid,r=o.get(a);null==r&&(r=""),r+=this.generateEventSourceCode(n[s],e,s+1,1),o.set(a,r)}return o.forEach((function(e,o){var n="//Level "+o;i+=t.addLine(n,0);var s='if (play.level.levelDefinition.uid == "'+o+'") {';i+=t.addLine(s,0),i+=t.addLine("",0),i+=""+e;i+=t.addLine("}",0),i+=t.addLine("",0)})),i},e.prototype.generateEventSourceCode=function(e,t,i,o){var n="",s="{ //Event "+i;n+=this.addLine(s,o),o++;var a=e.actions,r=e.loops,l=e.conditions;if(null!=r&&r.length>0)for(var u=0;u<r.length;u++)n+=this.generateLoopSourceCode(r[u],o),o++;for(var c=0;c<l.length;c++)n+=this.generateConditionSourceCode(l[c],e,t,o),o++;for(var d=0;d<a.length;d++)n+=this.generateActionSourceCode(a[d],e,t,o);for(c=0;c<l.length;c++)o--,n+=this.generateTabs(o),n+="}",n+="\n";if(null!=r&&r.length>0)for(u=0;u<r.length;u++)o--,n+=this.addLine("}",o);return o--,n+=this.addLine("}",o),n+="\n"},e.prototype.generateTabs=function(e){for(var t="",i=0;i<e;i++)t+="\t";return t},e.prototype.generateConditionSourceCode=function(e,t,i,o){var n="";if(e.type==a.default.ON_LEVEL_START){var s="if (play.level.currentFrame == 0) {";n+=this.addLine(s,o)}else if(e.type==a.default.ALWAYS){s="{ //ALWAYS";n+=this.addLine(s,o)}else if(e.type==a.default.KEYDOWN){s='if (play.onKeyDown("'+e.keyCode+'")) {';n+=this.addLine(s,o)}else if(e.type==a.default.REPEAT_WHILE_KEY_IS_DOWN){s='if (play.isKeyDown("'+e.keyCode+'")) {';n+=this.addLine(s,o)}else if(e.type==a.default.MOUSEDOWN){s="if (play.mouseDownList.length > 0) {";n+=this.addLine(s,o)}else if(e.type==a.default.MOUSEUP){s="if (play.mouseUpList.length > 0) {";n+=this.addLine(s,o)}else if(e.type==a.default.REPEAT_WHILE_MOUSE_IS_DOWN){s="if (play.isLeftMouseButtonDown) {";n+=this.addLine(s,o)}else if(e.type==a.default.EXPRESSION){s="if ("+this.expressionEvaluatorDynamic.evaluateExpression(e.expression,i,t,!1)+") {";n+=this.addLine(s,o)}else if(e.type==a.default.DISTANCE_BETWEEN){var r=this.expressionEvaluatorDynamic.evaluateExpression(e.x1,i,t,!1),u=this.expressionEvaluatorDynamic.evaluateExpression(e.y1,i,t,!1),c=this.expressionEvaluatorDynamic.evaluateExpression(e.x2,i,t,!1),d=this.expressionEvaluatorDynamic.evaluateExpression(e.y2,i,t,!1),h=this.expressionEvaluatorDynamic.evaluateExpression(e.distance,i,t,!1),p=null;e.relation==l.default.EQUAL?p="==":e.relation==l.default.GREATER?p=">":e.relation==l.default.SMALLER?p="<":e.relation==l.default.GREATER_OR_EQUAL?p=">=":e.relation==l.default.SMALLER_OR_EQUAL?p="<=":e.relation==l.default.DIFFERENT&&(p="!=");s="let distance = play.util.distance("+r+","+u+","+c+","+d+");";var E="if (distance "+p+" "+h+") {";n+=this.addLine(s,o),n+=this.addLine(E,o)}else if(e.type==a.default.EVERY_X_SECONDS){s='if (play.checkEveryXSeconds("'+e.uid+'", '+e.seconds+")) {";n+=this.addLine(s,o)}else if(e.type==a.default.EVERY_X_FRAMES){s='if (play.checkEveryXFrames("'+e.uid+'", '+e.frames+")) {";n+=this.addLine(s,o)}else if(e.type==a.default.ON_BUTTON_CLICK){s='if (play.util.checkButtonClick("'+e.button.uid+'", play)) {';n+=this.addLine(s,o)}else if(e.type==a.default.COLLISION){n+=this.generateObjectSelectorSourceCode(e.object1,"objectList1",o),n+=this.generateObjectSelectorSourceCode(e.object2,"objectList2",o);s="if (play.util.testCollisionObjectLists(objectList1, objectList2)) {";n+=this.addLine(s,o)}else if(e.type==a.default.KEYUP){s='if (play.onKeyUp("'+e.keyCode+'")) {';n+=this.addLine(s,o)}else if(e.type==a.default.MOUSE_OVER_BUTTON){s='if (play.util.checkMouseOverButton("'+e.button.uid+'", play)) {';n+=this.addLine(s,o)}else if(e.type==a.default.MOUSE_OVER_OBJECT){s="let isMouseOverObject = false;";n+=this.addLine(s,o);E="if (play.mousePos != null && play.util.isInsideObject(play.mousePos.x, play.mousePos.y, customObject)) isMouseOverObject = true;";n+=this.generateObjectLoopSourceCodeWithBody(e.objectSelectorDefinition,"customObject",o,[E]);var f="if (isMouseOverObject) {";n+=this.addLine(f,o)}else if(e.type==a.default.CLICK_ON_OBJECT){s="let isClickingOnObject = false;";n+=this.addLine(s,o);var v="let isMouseDown = play.mouseDownList.length > 0;";n+=this.addLine(v,o);var m="if (isMouseDown && play.mousePos != null) {";n+=this.addLine(m,o),o++;E="if (play.util.isInsideObject(play.mousePos.x, play.mousePos.y, customObject)) isClickingOnObject = true;";n+=this.generateObjectLoopSourceCodeWithBody(e.objectSelectorDefinition,"customObject",o,[E]),o--,n+=this.addLine("}",o);f="if (isClickingOnObject) {";n+=this.addLine(f,o)}else if(e.type==a.default.ON_TOUCH_START){s="if (play.touchStartList.length > 0) {";n+=this.addLine(s,o)}else if(e.type==a.default.ON_TOUCH_MOVE){s="if (play.touchMoveList.length > 0) {";n+=this.addLine(s,o)}else if(e.type==a.default.ON_TOUCH_END){s="if (play.touchEndList.length > 0) {";n+=this.addLine(s,o)}else if(e.type==a.default.TOUCH_ON_BUTTON){s='if (play.util.checkButtonTouch("'+e.button.uid+'", play)) {';n+=this.addLine(s,o)}else if(e.type==a.default.TOUCH_ON_OBJECT){s="let isClickingOnObject = false;";n+=this.addLine(s,o);v="let hasTouchStart = play.touchStartList.length > 0;";n+=this.addLine(v,o);m="if (hasTouchStart) {";n+=this.addLine(m,o),o++;E="if (play.util.isInsideObject(play.lastTouchX, play.lastTouchY, customObject)) isClickingOnObject = true;";n+=this.generateObjectLoopSourceCodeWithBody(e.objectSelectorDefinition,"customObject",o,[E]),o--,n+=this.addLine("}",o);f="if (isClickingOnObject) {";n+=this.addLine(f,o)}return n},e.prototype.generateLoopSourceCode=function(e,t){var i="",o=e.loopVariableName;if(e.type==r.default.OBJECT){if(e.objectSelectorDefinition.type==n.default.ALL_OBJECTS){var s="let objectList_"+o+" = play.level.customObjectArray;";i+=this.addLine(s,t)}else if(e.objectSelectorDefinition.type==n.default.ALL_OBJECTS_OF_TYPE){s="let objectList_"+o+' = play.util.getObjectsByType("'+e.objectSelectorDefinition.objectType.uid+'",play);';i+=this.addLine(s,t)}var a="for (let i_"+o+"=0; i_"+o+"<objectList_"+o+".length;i_"+o+"++) {";i+=this.addLine(a,t);var l="let loopObject_"+o+" = objectList_"+o+"[i_"+o+"];";i+=this.addLine(l,t+1)}else if(e.type==r.default.NUMBER){var u=e.from,c=e.to;s="for (let loopObject_"+o+"="+u+"; loopObject_"+o+(c>u?"<=":">=")+c+";loopObject_"+o+"+="+e.increment+") {";i+=this.addLine(s,t)}return i},e.prototype.generateActionSourceCode=function(e,t,i,o){var n=this.addLine("{ //event action",o);if(o++,e.type==s.default.GO_TO_NEXT_LEVEL){var a="play.goToNextLevel();";n+=this.addLine(a,o)}else if(e.type==s.default.GO_TO_PREVIOUS_LEVEL){a="play.goToPreviousLevel();";n+=this.addLine(a,o)}else if(e.type==s.default.GO_TO_LEVEL){a='play.goToLevelUid("'+e.levelDefinition.uid+'");';n+=this.addLine(a,o)}else if(e.type==s.default.ADD_TO_SCORE){a="play.score += "+(C=this.expressionEvaluatorDynamic.evaluateExpression(e.value,i,t,!1))+";";n+=this.addLine(a,o)}else if(e.type==s.default.SET_SCORE){a="play.score = "+(C=this.expressionEvaluatorDynamic.evaluateExpression(e.value,i,t,!1))+";";n+=this.addLine(a,o)}else if(e.type==s.default.DRAW_TEXT){var r=this.expressionEvaluatorDynamic.evaluateExpression(e.x,i,t,!1),l=this.expressionEvaluatorDynamic.evaluateExpression(e.y,i,t,!1),u=this.expressionEvaluatorDynamic.evaluateExpression(e.text,i,t,!0),c=e.fontFamily,d=this.expressionEvaluatorDynamic.evaluateExpression(e.fontSize,i,t,!1),h=e.textAlign;n+=this.generateColorSourceCode(e.color,"color",i,t,o);a='play.customElementsToDraw.push({"type":"TEXT", "x":'+r+', "y":'+l+', "text":'+u+', "fontSize":'+d+', "fontFamily":"'+c+'", "color":color, "textAlign":"'+h+'"});';n+=this.addLine(a,o)}else if(e.type==s.default.DRAW_LINE){var p=this.expressionEvaluatorDynamic.evaluateExpression(e.x1,i,t,!1),E=this.expressionEvaluatorDynamic.evaluateExpression(e.y1,i,t,!1),f=this.expressionEvaluatorDynamic.evaluateExpression(e.x2,i,t,!1),v=this.expressionEvaluatorDynamic.evaluateExpression(e.y2,i,t,!1),m=this.expressionEvaluatorDynamic.evaluateExpression(e.lineWidth,i,t,!1);n+=this.generateColorSourceCode(e.color,"color",i,t,o);a='play.customElementsToDraw.push({"type":"LINE","x1":'+p+', "y1":'+E+', "x2":'+f+', "y2":'+v+', "lineWidth":'+m+', "color":color});';n+=this.addLine(a,o)}else if(e.type==s.default.DRAW_RECT){r=this.expressionEvaluatorDynamic.evaluateExpression(e.x,i,t,!1),l=this.expressionEvaluatorDynamic.evaluateExpression(e.y,i,t,!1);var y=this.expressionEvaluatorDynamic.evaluateExpression(e.width,i,t,!1),g=this.expressionEvaluatorDynamic.evaluateExpression(e.height,i,t,!1),b="null";null!=e.borderSize&&(b=this.expressionEvaluatorDynamic.evaluateExpression(e.borderSize,i,t,!1)),n+=this.generateColorSourceCode(e.color,"color",i,t,o),n+=this.generateColorSourceCode(e.borderColor,"borderColor",i,t,o);a='play.customElementsToDraw.push({"type":"RECT","x":'+r+', "y":'+l+', "width":'+y+', "height":'+g+', "borderSize":'+b+', "color":color, "borderColor":borderColor, "drawType":"'+e.drawType+'"});';n+=this.addLine(a,o)}else if(e.type==s.default.DRAW_CIRCLE){r=this.expressionEvaluatorDynamic.evaluateExpression(e.x,i,t,!1),l=this.expressionEvaluatorDynamic.evaluateExpression(e.y,i,t,!1);var O=this.expressionEvaluatorDynamic.evaluateExpression(e.radius,i,t,!1);b="null";null!=e.borderSize&&(b=this.expressionEvaluatorDynamic.evaluateExpression(e.borderSize,i,t,!1)),n+=this.generateColorSourceCode(e.color,"color",i,t,o),n+=this.generateColorSourceCode(e.borderColor,"borderColor",i,t,o);a='play.customElementsToDraw.push({"type":"CIRCLE","x":'+r+', "y":'+l+', "radius":'+O+', "borderSize":'+b+', "color":color, "borderColor":borderColor, "drawType":"'+e.drawType+'"});';n+=this.addLine(a,o)}else if(e.type==s.default.DRAW_IMAGE){a='play.customElementsToDraw.push({"type":"IMAGE", "x":'+(r=this.expressionEvaluatorDynamic.evaluateExpression(e.x,i,t,!1))+', "y":'+(l=this.expressionEvaluatorDynamic.evaluateExpression(e.y,i,t,!1))+', "width":'+(y=this.expressionEvaluatorDynamic.evaluateExpression(e.width,i,t,!1))+', "height":'+(g=this.expressionEvaluatorDynamic.evaluateExpression(e.height,i,t,!1))+', "alpha":'+(T=this.expressionEvaluatorDynamic.evaluateExpression(e.alpha,i,t,!1))+', "rotation":'+this.expressionEvaluatorDynamic.evaluateExpression(e.rotation,i,t,!1)+', "imageId":"'+e.image.imageId+'"});';n+=this.addLine(a,o)}else if(e.type==s.default.DRAW_PERCENTAGE_BAR){r=this.expressionEvaluatorDynamic.evaluateExpression(e.x,i,t,!1),l=this.expressionEvaluatorDynamic.evaluateExpression(e.y,i,t,!1),y=this.expressionEvaluatorDynamic.evaluateExpression(e.width,i,t,!1),g=this.expressionEvaluatorDynamic.evaluateExpression(e.height,i,t,!1);var T=this.expressionEvaluatorDynamic.evaluateExpression(e.alpha,i,t,!1),C=this.expressionEvaluatorDynamic.evaluateExpression(e.value,i,t,!1),_=this.expressionEvaluatorDynamic.evaluateExpression(e.maxValue,i,t,!1);n+=this.generateColorSourceCode(e.color,"color",i,t,o),n+=this.generateColorSourceCode(e.backgroundColor,"backgroundColor",i,t,o),n+=this.generateColorSourceCode(e.borderColor,"borderColor",i,t,o);var A='play.customElementsToDraw.push({"type":"PERCENTAGE_BAR", "x":'+r+', "y":'+l+', "width":'+y+', "height":'+g+', "alpha":'+T+', "value":'+C+', "maxValue":'+_+', "split":'+e.split+', "borderSize":"'+e.borderSize+'", "color":color, "backgroundColor":backgroundColor, "borderColor":borderColor});';n+=this.addLine(A,o)}else if(e.type==s.default.CREATE_CUSTOM_OBJECT){r=this.expressionEvaluatorDynamic.evaluateExpression(e.x,i,t,!1),l=this.expressionEvaluatorDynamic.evaluateExpression(e.y,i,t,!1);var L="let objectType = play.objectTypesMap.get('"+e.customObjectType.uid+"');";n+=this.addLine(L,o);a="let customObject = play.level.addCustomObject(objectType, "+r+", "+l+");";if(n+=this.addLine(a,o),null!=e.speedX&&""!=e.speedX){var w="customObject.speedX = "+this.expressionEvaluatorDynamic.evaluateExpression(e.speedX,i,t,!1)+";";n+=this.addLine(w,o)}if(null!=e.speedY&&""!=e.speedY){w="customObject.speedY = "+this.expressionEvaluatorDynamic.evaluateExpression(e.speedY,i,t,!1)+";";n+=this.addLine(w,o)}}else if(e.type==s.default.GAME_OVER){a="play.gameOver = true;";n+=this.addLine(a,o)}else if(e.type==s.default.CONSOLE_LOG){a="console.log("+(C=this.expressionEvaluatorDynamic.evaluateExpression(e.expression,i,t,!0))+");";n+=this.addLine(a,o)}else if(e.type==s.default.SET_CAMERA_CENTER_X){a="play.setCameraCenterX("+(r=this.expressionEvaluatorDynamic.evaluateExpression(e.value,i,t,!1))+");";n+=this.addLine(a,o)}else if(e.type==s.default.SET_CAMERA_CENTER_Y){a="play.setCameraCenterY("+(l=this.expressionEvaluatorDynamic.evaluateExpression(e.value,i,t,!1))+");";n+=this.addLine(a,o)}else if(e.type==s.default.SET_GLOBAL_VARIABLE){C=this.expressionEvaluatorDynamic.evaluateExpression(e.value,i,t,!1),a='play.setGlobalVariable("'+e.variable+'", '+C+");";n+=this.addLine(a,o)}else if(e.type==s.default.ADD_TO_GLOBAL_VARIABLE){C=this.expressionEvaluatorDynamic.evaluateExpression(e.value,i,t,!1),a='play.addToGlobalVariable("'+e.variable+'", '+C+");";n+=this.addLine(a,o)}else if(e.type==s.default.SET_LEVEL_VARIABLE){C=this.expressionEvaluatorDynamic.evaluateExpression(e.value,i,t,!1),a='play.level.setVariable("'+e.variable+'", '+C+");";n+=this.addLine(a,o)}else if(e.type==s.default.ADD_TO_LEVEL_VARIABLE){C=this.expressionEvaluatorDynamic.evaluateExpression(e.value,i,t,!1),a='play.level.addToVariable("'+e.variable+'", '+C+");";n+=this.addLine(a,o)}else if(e.type==s.default.SET_ZOOM){a="play.setZoom("+(C=this.expressionEvaluatorDynamic.evaluateExpression(e.value,i,t,!1))+");";n+=this.addLine(a,o)}else if(e.type==s.default.MULTIPLY_ZOOM){a="play.muliplyZoom("+(C=this.expressionEvaluatorDynamic.evaluateExpression(e.value,i,t,!1))+");";n+=this.addLine(a,o)}else if(e.type==s.default.SET_LOCAL_STORAGE_VARIABLE){a="localStorage.setItem("+this.expressionEvaluatorDynamic.evaluateExpression(e.variable,i,t,!0)+","+(C=this.expressionEvaluatorDynamic.evaluateExpression(e.value,i,t,!1))+");";n+=this.addLine(a,o)}else if(e.type==s.default.SET_CANVAS_ANGLE){a="play.level.canvasAngle="+(Y=this.expressionEvaluatorDynamic.evaluateExpression(e.angle,i,t,!1))+";";n+=this.addLine(a,o)}else if(e.type==s.default.SET_CUSTOM_OBJECT_ATTRIBUTE){C=this.expressionEvaluatorDynamic.evaluateExpression(e.value,i,t,!1),a="";"x"==e.attribute?a+="customObject.x = "+C+";":"y"==e.attribute?a+="customObject.y = "+C+";":"speedX"==e.attribute?a+="customObject.speedX = "+C+";":"speedY"==e.attribute?a+="customObject.speedY = "+C+";":"width"==e.attribute?a+="customObject.halfWidth = ("+C+")/2;":"height"==e.attribute?a+="customObject.halfHeight = ("+C+")/2;":"alpha"==e.attribute&&(a+="customObject.alpha = "+C+";"),n+=this.generateObjectLoopSourceCodeWithBody(e.objectSelectorDefinition,"customObject",o,[a])}else if(e.type==s.default.ADD_TO_CUSTOM_OBJECT_ATTRIBUTE){C=this.expressionEvaluatorDynamic.evaluateExpression(e.value,i,t,!1),a="";"x"==e.attribute?a+="customObject.x += "+C+";":"y"==e.attribute?a+="customObject.y += "+C+";":"speedX"==e.attribute?a+="customObject.speedX += "+C+";":"speedY"==e.attribute?a+="customObject.speedY += "+C+";":"width"==e.attribute?a+="customObject.halfWidth += ("+C+")/2;":"height"==e.attribute?a+="customObject.halfHeight += ("+C+")/2;":"alpha"==e.attribute&&(a+="customObject.alpha += "+C+";"),n+=this.generateObjectLoopSourceCodeWithBody(e.objectSelectorDefinition,"customObject",o,[a])}else if(e.type==s.default.REMOVE_OBJECT){a="customObject.markedToRemove = true;";n+=this.generateObjectLoopSourceCodeWithBody(e.objectSelectorDefinition,"customObject",o,[a])}else if(e.type==s.default.SET_OBJECT_VARIABLE){C=this.expressionEvaluatorDynamic.evaluateExpression(e.value,i,t,!1),a='customObject.setVariable("'+e.variable+'", '+C+");";n+=this.generateObjectLoopSourceCodeWithBody(e.objectSelectorDefinition,"customObject",o,[a])}else if(e.type==s.default.SET_CUSTOM_OBJECT_SPEED_AND_ANGLE){a="customObject.speedX = Math.cos("+(Y=this.expressionEvaluatorDynamic.evaluateExpression(e.angle,i,t,!1))+") * "+(x=this.expressionEvaluatorDynamic.evaluateExpression(e.speed,i,t,!1))+";",w="customObject.speedY = -Math.sin("+Y+") * "+x+";";n+=this.generateObjectLoopSourceCodeWithBody(e.objectSelectorDefinition,"customObject",o,[a,w])}else if(e.type==s.default.SET_OBJECT_SPEED_AND_TARGET){var x=this.expressionEvaluatorDynamic.evaluateExpression(e.speed,i,t,!1),S=[a="let dx = "+this.expressionEvaluatorDynamic.evaluateExpression(e.targetX,i,t,!1)+" - customObject.x;",w="let dy = "+this.expressionEvaluatorDynamic.evaluateExpression(e.targetY,i,t,!1)+" - customObject.y;",R="let d = play.util.distance(0,0,dx,dy);",A="customObject.speedX = "+x+" * dx / d;",B="customObject.speedY = "+x+" * dy / d;"];n+=this.generateObjectLoopSourceCodeWithBody(e.objectSelectorDefinition,"customObject",o,S)}else if(e.type==s.default.APPLY_FORCE_TO_OBJECT){var j=this.expressionEvaluatorDynamic.evaluateExpression(e.force,i,t,!1);if("ANGLE"==e.targetType){a="customObject.speedX += Math.cos("+(Y=this.expressionEvaluatorDynamic.evaluateExpression(e.angle,i,t,!1))+") * "+j+";",w="customObject.speedY += -Math.sin("+Y+") * "+j+";";n+=this.generateObjectLoopSourceCodeWithBody(e.objectSelectorDefinition,"customObject",o,[a,w])}else if("COORDINATES"==e.targetType){S=[a="let dx = "+this.expressionEvaluatorDynamic.evaluateExpression(e.targetX,i,t,!1)+" - customObject.x;",w="let dy = "+this.expressionEvaluatorDynamic.evaluateExpression(e.targetY,i,t,!1)+" - customObject.y;",R="let d = play.util.distance(0,0,dx,dy);",A="if (d > 0) {",B="\tcustomObject.speedX += "+j+" * dx / d;",D="\tcustomObject.speedY += "+j+" * dy / d;","}"];n+=this.generateObjectLoopSourceCodeWithBody(e.objectSelectorDefinition,"customObject",o,S)}}else if(e.type==s.default.SET_OBJECT_IMAGE){a="customObject.image = play.buildImageObject('"+e.image.imageSourceType+"', '"+e.image.imageId+"');";n+=this.generateObjectLoopSourceCodeWithBody(e.objectSelectorDefinition,"customObject",o,[a])}else if(e.type==s.default.SET_OBJECT_IMAGE_ANGLE){a="customObject.imageAngle = "+(Y=this.expressionEvaluatorDynamic.evaluateExpression(e.angle,i,t,!1))+";";n+=this.generateObjectLoopSourceCodeWithBody(e.objectSelectorDefinition,"customObject",o,[a])}else if(e.type==s.default.SET_BUTTON_ATTRIBUTE){if("borderSize"==e.attribute||"width"==e.attribute||"height"==e.attribute||"x"==e.attribute||"y"==e.attribute){C=this.expressionEvaluatorDynamic.evaluateExpression(e.value,i,t,!1),a="for (let i=0; i<play.level.buttonArray.length; i++) {",w="\tlet button = play.level.buttonArray[i];";var R='\tif (button.uid == "'+e.button.uid+'") {',B=(A="\t\tbutton."+e.attribute+" = "+C+";","\t}"),D="}";n+=this.addLine(a,o),n+=this.addLine(w,o),n+=this.addLine(R,o),n+=this.addLine(A,o),n+=this.addLine(B,o),n+=this.addLine(D,o)}else if("backgroundColor"==e.attribute||"borderColor"==e.attribute||"textColor"==e.attribute){n+=this.generateColorSourceCode(e.color,"color",i,t,o);a="for (let i=0; i<play.level.buttonArray.length; i++) {",w="\tlet button = play.level.buttonArray[i];",R='\tif (button.uid == "'+e.button.uid+'") {',A="\t\tbutton."+e.attribute+" = color;",B="\t}",D="}";n+=this.addLine(a,o),n+=this.addLine(w,o),n+=this.addLine(R,o),n+=this.addLine(A,o),n+=this.addLine(B,o),n+=this.addLine(D,o)}}else if(e.type==s.default.SHOOT_OBJECT){a="let sourceList = new Array();";n+=this.addLine(a,o);var I=e.customObjectType.uid;if("COORDINATES"==e.sourceType){w='sourceList.push({"customObjectTypeUid":"'+I+'", "x":'+this.expressionEvaluatorDynamic.evaluateExpression(e.sourceX,i,t,!1)+', "y":'+this.expressionEvaluatorDynamic.evaluateExpression(e.sourceY,i,t,!1)+"});";n+=this.addLine(w,o)}else if("MOUSE_POSITION"==e.sourceType){w="if (play.mousePos != null) {",R='\t\tsourceList.push({ "customObjectTypeUid":"'+I+'", "x":play.mousePos.x + play.screenX, "y":play.mousePos.y + play.screenY });',A="}";n+=this.addLine(w,o),n+=this.addLine(R,o),n+=this.addLine(A,o)}else if("OBJECT"==e.sourceType){w='sourceList.push({"customObjectTypeUid":"'+I+'", "x":customObject.x, "y":customObject.y });';n+=this.generateObjectLoopSourceCodeWithBody(e.sourceObjectSelectorDefinition,"customObject",o,[w])}n+=this.addLine("for (let i_source=0; i_source<sourceList.length; i_source++) {",o),o++;if(n+=this.addLine("let source = sourceList[i_source];",o),"SPEED_X_Y"==e.targetType){var N="let shotObject = play.level.addCustomObject(play.objectTypesMap.get(source.customObjectTypeUid), source.x, source.y);",M="shotObject.speedX = "+this.expressionEvaluatorDynamic.evaluateExpression(e.speedX,i,t,!1)+";",P="shotObject.speedY = "+this.expressionEvaluatorDynamic.evaluateExpression(e.speedY,i,t,!1)+";";n+=this.addLine(N,o),n+=this.addLine(M,o),n+=this.addLine(P,o)}else if("COORDINATES"==e.targetType){N="let dx = "+this.expressionEvaluatorDynamic.evaluateExpression(e.targetX,i,t,!1)+" - source.x;",M="let dy = "+this.expressionEvaluatorDynamic.evaluateExpression(e.targetY,i,t,!1)+" - source.y;",P="let d = play.util.distance(0,0,dx,dy);";var V="let shotObject = play.level.addCustomObject(play.objectTypesMap.get(source.customObjectTypeUid), source.x, source.y);",U="shotObject.speedX = "+(x=this.expressionEvaluatorDynamic.evaluateExpression(e.speed,i,t,!1))+" * dx / d;",F="shotObject.speedY = "+x+" * dy / d;";n+=this.addLine(N,o),n+=this.addLine(M,o),n+=this.addLine(P,o),n+=this.addLine(V,o),n+=this.addLine(U,o),n+=this.addLine(F,o)}else if("ANGLE"==e.targetType){var Y;N="let shotObject = play.level.addCustomObject(play.objectTypesMap.get(source.customObjectTypeUid), source.x, source.y);",M="shotObject.speedX = Math.cos("+(Y=this.expressionEvaluatorDynamic.evaluateExpression(e.angle,i,t,!1))+") * "+(x=this.expressionEvaluatorDynamic.evaluateExpression(e.speed,i,t,!1))+";",P="shotObject.speedY = -Math.sin("+Y+") * "+x+";";n+=this.addLine(N,o),n+=this.addLine(M,o),n+=this.addLine(P,o)}else if("MOUSE_POSITION"==e.targetType){N="if (play.mousePos != null) {",M="\tlet targetX = play.mousePos.x;",P="\tlet targetY = play.mousePos.y;",V="\tlet dx = targetX + play.screenX - source.x;",U="\tlet dy = targetY + play.screenY - source.y;",F="\tlet d = play.util.distance(0,0,dx,dy);";var J="\tshotObject.speedX = "+(x=this.expressionEvaluatorDynamic.evaluateExpression(e.speed,i,t,!1))+" * dx / d;",G="\tshotObject.speedY = "+x+" * dy / d;";n+=this.addLine(N,o),n+=this.addLine(M,o),n+=this.addLine(P,o),n+=this.addLine(V,o),n+=this.addLine(U,o),n+=this.addLine(F,o),n+=this.addLine("\tlet shotObject = play.level.addCustomObject(play.objectTypesMap.get(source.customObjectTypeUid), source.x, source.y);",o),n+=this.addLine(J,o),n+=this.addLine(G,o),n+=this.addLine("}",o)}else if("OBJECT"==e.targetType){S=["let dx = targetObject.x - source.x;",w="let dy = targetObject.y - source.y;",R="let d = play.util.distance(0,0,dx,dy);",A="let shotObject = play.level.addCustomObject(play.objectTypesMap.get(source.customObjectTypeUid), source.x, source.y);",B="shotObject.speedX = "+(x=this.expressionEvaluatorDynamic.evaluateExpression(e.speed,i,t,!1))+" * dx / d;",D="shotObject.speedY = "+x+" * dy / d;"];n+=this.generateObjectLoopSourceCodeWithBody(e.targetObjectSelectorDefinition,"targetObject",o,S)}o--,n+=this.addLine("}",o)}else if(e.type==s.default.REQUEST_FULLSCREEN){a="play.util.requestCanvasFullscreen();";n+=this.addLine(a,o)}return o--,n+=this.addLine("}",o)},e.prototype.generateColorSourceCode=function(e,t,i,o,n){if(null==e||""==e.red||""==e.green||""==e.blue){var s="let "+t+" = null;";return this.addLine(s,n)}var a="let "+t+" = play.util.newColor("+this.expressionEvaluatorDynamic.evaluateExpression(""+e.red,i,o,!1)+", "+this.expressionEvaluatorDynamic.evaluateExpression(""+e.green,i,o,!1)+", "+this.expressionEvaluatorDynamic.evaluateExpression(""+e.blue,i,o,!1)+");";return this.addLine(a,n)},e.prototype.generateObjectLoopSourceCodeWithBody=function(e,t,i,o){var s="",a=e.type!=n.default.LOOP_OBJECT;if(a)s+=this.generateObjectLoopSourceCode(e,t,i),i++;else{var r="let "+t+" = loopObject_"+e.loopVariableName+";";s+=this.addLine(r,i)}for(var l=0;l<o.length;l++)s+=this.addLine(o[l],i);return a&&(i--,s+=this.addLine("}",i)),s},e.prototype.generateObjectLoopSourceCode=function(e,t,i){var o=this.generateObjectSelectorSourceCode(e,"objectList",i);o+=this.addLine("for (var i=0; i<objectList.length; i++) {",i),i++;var n="let "+t+" = objectList[i];";return o+=this.addLine(n,i)},e.prototype.generateObjectSelectorSourceCode=function(e,t,i){var o="";if(e.type==n.default.ALL_OBJECTS_OF_TYPE){var s="let "+t+' = play.util.getObjectsByType("'+e.objectType.uid+'", play);';o+=this.addLine(s,i)}else if(e.type==n.default.ALL_OBJECTS){s="let "+t+" = play.level.customObjectArray;";o+=this.addLine(s,i)}else if(e.type==n.default.LOOP_OBJECT){s="let "+t+" = [loopObject_"+e.loopVariableName+"];";o+=this.addLine(s,i)}return o},e.prototype.addLine=function(e,t){var i=this.generateTabs(t);return i+=e,i+="\n"},e}();t.default=u},function(e,t,i){"use strict";t.__esModule=!0;var o=function(){};t.default=o},function(e,t,i){"use strict";var o;t.__esModule=!0,function(e){e.CIRCLE="CIRCLE",e.RECTANGLE="RECTANGLE"}(o||(o={})),t.default=o},function(e,t,i){"use strict";t.__esModule=!0;var o=function(){this.templateVersion="v0.1.5"};t.default=o},function(module,exports,__webpack_require__){"use strict";exports.__esModule=!0;var CustomObject_1=__webpack_require__(7),Util_1=__webpack_require__(0),VariableType_1=__webpack_require__(8),ExpressionEvaluator=function(){function ExpressionEvaluator(){this.util=new Util_1.default,this.regexpFps=new RegExp("{fps}","g"),this.regexpScore=new RegExp("{score}","g"),this.regexpRandom=new RegExp("{random}","g"),this.regexpMousePosX=new RegExp("{mousePosX}","g"),this.regexpMousePosY=new RegExp("{mousePosY}","g"),this.regexpScreenX=new RegExp("{screenX}","g"),this.regexpScreenY=new RegExp("{screenY}","g"),this.regexpLoopCurrentIndex=new RegExp("{loop.currentIndex}","g"),this.regexpLevelName=new RegExp("{levelDefinition.name}","g"),this.regexpCurrentLevelFrame=new RegExp("{level.currentFrame}","g"),this.regexLocalStorageVariable=new RegExp("{localStorage.\\w+}"),this.regexDistanceLoopObjects=new RegExp("{distanceLoopObjects\\(\\w+,\\w+\\)}"),this.regexMap=new Map}return ExpressionEvaluator.prototype.findRegexByString=function(e){var t=this.regexMap.get(e);return null==t&&(t=new RegExp(e,"g"),this.regexMap.set(e,t)),t},ExpressionEvaluator.prototype.initObjectVariablesRegexp=function(e){},ExpressionEvaluator.prototype.evaluateExpression=function(expression,play,loopState){if(expression=this.replaceVariables(expression,play,loopState),-1!=expression.indexOf("{"))throw new Error("Invalid expression: "+expression);var result=eval(expression);return result},ExpressionEvaluator.prototype.replaceVariables=function(e,t,i){var o=this;e=(e=(e=e.replace(this.regexpScore,""+t.score)).replace(this.regexpRandom,""+Math.random())).replace(this.regexpFps,""+Math.round(100*t.level.fps)/100);var n=t.level.variables;null!=n&&n.forEach((function(t,i){e=e.replace(o.findRegexByString("{levelVariable."+i+"}"),""+t)}));var s=t.globalVariables;return null!=s&&s.forEach((function(t,i){e=e.replace(o.findRegexByString("{globalVariable."+i+"}"),""+t)})),null!=i&&i.variables.forEach((function(t,i){t instanceof CustomObject_1.default?(e=(e=(e=(e=(e=(e=(e=e.replace(o.findRegexByString("{loopObject.variable."+i+".x}"),""+t.x)).replace(o.findRegexByString("{loopObject.variable."+i+".y}"),""+t.y)).replace(o.findRegexByString("{loopObject.variable."+i+".speedX}"),""+t.speedX)).replace(o.findRegexByString("{loopObject.variable."+i+".speedY}"),""+t.speedY)).replace(o.findRegexByString("{loopObject.variable."+i+".width}"),""+2*t.halfWidth)).replace(o.findRegexByString("{loopObject.variable."+i+".height}"),""+2*t.halfHeight)).replace(o.findRegexByString("{loopObject.variable."+i+".alpha}"),""+t.alpha),t.variables.forEach((function(t,n){e=e.replace(o.findRegexByString("{loopObject.variable."+i+".variable."+n+"}"),""+t)}))):"number"==typeof t&&(e=e.replace(o.findRegexByString("{loopObject.variable."+i+"}"),""+t))})),e=(e=(e=(e=(e=t.mousePos?(e=e.replace(this.regexpMousePosX,""+t.mousePos.x)).replace(this.regexpMousePosY,""+t.mousePos.y):(e=e.replace(this.regexpMousePosX,"0")).replace(this.regexpMousePosY,"0")).replace(this.regexpScreenX,""+t.screenX)).replace(this.regexpScreenY,""+t.screenY)).replace(this.regexpLevelName,""+t.level.levelDefinition.name)).replace(this.regexpCurrentLevelFrame,""+t.level.currentFrame),e=this.replaceLevelArrayVariables(e,t,i),e=this.replaceLocalStorageVariables(e,t,i),e=this.replaceDistanceLoopObjects(e,t,i)},ExpressionEvaluator.prototype.replaceLevelArrayVariables=function(e,t,i){for(var o=t.level.levelDefinition.levelVariables,n=0;n<o.length;n++)if(o[n].type==VariableType_1.default.ARRAY){var s=o[n].name;e=this.replaceLevelArrayVariable(e,t,i,s)}return e},ExpressionEvaluator.prototype.replaceLevelArrayVariable=function(e,t,i,o){for(var n=t.level.variables.get(o),s=new RegExp("{levelVariable."+o+"\\[\\d+\\]}"),a=s.exec(e);a;){var r=new RegExp("\\d+").exec(a[0]),l=parseInt(r[0]);e=e.replace(s,n[l]),a=s.exec(e)}return e},ExpressionEvaluator.prototype.replaceLocalStorageVariables=function(e,t,i){for(var o=this.regexLocalStorageVariable.exec(e);o;){var n=o[0].substring(14,o[0].length-1);e=e.replace(this.regexLocalStorageVariable,localStorage.getItem(n)),o=this.regexLocalStorageVariable.exec(e)}return e},ExpressionEvaluator.prototype.replaceDistanceLoopObjects=function(e,t,i){for(var o=this.regexDistanceLoopObjects.exec(e);o;){var n=o[0].substring(21,o[0].length-2).split(","),s=n[0],a=n[1],r=i.variables.get(s),l=i.variables.get(a),u=0;r instanceof CustomObject_1.default&&l instanceof CustomObject_1.default&&(u=this.util.distanceObjects(r,l)),e=e.replace(this.regexDistanceLoopObjects,"("+u+")"),o=this.regexDistanceLoopObjects.exec(e)}return e},ExpressionEvaluator}();exports.default=ExpressionEvaluator},function(e,t,i){"use strict";var o;t.__esModule=!0,function(e){e.FILL="FILL",e.STROKE="STROKE",e.FILL_AND_STROKE="FILL_AND_STROKE"}(o||(o={})),t.default=o},function(e,t,i){"use strict";t.__esModule=!0;var o=function(){function e(){}return e.prototype.drawRoundRect=function(e,t,i,o,n,s,a,r){if(void 0===r&&(r=!0),void 0===s&&(s=5),"number"==typeof s)s={tl:s,tr:s,br:s,bl:s};else{var l={tl:0,tr:0,br:0,bl:0};for(var u in l)s[u]=s[u]||l[u]}e.beginPath(),e.moveTo(t+s.tl,i),e.lineTo(t+o-s.tr,i),e.quadraticCurveTo(t+o,i,t+o,i+s.tr),e.lineTo(t+o,i+n-s.br),e.quadraticCurveTo(t+o,i+n,t+o-s.br,i+n),e.lineTo(t+s.bl,i+n),e.quadraticCurveTo(t,i+n,t,i+n-s.bl),e.lineTo(t,i+s.tl),e.quadraticCurveTo(t,i,t+s.tl,i),e.closePath(),a&&e.fill(),r&&e.stroke()},e}();t.default=o},function(e,t,i){"use strict";t.__esModule=!0;var o=function(){function e(e,t){this.lastEvaluationFrame=0,this.lastResetFrame=0,this.lastEvaluationResult=!1,this.resetEveryXFrames=e,this.lastResetFrame=t,this.lastEvaluationFrame=t}return e.prototype.updateCounter=function(){},e.prototype.evaluateCondition=function(e){return e==this.lastEvaluationFrame?this.lastEvaluationResult:e-this.lastEvaluationFrame>1?(this.lastResetFrame=e,this.lastEvaluationFrame=e,this.lastEvaluationResult=!1,!1):e-this.lastResetFrame>=this.resetEveryXFrames?(this.lastResetFrame=e,this.lastEvaluationFrame=e,this.lastEvaluationResult=!0,!0):(this.lastEvaluationFrame=e,this.lastEvaluationResult=!1,!1)},e}();t.default=o},function(e,t,i){"use strict";t.__esModule=!0;var o=function(){function e(e,t,i){this.lastEvaluationFrame=0,this.lastEvaluationResult=!1,this.resetEveryXSeconds=e,this.lastResetTime=i,this.lastEvaluationFrame=t}return e.prototype.updateCounter=function(){},e.prototype.evaluateCondition=function(e,t){return e==this.lastEvaluationFrame?this.lastEvaluationResult:e-this.lastEvaluationFrame>1?(this.lastResetTime=t,this.lastEvaluationFrame=e,this.lastEvaluationResult=!1,!1):t-this.lastResetTime>=1e3*this.resetEveryXSeconds?(this.lastResetTime=t,this.lastEvaluationFrame=e,this.lastEvaluationResult=!0,!0):(this.lastEvaluationFrame=e,this.lastEvaluationResult=!1,!1)},e}();t.default=o},function(e,t,i){"use strict";t.__esModule=!0;var o=function(){};t.default=o},function(e,t,i){"use strict";var o;t.__esModule=!0,function(e){e.LIBRARY="LIBRARY",e.UPLOAD="UPLOAD"}(o||(o={})),t.default=o},function(e,t,i){"use strict";var o;t.__esModule=!0,function(e){e.ALL="ALL",e.OBJECT="OBJECT",e.LEVEL="LEVEL",e.GAME="GAME",e.STORAGE="STORAGE",e.BUTTON="BUTTON",e.DRAWING="DRAWING",e.OTHERS="OTHERS"}(o||(o={})),t.default=o},function(e,t,i){"use strict";var o;t.__esModule=!0,function(e){e.SCORE="SCORE",e.RANDOM="RANDOM",e.MOUSE_POS_X="MOUSE_POS_X",e.MOUSE_POS_Y="MOUSE_POS_Y",e.SCREEN_X="SCREEN_X",e.SCREEN_Y="SCREEN_Y",e.CURRENT_LOOP_INDEX="CURRENT_LOOP_INDEX",e.GLOBAL_VARIABLE="GLOBAL_VARIABLE",e.LEVEL_VARIABLE="LEVEL_VARIABLE",e.ARRAY_LEVEL_VARIABLE="ARRAY_LEVEL_VARIABLE",e.LOOP_OBJECT_ATTRIBUTE="LOOP_OBJECT_ATTRIBUTE",e.LOOP_OBJECT_VARIABLE="LOOP_OBJECT_VARIABLE",e.LOOP_NUMBER="LOOP_NUMBER",e.LEVEL_NAME="LEVEL_NAME",e.CURRENT_LEVEL_FRAME="CURRENT_LEVEL_FRAME",e.DISTANCE_BETWEEN_LOOP_OBJECTS="DISTANCE_BETWEEN_LOOP_OBJECTS",e.LOCAL_STORAGE_VARIABLE="LOCAL_STORAGE_VARIABLE",e.FPS="FPS",e.LAST_TOUCH_X="LAST_TOUCH_X",e.LAST_TOUCH_Y="LAST_TOUCH_Y",e.ACCELEROMETER_X="ACCELEROMETER_X",e.ACCELEROMETER_Y="ACCELEROMETER_Y",e.ACCELEROMETER_Z="ACCELEROMETER_Z"}(o||(o={})),t.default=o},function(e,t,i){"use strict";t.__esModule=!0;var o=function(){};t.default=o},function(e,t,i){"use strict";t.__esModule=!0;var o=function(){};t.default=o},function(e,t,i){"use strict";t.__esModule=!0;var o=function(){};t.default=o},function(e,t,i){"use strict";t.__esModule=!0,t.ActionTemplateController=void 0;var o=i(28),n=i(1),s=i(37),a=i(14),r=i(38),l=i(11),u=i(0),c=i(39),d=i(12),h=i(40),p=i(41),E=i(42),f=i(43),v=i(44),m=i(45),y=i(46),g=i(24),b=i(25),O=i(47),T=i(2),C=i(22),_=i(5),A=i(6),L=i(23),w=i(9),x=i(10),S=i(3),j=i(8),R=i(4),B=i(26),D=i(48),I=i(52),N=i(21),M=i(20),P=function(){function e(e){this.keyup=null,this.keydown=null,this.environment=new a.default,this.util=new u.default,this.genericService=new r.default,this.gameDefinition=null,this.actionTemplate=null,this.sourceCode=null,this.canvas=document.getElementById("myCanvas"),this.ctx=this.canvas.getContext("2d"),this.levelPreviewViewModel=null,this.loading=!1,this.message=null,this.errorMessage=null,this.currentTab="LEVELS",this.currentTab2="",this.currentScreen="LEVELS",this.returnScreen="",this.resourcesBaseUrl=null,this.isPlayingGame=!1,this.showObjectSelectorHelp=!1,this.showExpressionHelp=!1,this.hiscores=new Array,this.game=null,this.gameParamsJson=null,this.gameParamsJsonDecycled=null,this.newGameParamsJson=null,this.gameId=null,this.gameName="",this.gameDescription="",this.gameThumbnail="",this.oldCustomObjectType=null,this.newCustomObjectType=null,this.currentCustomObjectTypeIndex=null,this.currentExpressionField=null,this.expressionType=null,this.expressionToInsert=null,this.expressionObjectAttribute=null,this.expressionLoopVariableName=null,this.expressionLoopVariableName2=null,this.expressionGlobalVariableName=null,this.expressionLevelVariableName=null,this.expressionLoopObjectVariables=new Array,this.expressionLoopObjectVariable=null,this.expressionLocalStorageVariableName=null,this.currentEventIndex=null,this.oldLevel=null,this.newLevel=null,this.currentLevelIndex=null,this.editingPlayer=null,this.editingPlayerLevelIndex=null,this.newEventCondition=null,this.oldEventCondition=null,this.newEventAction=null,this.oldEventAction=null,this.newCustomText=null,this.oldCustomText=null,this.newCustomObject=null,this.oldCustomObject=null,this.newLoop=null,this.oldLoop=null,this.newAttributeToShow=null,this.oldAttributeToShow=null,this.newLevelVariable=null,this.oldLevelVariable=null,this.newLevelText=null,this.oldLevelText=null,this.newCustomObjectTypeBehaviour=null,this.oldCustomObjectTypeBehaviour=null,this.oldButton=null,this.newButton=null,this.oldEvent=null,this.newEvent=null,this.oldObjectVariable=null,this.newObjectVariable=null,this.oldGlobalVariable=null,this.newGlobalVariable=null,this.oldCustomImage=null,this.newCustomImage=null,this.loopVariableNames1=new Array,this.loopVariableNames2=new Array,this.buttons=new Array,this.loopObjectSelectorTypes=[{value:T.default.ALL_OBJECTS,name:"All objects"},{value:T.default.ALL_OBJECTS_OF_TYPE,name:"All objects of type..."}],this.conditionObjectSelectorTypes=[{value:T.default.ALL_OBJECTS,name:"Any object"},{value:T.default.ALL_OBJECTS_OF_TYPE,name:"Any object of type..."},{value:T.default.LOOP_OBJECT,name:"Loop object..."}],this.actionObjectSelectorTypes=[{value:T.default.ALL_OBJECTS,name:"All objects"},{value:T.default.ALL_OBJECTS_OF_TYPE,name:"All objects of type..."},{value:T.default.LOOP_OBJECT,name:"Loop object..."}],this.keys=this.genericService.getKeyboardKeys(),this.backgroundTypes=[{code:R.default.IMAGE,name:"Image"},{code:R.default.SOLID_COLOR,name:"Solid color"}],this.renderTypes=this.genericService.getRenderTypes(),this.drawTypes=this.genericService.getDrawTypes(),this.eventActionCategory=C.default.ALL,this.eventActionCategories=this.genericService.getEventActionCategories(),this.eventActionTypes=this.genericService.getEventActionTypes(),this.eventConditionTypes=this.genericService.getEventConditionTypes(),this.loopTypes=this.genericService.getLoopTypes(),this.expressionTypes=this.genericService.getExpressionTypes(),this.relations=[{code:x.default.EQUAL},{code:x.default.GREATER},{code:x.default.SMALLER},{code:x.default.GREATER_OR_EQUAL},{code:x.default.SMALLER_OR_EQUAL},{code:x.default.DIFFERENT}],this.sourceTypes=[{code:"COORDINATES"},{code:"MOUSE_POSITION"},{code:"OBJECT"}],this.targetTypes=[{code:"COORDINATES"},{code:"MOUSE_POSITION"},{code:"SPEED_X_Y"},{code:"ANGLE"},{code:"OBJECT"}],this.forceTargetTypes=[{code:"COORDINATES"},{code:"ANGLE"}],this.customObjectAttributes=[{code:"x"},{code:"y"},{code:"speedX"},{code:"speedY"},{code:"width"},{code:"height"},{code:"alpha"}],this.buttonAttributes=[{code:"x"},{code:"y"},{code:"width"},{code:"height"},{code:"borderSize"},{code:"backgroundColor"},{code:"borderColor"},{code:"textColor"}],this.customObjectTypeBehaviourTypes=[{code:"KEYBOARD_MOVEMENT"},{code:"MOUSE_MOVEMENT"},{code:"STOP_ON_OBJECT"},{code:"BOUNCE_ON_OBJECT"},{code:"JUMP_ON_PLATFORM"}],this.keyboardMovementTypes=[{code:"SET_SPEED_ON_KEY_DOWN"},{code:"SET_ACCELERATION_ON_KEY_DOWN"},{code:"ADD_POSITION_ON_KEY_DOWN"}],this.mouseMovementTypes=[{code:"SET_POSITION_BY_MOUSE_POSITION"},{code:"SET_SPEED_BY_MOUSE_DISTANCE"},{code:"SET_ACCELERATION_BY_MOUSE_DISTANCE"}],this.textAlignOptions=[{code:"center"},{code:"left"},{code:"right"}],this.drawTypeOptions=[{code:"FILL"},{code:"STROKE"},{code:"FILL_AND_STROKE"}],this.fontFamilyOptions=[{code:"serif"},{code:"sans-serif"},{code:"cursive"},{code:"fantasy"},{code:"monospace"},{code:"times"},{code:"courier"},{code:"arial"},{code:"Times New Roman"},{code:"Helvetica"},{code:"Arial Black"},{code:"Comic Sans MS"},{code:"Courier New"},{code:"Courier"},{code:"Lucida Console"},{code:"Verdana"}];var t=this;this.resourcesBaseUrl=e,this.levelPreviewViewModel=new D.default(this,e),this.refreshSession();var i=function(){null!=t.actionTemplate&&t.actionTemplate.loop(),t.levelPreviewViewModel.drawPreview(),window.requestAnimationFrame(i)};this.canvas.addEventListener("mousemove",(function(e){if(null!=t.actionTemplate){var i=function(e,t){return n(e,t)}(t.canvas,e);t.actionTemplate.setMousePos(i)}}),!1),this.canvas.addEventListener("click",(function(e){null!=t.actionTemplate&&t.actionTemplate.click()}),!1),this.canvas.addEventListener("mousedown",(function(e){null!=t.actionTemplate&&t.isPlayingGame&&(t.actionTemplate.mousedown(),e.preventDefault())}),!1),this.canvas.addEventListener("mouseup",(function(e){null!=t.actionTemplate&&t.isPlayingGame&&(t.actionTemplate.mouseup(),e.preventDefault())}),!1);function o(e){for(var i=e.changedTouches,o=0;o<i.length;o++){var s=i[o],a=n(t.canvas,s);t.actionTemplate.play.lastTouchX=a.x,t.actionTemplate.play.lastTouchY=a.y}}function n(e,i){var o=e.getBoundingClientRect();if(!(null!=window.document.fullscreenElement))return{x:i.clientX-o.left,y:i.clientY-o.top};var n=window.screen.width,s=window.screen.height,a=s/t.gameDefinition.canvasHeight,r=n/t.gameDefinition.canvasWidth,l=Math.min(r,a),u=n-t.gameDefinition.canvasWidth*l,c=s-t.gameDefinition.canvasHeight*l;return{x:(i.clientX-o.left)/l-u/2/l,y:(i.clientY-o.top)/l-c/2/l}}window.requestAnimationFrame(i),this.keydown=function(e){null!=t.actionTemplate&&t.isPlayingGame&&(e.preventDefault(),t.actionTemplate.keydown(e))},this.keyup=function(e){null!=t.actionTemplate&&t.isPlayingGame&&(e.preventDefault(),t.actionTemplate.keyup(e))},document.addEventListener("keydown",this.keydown,!1),document.addEventListener("keyup",this.keyup,!1),window.addEventListener("devicemotion",(function(e){var i=e.accelerationIncludingGravity.x,o=e.accelerationIncludingGravity.y,n=e.accelerationIncludingGravity.z;t.actionTemplate.updateAccelerometer(i,o,n)}),!0),this.canvas.addEventListener("touchmove",(function(e){null!=t.actionTemplate&&t.isPlayingGame&&(e.preventDefault(),t.actionTemplate.play.touchMoveList.push(e),o(e))}),!1),this.canvas.addEventListener("touchstart",(function(e){null!=t.actionTemplate&&t.isPlayingGame&&(e.preventDefault(),t.actionTemplate.play.touchStartList.push(e),o(e))}),!1),this.canvas.addEventListener("touchend",(function(e){null!=t.actionTemplate&&t.isPlayingGame&&(e.preventDefault(),t.actionTemplate.play.touchEndList.push(e),o(e))}),!1),null==this.gameId&&this.startNewGame()}return e.prototype.openImageSelection=function(e){this.setCurrentScreen("IMAGE_SELECTION"),this.returnScreen=e},e.prototype.selectCustomImage=function(e){var t=new M.default;t.imageSourceType=N.default.UPLOAD,t.imageId="custom:"+e,t.customImage=this.util.findElementByUid(this.gameParamsJson.customImages,e),"CUSTOM_OBJECT_TYPE_PROPERTIES"==this.returnScreen?this.newCustomObjectType.image=t:"PROPERTIES"==this.returnScreen?this.newLevel.backgroundImage=t:"EDIT_EVENT_ACTION"==this.returnScreen&&(this.newEventAction.image=t),this.closeImageSelection()},e.prototype.selectImage=function(e){var t=new M.default;t.imageSourceType=N.default.LIBRARY,t.imageId=e,"CUSTOM_OBJECT_TYPE_PROPERTIES"==this.returnScreen?this.newCustomObjectType.image=t:"PROPERTIES"==this.returnScreen?this.newLevel.backgroundImage=t:"EDIT_EVENT_ACTION"==this.returnScreen&&(this.newEventAction.image=t),this.closeImageSelection()},e.prototype.closeImageSelection=function(){this.setCurrentScreen(this.returnScreen)},e.prototype.openObjectTypeSelection=function(e){this.setCurrentScreen("OBJECT_TYPE_SELECTION"),this.returnScreen=e},e.prototype.selectObjectType=function(e){"EDIT_CUSTOM_OBJECT"==this.returnScreen&&(this.newCustomObject.objectType=this.util.findElementByUid(this.gameParamsJson.customObjectTypes,e)),this.closeImageSelection()},e.prototype.closeObjectTypeSelection=function(){this.setCurrentScreen(this.returnScreen)},e.prototype.filterEventActionTypes=function(){this.eventActionTypes=this.genericService.getEventActionTypesByCategory(this.eventActionCategory)},e.prototype.toggleObjectSelectorHelp=function(){this.showObjectSelectorHelp=!this.showObjectSelectorHelp},e.prototype.toggleExpressionHelp=function(){this.showExpressionHelp=!this.showExpressionHelp},e.prototype.openExpressionHelp=function(e){this.showExpressionHelp=!0,this.clearExpressionHelpForm(),this.currentExpressionField=e},e.prototype.closeExpressionHelp=function(){this.showExpressionHelp=!1},e.prototype.updateExpressionToInsert=function(){var e=this.expressionType,t=null;e==L.default.SCORE?t="{score}":e==L.default.RANDOM?t="{random}":e==L.default.FPS?t="{fps}":e==L.default.MOUSE_POS_X?t="{mousePosX}":e==L.default.MOUSE_POS_Y?t="{mousePosY}":e==L.default.SCREEN_X?t="{screenX}":e==L.default.SCREEN_Y?t="{screenY}":e==L.default.CURRENT_LOOP_INDEX?t="{loop.currentIndex}":e==L.default.GLOBAL_VARIABLE?t="{globalVariable."+this.expressionGlobalVariableName+"}":e==L.default.LEVEL_VARIABLE?t="{levelVariable."+this.expressionLevelVariableName+"}":e==L.default.ARRAY_LEVEL_VARIABLE?t="{levelVariable.arrayName[indexNumber]}":e==L.default.LOOP_OBJECT_ATTRIBUTE?t="{loopObject.variable."+this.expressionLoopVariableName+"."+this.expressionObjectAttribute+"}":e==L.default.LOOP_OBJECT_VARIABLE?t="{loopObject.variable."+this.expressionLoopVariableName+".variable."+this.expressionLoopObjectVariable+"}":e==L.default.LOOP_NUMBER?t="{loopObject.variable."+this.expressionLoopVariableName+"}":e==L.default.LEVEL_NAME?t="{levelDefinition.name}":e==L.default.CURRENT_LEVEL_FRAME?t="{level.currentFrame}":e==L.default.LOCAL_STORAGE_VARIABLE?t="{localStorage."+this.expressionLocalStorageVariableName+"}":e==L.default.DISTANCE_BETWEEN_LOOP_OBJECTS?t="{distanceLoopObjects("+this.expressionLoopVariableName+","+this.expressionLoopVariableName2+")}":e==L.default.ACCELEROMETER_X?t="{accelerometer.x}":e==L.default.ACCELEROMETER_Y?t="{accelerometer.y}":e==L.default.ACCELEROMETER_Z?t="{accelerometer.z}":e==L.default.LAST_TOUCH_X?t="{lastTouchX}":e==L.default.LAST_TOUCH_Y&&(t="{lastTouchY}"),this.expressionToInsert=t},e.prototype.insertExpression=function(){var e=this.expressionToInsert;"newEventCondition.expression"==this.currentExpressionField?(null==this.newEventCondition.expression&&(this.newEventCondition.expression=""),this.newEventCondition.expression+=e):"newEventCondition.x1"==this.currentExpressionField?(null==this.newEventCondition.x1&&(this.newEventCondition.x1=""),this.newEventCondition.x1+=e):"newEventCondition.x2"==this.currentExpressionField?(null==this.newEventCondition.x2&&(this.newEventCondition.x2=""),this.newEventCondition.x2+=e):"newEventCondition.y1"==this.currentExpressionField?(null==this.newEventCondition.y1&&(this.newEventCondition.y1=""),this.newEventCondition.y1+=e):"newEventCondition.y2"==this.currentExpressionField?(null==this.newEventCondition.y2&&(this.newEventCondition.y2=""),this.newEventCondition.y2+=e):"newEventCondition.distance"==this.currentExpressionField?(null==this.newEventCondition.distance&&(this.newEventCondition.distance=""),this.newEventCondition.distance+=e):"newEventAction.x"==this.currentExpressionField?(null==this.newEventAction.x&&(this.newEventAction.x=""),this.newEventAction.x+=e):"newEventAction.y"==this.currentExpressionField?(null==this.newEventAction.y&&(this.newEventAction.y=""),this.newEventAction.y+=e):"newEventAction.speedX"==this.currentExpressionField?(null==this.newEventAction.speedX&&(this.newEventAction.speedX=""),this.newEventAction.speedX+=e):"newEventAction.speedY"==this.currentExpressionField?(null==this.newEventAction.speedY&&(this.newEventAction.speedY=""),this.newEventAction.speedY+=e):"newEventAction.value"==this.currentExpressionField?(null==this.newEventAction.value&&(this.newEventAction.value=""),this.newEventAction.value+=e):"newEventAction.speed"==this.currentExpressionField?(null==this.newEventAction.speed&&(this.newEventAction.speed=""),this.newEventAction.speed+=e):"newEventAction.angle"==this.currentExpressionField?(null==this.newEventAction.angle&&(this.newEventAction.angle=""),this.newEventAction.angle+=e):"newEventAction.force"==this.currentExpressionField?(null==this.newEventAction.force&&(this.newEventAction.force=""),this.newEventAction.force+=e):"newEventAction.sourceX"==this.currentExpressionField?(null==this.newEventAction.sourceX&&(this.newEventAction.sourceX=""),this.newEventAction.sourceX+=e):"newEventAction.sourceY"==this.currentExpressionField?(null==this.newEventAction.sourceY&&(this.newEventAction.sourceY=""),this.newEventAction.sourceY+=e):"newEventAction.targetX"==this.currentExpressionField?(null==this.newEventAction.targetX&&(this.newEventAction.targetX=""),this.newEventAction.targetX+=e):"newEventAction.targetY"==this.currentExpressionField?(null==this.newEventAction.targetY&&(this.newEventAction.targetY=""),this.newEventAction.targetY+=e):"newEventAction.variable"==this.currentExpressionField?(null==this.newEventAction.variable&&(this.newEventAction.variable=""),this.newEventAction.variable+=e):"newEventAction.expression"==this.currentExpressionField?(null==this.newEventAction.expression&&(this.newEventAction.expression=""),this.newEventAction.expression+=e):"newEventAction.lineWidth"==this.currentExpressionField?(null==this.newEventAction.lineWidth&&(this.newEventAction.lineWidth=""),this.newEventAction.lineWidth+=e):"newEventAction.x1"==this.currentExpressionField?(null==this.newEventAction.x1&&(this.newEventAction.x1=""),this.newEventAction.x1+=e):"newEventAction.y1"==this.currentExpressionField?(null==this.newEventAction.y1&&(this.newEventAction.y1=""),this.newEventAction.y1+=e):"newEventAction.x2"==this.currentExpressionField?(null==this.newEventAction.x2&&(this.newEventAction.x2=""),this.newEventAction.x2+=e):"newEventAction.y2"==this.currentExpressionField?(null==this.newEventAction.y2&&(this.newEventAction.y2=""),this.newEventAction.y2+=e):"newEventAction.radius"==this.currentExpressionField?(null==this.newEventAction.radius&&(this.newEventAction.radius=""),this.newEventAction.radius+=e):"newEventAction.width"==this.currentExpressionField?(null==this.newEventAction.width&&(this.newEventAction.width=""),this.newEventAction.width+=e):"newEventAction.height"==this.currentExpressionField?(null==this.newEventAction.height&&(this.newEventAction.height=""),this.newEventAction.height+=e):"newEventAction.alpha"==this.currentExpressionField?(null==this.newEventAction.alpha&&(this.newEventAction.alpha=""),this.newEventAction.alpha+=e):"newEventAction.rotation"==this.currentExpressionField?(null==this.newEventAction.rotation&&(this.newEventAction.rotation=""),this.newEventAction.rotation+=e):"newEventAction.text"==this.currentExpressionField?(null==this.newEventAction.text&&(this.newEventAction.text=""),this.newEventAction.text+=e):"newEventAction.maxValue"==this.currentExpressionField?(null==this.newEventAction.maxValue&&(this.newEventAction.maxValue=""),this.newEventAction.maxValue+=e):"newEventAction.fontSize"==this.currentExpressionField?(null==this.newEventAction.fontSize&&(this.newEventAction.fontSize=""),this.newEventAction.fontSize+=e):"newEventAction.color.red"==this.currentExpressionField?(null==this.newEventAction.color&&(this.newEventAction.color=new s.default("","","")),this.newEventAction.color.red+=e):"newEventAction.color.green"==this.currentExpressionField?(null==this.newEventAction.color&&(this.newEventAction.color=new s.default("","","")),this.newEventAction.color.green+=e):"newEventAction.color.blue"==this.currentExpressionField?(null==this.newEventAction.color&&(this.newEventAction.color=new s.default("","","")),this.newEventAction.color.blue+=e):"newEventAction.borderColor.red"==this.currentExpressionField?(null==this.newEventAction.borderColor&&(this.newEventAction.borderColor=new s.default("","","")),this.newEventAction.borderColor.red+=e):"newEventAction.borderColor.green"==this.currentExpressionField?(null==this.newEventAction.borderColor&&(this.newEventAction.borderColor=new s.default("","","")),this.newEventAction.borderColor.green+=e):"newEventAction.borderColor.blue"==this.currentExpressionField?(null==this.newEventAction.borderColor&&(this.newEventAction.borderColor=new s.default("","","")),this.newEventAction.borderColor.blue+=e):"newEventAction.backgroundColor.red"==this.currentExpressionField?(null==this.newEventAction.backgroundColor&&(this.newEventAction.backgroundColor=new s.default("","","")),this.newEventAction.backgroundColor.red+=e):"newEventAction.backgroundColor.green"==this.currentExpressionField?(null==this.newEventAction.backgroundColor&&(this.newEventAction.backgroundColor=new s.default("","","")),this.newEventAction.backgroundColor.green+=e):"newEventAction.backgroundColor.blue"==this.currentExpressionField&&(null==this.newEventAction.backgroundColor&&(this.newEventAction.backgroundColor=new s.default("","","")),this.newEventAction.backgroundColor.blue+=e),this.closeExpressionHelp()},e.prototype.updateExpressionLoopObjectVariables=function(){this.expressionLoopObjectVariables=new Array;for(var e=this.gameParamsJson.events[this.currentEventIndex].loops,t=null,i=0;i<e.length;i++)e[i].loopVariableName==this.expressionLoopVariableName&&(t=e[i]);if(t.type==w.default.OBJECT&&t.objectSelectorDefinition.type==T.default.ALL_OBJECTS_OF_TYPE){var o=t.objectSelectorDefinition.objectType;this.expressionLoopObjectVariables=o.objectVariables}},e.prototype.clearExpressionHelpForm=function(){this.expressionType=null,this.expressionToInsert=null,this.expressionObjectAttribute=null,this.expressionLoopVariableName=null,this.expressionLoopVariableName2=null,this.expressionGlobalVariableName=null,this.expressionLevelVariableName=null,this.expressionLoopObjectVariables=new Array,this.expressionLoopObjectVariable=null,this.expressionLocalStorageVariableName=null},e.prototype.newGame=function(){confirm("Are you sure? Any unsaved changes will be lost.")&&this.startNewGame()},e.prototype.startNewGame=function(){this.actionTemplate=null,this.isPlayingGame=!1,this.gameId=null,this.gameName="My Game",this.gameDescription="";var e=new c.default;e.canvasHeight=500,e.canvasWidth=600,e.levels=new Array,e.customObjectTypes=new Array,e.events=new Array,e.customTexts=new Array,e.globalVariables=new Array,e.customImages=new Array,this.gameParamsJson=e,this.addLevel()},e.prototype.requestCanvasFullscreen=function(){this.util.requestCanvasFullscreen()},e.prototype.refreshSession=function(){this.sessionId=this.util.getCookie("sessionId")},e.prototype.setCurrentTab=function(e){this.currentTab=e,this.closeExpressionHelp(),"SAVE"==e&&this.refreshSession(),"IMPORT_EXPORT"==e&&(this.gameParamsJsonDecycled=null);for(var t=["LEVELS","CUSTOM_OBJECT_TYPES","CUSTOM_TEXTS","GLOBAL_VARIABLES","EVENTS","IMPORT_EXPORT","SAVE","EDIT_LEVEL","EDIT_CUSTOM_OBJECT","EDIT_GLOBAL_VARIABLE","EDIT_CUSTOM_TEXT","EDIT_EVENT","EDIT_LOOP","EDIT_EVENT_CONDITION","EDIT_EVENT_ACTION","EDIT_BUTTON","EDIT_LEVEL_VARIABLE","EDIT_OBJECT_VARIABLE","EDIT_CUSTOM_OBJECT_TYPE","EDIT_CUSTOM_OBJECT_TYPE_BEHAVIOUR","CUSTOM_IMAGES"],i=0;i<t.length;i++){var o=document.getElementById("link-tab-"+t[i]);null!=o&&(o.className="nav-link")}var n=document.getElementById("link-tab-"+e);null!=n&&n.classList.add("active"),this.setCurrentTab2(""),this.setCurrentScreen(e)},e.prototype.setCurrentTab2=function(e){this.currentTab2=e;for(var t=["PROPERTIES","INITIAL_OBJECTS","LEVEL_TEXTS","BUTTONS","LEVEL_VARIABLES","LEVEL_EVENTS","CUSTOM_OBJECT_TYPE_PROPERTIES","CUSTOM_OBJECT_TYPE_BEHAVIOURS","CUSTOM_OBJECT_VARIABLES"],i=0;i<t.length;i++){var o=document.getElementById("link-tab-"+t[i]);null!=o&&(o.className="nav-link")}var n=document.getElementById("link-tab-"+e);null!=n&&n.classList.add("active"),this.setCurrentScreen(e)},e.prototype.setCurrentScreen=function(e){this.currentScreen=e},e.prototype.addLevel=function(){var e=new v.default;e.name="Level "+(this.gameParamsJson.levels.length+1),e.uid=this.util.uid(),e.backgroundType=R.default.SOLID_COLOR,e.backgroundColor=new n.default(255,255,255),e.gravity=0,e.electricConstant=0,e.levelVariables=new Array,e.initialObjects=new Array,e.texts=new Array,e.buttons=new Array,e.applyGravitationalForceBetweenObjects=!1,e.gravitationalConstant=0;var t=new M.default;t.imageSourceType=N.default.LIBRARY,t.imageId="images/asset-packs/kenney/2d/voxel-pack/png/tiles/greystone.png",e.backgroundImage=t,this.gameParamsJson.levels.push(e)},e.prototype.moveLevelUp=function(e){this.util.arrayMove(this.gameParamsJson.levels,e,e-1)},e.prototype.moveLevelDown=function(e){this.util.arrayMove(this.gameParamsJson.levels,e,e+1)},e.prototype.deleteLevel=function(e){this.gameParamsJson.levels.splice(e,1)},e.prototype.showLevelVariables=function(e){this.editLevel(e),this.currentTab2="LEVEL_VARIABLES"},e.prototype.showInitialObjects=function(e){this.editLevel(e),this.currentTab2="INITIAL_OBJECTS"},e.prototype.editLevel=function(e){this.setCurrentTab2("INITIAL_OBJECTS");var t=this.gameParamsJson.levels[e];this.oldLevel=t,this.newLevel=JSON.parse(JSON.stringify(t)),this.currentLevelIndex=e},e.prototype.cancelChangesLevel=function(){this.setCurrentTab("LEVELS"),this.oldLevel=null,this.newLevel=null},e.prototype.updateLevel=function(){this.setCurrentTab("LEVELS"),this.oldLevel.name=this.newLevel.name,this.oldLevel.backgroundType=this.newLevel.backgroundType,this.oldLevel.backgroundImage.imageId=this.newLevel.backgroundImage.imageId,this.oldLevel.backgroundImage.imageSourceType=this.newLevel.backgroundImage.imageSourceType,this.oldLevel.backgroundImage.customImage=this.newLevel.backgroundImage.customImage,this.oldLevel.backgroundColor={red:Number(this.newLevel.backgroundColor.red),green:Number(this.newLevel.backgroundColor.green),blue:Number(this.newLevel.backgroundColor.blue),alpha:100},this.oldLevel.gravity=Number(this.newLevel.gravity),this.oldLevel.electricConstant=Number(this.newLevel.electricConstant),this.oldLevel.centerCameraAtObject=this.newLevel.centerCameraAtObject,this.oldLevel.centerCameraAtObjectTypeId=this.newLevel.centerCameraAtObjectTypeId,this.oldLevel.applyGravitationalForceBetweenObjects=this.newLevel.applyGravitationalForceBetweenObjects,this.oldLevel.gravitationalConstant=this.newLevel.gravitationalConstant,this.oldLevel=null,this.newLevel=null},e.prototype.addEvent=function(){var e=new h.default;e.uid=this.util.uid(),e.levelDefinition=this.gameParamsJson.levels[0],e.loops=new Array,e.conditions=new Array,e.actions=new Array,this.gameParamsJson.events.push(e)},e.prototype.editEvent=function(e){this.setCurrentScreen("EDIT_EVENT"),this.oldEvent=e,this.newEvent=JSON.parse(JSON.stringify(this.oldEvent))},e.prototype.updateEvent=function(){this.setCurrentTab("EVENTS"),this.oldEvent.description=this.newEvent.description,this.oldEvent.levelDefinition=this.util.findLevelDefinitionByUid(this.gameParamsJson.levels,this.newEvent.levelDefinition.uid),this.oldEvent=null,this.newEvent=null},e.prototype.cancelChangesEvent=function(){this.setCurrentTab("EVENTS"),this.oldEvent=null,this.newEvent=null},e.prototype.moveEventUp=function(e){this.util.arrayMove(this.gameParamsJson.events,e,e-1)},e.prototype.moveEventDown=function(e){this.util.arrayMove(this.gameParamsJson.events,e,e+1)},e.prototype.deleteEvent=function(e){this.gameParamsJson.events.splice(e,1)},e.prototype.deleteAllEvents=function(e){confirm("Delete all events?")&&this.gameParamsJson.events.splice(0,this.gameParamsJson.events.length)},e.prototype.addEventAction=function(e){var t=new f.default;t.type=_.default.GO_TO_NEXT_LEVEL,t.font=null,t.fillStyle=null,t.textAlign=null,t.objectSelectorDefinition=new d.default,t.objectSelectorDefinition.objectType=new m.default,t.sourceObjectSelectorDefinition=new d.default,t.sourceObjectSelectorDefinition.objectType=new m.default,t.targetObjectSelectorDefinition=new d.default,t.targetObjectSelectorDefinition.objectType=new m.default,t.color=new s.default("","",""),t.borderColor=new s.default("","",""),t.backgroundColor=new s.default("","",""),t.levelDefinition=new v.default,t.button=new g.default;var i=new M.default;i.imageSourceType=N.default.LIBRARY,i.imageId="images/asset-packs/kenney/2d/puzzle-2/png/balls/blue/ballBlue_10.png",t.image=i,this.gameParamsJson.events[e].actions.push(t)},e.prototype.deleteEventAction=function(e,t){this.gameParamsJson.events[e].actions.splice(t,1)},e.prototype.editEventAction=function(e,t){this.setCurrentScreen("EDIT_EVENT_ACTION"),this.oldEventAction=e,this.newEventAction=JSON.parse(JSON.stringify(this.oldEventAction)),this.newEventAction.customObjectType=this.newEventAction.customObjectType||new m.default,null==this.newEventAction.objectSelectorDefinition&&(this.newEventAction.objectSelectorDefinition=new d.default),null==this.newEventAction.objectSelectorDefinition.objectType&&(this.newEventAction.objectSelectorDefinition.objectType=new m.default),null==this.newEventAction.sourceObjectSelectorDefinition&&(this.newEventAction.sourceObjectSelectorDefinition=new d.default),null==this.newEventAction.sourceObjectSelectorDefinition.objectType&&(this.newEventAction.sourceObjectSelectorDefinition.objectType=new m.default),null==this.newEventAction.targetObjectSelectorDefinition&&(this.newEventAction.targetObjectSelectorDefinition=new d.default),null==this.newEventAction.targetObjectSelectorDefinition.objectType&&(this.newEventAction.targetObjectSelectorDefinition.objectType=new m.default),null==this.newEventAction.color&&(this.newEventAction.color=new s.default("","","")),null==this.newEventAction.borderColor&&(this.newEventAction.borderColor=new s.default("","","")),null==this.newEventAction.backgroundColor&&(this.newEventAction.backgroundColor=new s.default("","","")),null==this.newEventAction.levelDefinition&&(this.newEventAction.levelDefinition=new v.default),null==this.newEventAction.button&&(this.newEventAction.button=new g.default),this.eventActionCategory=C.default.ALL,this.filterEventActionTypes(),this.loadButtons(),this.loadLoopVariableNames(t),this.currentEventIndex=t},e.prototype.updateEventAction=function(){this.setCurrentTab("EVENTS"),this.oldEventAction.type=this.newEventAction.type,this.oldEventAction.customObjectType=this.util.findElementByUid(this.gameParamsJson.customObjectTypes,this.newEventAction.customObjectType.uid),this.oldEventAction.sourceType=this.newEventAction.sourceType,this.oldEventAction.targetType=this.newEventAction.targetType,this.oldEventAction.x=this.newEventAction.x,this.oldEventAction.y=this.newEventAction.y,this.oldEventAction.attribute=this.newEventAction.attribute,this.oldEventAction.value=this.newEventAction.value,this.oldEventAction.variable=this.newEventAction.variable,null!=this.newEventAction.levelDefinition&&(this.oldEventAction.levelDefinition=this.util.findLevelDefinitionByUid(this.gameParamsJson.levels,this.newEventAction.levelDefinition.uid)),this.oldEventAction.sourceX=this.newEventAction.sourceX,this.oldEventAction.sourceY=this.newEventAction.sourceY,this.oldEventAction.targetX=this.newEventAction.targetX,this.oldEventAction.targetY=this.newEventAction.targetY,this.oldEventAction.x1=this.newEventAction.x1,this.oldEventAction.y1=this.newEventAction.y1,this.oldEventAction.x2=this.newEventAction.x2,this.oldEventAction.y2=this.newEventAction.y2,this.oldEventAction.lineWidth=this.newEventAction.lineWidth,this.oldEventAction.width=this.newEventAction.width,this.oldEventAction.height=this.newEventAction.height,this.oldEventAction.radius=this.newEventAction.radius,this.oldEventAction.speed=this.newEventAction.speed,this.oldEventAction.speedX=this.newEventAction.speedX,this.oldEventAction.speedY=this.newEventAction.speedY,this.oldEventAction.force=this.newEventAction.force,this.oldEventAction.angle=this.newEventAction.angle,this.oldEventAction.expression=this.newEventAction.expression,this.oldEventAction.text=this.newEventAction.text,this.oldEventAction.fontSize=this.newEventAction.fontSize,this.oldEventAction.fontFamily=this.newEventAction.fontFamily,this.oldEventAction.textAlign=this.newEventAction.textAlign,this.oldEventAction.fillStyle=this.newEventAction.fillStyle,this.oldEventAction.alpha=this.newEventAction.alpha,this.oldEventAction.rotation=this.newEventAction.rotation,this.oldEventAction.maxValue=this.newEventAction.maxValue,this.oldEventAction.split=this.newEventAction.split,this.oldEventAction.borderSize=this.newEventAction.borderSize,this.oldEventAction.drawType=this.newEventAction.drawType,this.oldEventAction.image.imageSourceType=this.newEventAction.image.imageSourceType,this.oldEventAction.image.imageId=this.newEventAction.image.imageId,this.newEventAction.image.imageSourceType==N.default.UPLOAD?this.oldEventAction.image.customImage=this.util.findElementByUid(this.gameParamsJson.customImages,this.newEventAction.image.customImage.uid):this.oldEventAction.image.customImage=null,null!=this.newEventAction.button&&(this.oldEventAction.button=this.util.findElementByUid(this.buttons,this.newEventAction.button.uid)),this.oldEventAction.objectSelectorDefinition=this.util.buildObjectSelector(this.newEventAction.objectSelectorDefinition,this.gameParamsJson.customObjectTypes),this.oldEventAction.sourceObjectSelectorDefinition=this.util.buildObjectSelector(this.newEventAction.sourceObjectSelectorDefinition,this.gameParamsJson.customObjectTypes),this.oldEventAction.targetObjectSelectorDefinition=this.util.buildObjectSelector(this.newEventAction.targetObjectSelectorDefinition,this.gameParamsJson.customObjectTypes),null!=this.newEventAction.color&&(this.oldEventAction.color=new s.default(this.newEventAction.color.red,this.newEventAction.color.green,this.newEventAction.color.blue)),null!=this.newEventAction.backgroundColor&&(this.oldEventAction.backgroundColor=new s.default(this.newEventAction.backgroundColor.red,this.newEventAction.backgroundColor.green,this.newEventAction.backgroundColor.blue)),null!=this.newEventAction.borderColor&&(this.oldEventAction.borderColor=new s.default(this.newEventAction.borderColor.red,this.newEventAction.borderColor.green,this.newEventAction.borderColor.blue)),this.oldEventAction=null,this.newEventAction=null},e.prototype.cancelChangesEventAction=function(){this.setCurrentTab("EVENTS"),this.oldEventAction=null,this.newEventAction=null},e.prototype.addCustomObject=function(e){0==this.gameParamsJson.customObjectTypes.length&&this.addCustomObjectType();var t=new b.default;t.x=this.gameParamsJson.canvasWidth/2-this.levelPreviewViewModel.levelPreviewRenderer.offsetX,t.y=this.gameParamsJson.canvasHeight/2-this.levelPreviewViewModel.levelPreviewRenderer.offsetY,t.objectType=this.gameParamsJson.customObjectTypes[0],this.gameParamsJson.levels[e].initialObjects.push(t),this.levelPreviewViewModel.deselectElements(),this.levelPreviewViewModel.selectedObject=t},e.prototype.deleteCustomObject=function(e,t){this.gameParamsJson.levels[e].initialObjects.splice(t,1)},e.prototype.editCustomObject=function(e){this.setCurrentScreen("EDIT_CUSTOM_OBJECT"),this.oldCustomObject=e,this.newCustomObject=JSON.parse(JSON.stringify(this.oldCustomObject))},e.prototype.cancelChangesCustomObject=function(){this.setCurrentTab2("INITIAL_OBJECTS"),this.oldCustomObject=null,this.newCustomObject=null},e.prototype.updateCustomObject=function(){this.setCurrentTab2("INITIAL_OBJECTS"),this.oldCustomObject.objectType=this.util.findElementByUid(this.gameParamsJson.customObjectTypes,this.newCustomObject.objectType.uid),this.oldCustomObject.x=Number(this.newCustomObject.x),this.oldCustomObject.y=Number(this.newCustomObject.y),this.oldCustomObject.repeatTimes=this.util.numberOrNull(this.newCustomObject.repeatTimes),this.oldCustomObject.dx=this.util.numberOrNull(this.newCustomObject.dx),this.oldCustomObject.dy=this.util.numberOrNull(this.newCustomObject.dy),this.oldCustomObject.repeatTimes2=this.util.numberOrNull(this.newCustomObject.repeatTimes2),this.oldCustomObject.dx2=this.util.numberOrNull(this.newCustomObject.dx2),this.oldCustomObject.dy2=this.util.numberOrNull(this.newCustomObject.dy2),this.oldCustomObject=null,this.newCustomObject=null},e.prototype.addButton=function(e){var t=new g.default;t.backgroundColor=new n.default(255,255,255),t.backgroundColorMouseOver=new n.default(255,255,255),t.borderColor=new n.default(0,0,0),t.borderColorMouseOver=new n.default(0,0,0),t.borderRadius=5,t.borderSize=1,t.borderSizeMouseOver=1,t.fontSize=14,t.height=30,t.name="button",t.text="button",t.textColor=new n.default(0,0,0),t.uid=this.util.uid(),t.width=100,t.x=300-this.levelPreviewViewModel.levelPreviewRenderer.offsetX,t.y=250-this.levelPreviewViewModel.levelPreviewRenderer.offsetY,this.gameParamsJson.levels[e].buttons.push(t),this.levelPreviewViewModel.deselectElements(),this.levelPreviewViewModel.selectedButton=t},e.prototype.deleteButton=function(e,t){this.gameParamsJson.levels[e].buttons.splice(t,1)},e.prototype.editButton=function(e){this.setCurrentScreen("EDIT_BUTTON"),this.oldButton=e,this.newButton=JSON.parse(JSON.stringify(this.oldButton))},e.prototype.cancelChangesButton=function(){this.setCurrentTab2("BUTTONS"),this.oldCustomObject=null,this.newCustomObject=null},e.prototype.updateButton=function(){this.setCurrentTab2("BUTTONS"),this.oldButton.name=this.newButton.name,this.oldButton.typeId=this.newButton.typeId,this.oldButton.x=Number(this.newButton.x),this.oldButton.y=Number(this.newButton.y),this.oldButton.width=Number(this.newButton.width),this.oldButton.height=Number(this.newButton.height),this.oldButton.borderSize=Number(this.newButton.borderSize),this.oldButton.borderSizeMouseOver=Number(this.newButton.borderSizeMouseOver),this.oldButton.borderRadius=Number(this.newButton.borderRadius),this.oldButton.fontSize=Number(this.newButton.fontSize),this.oldButton.text=this.newButton.text,this.oldButton.backgroundColor={red:Number(this.newButton.backgroundColor.red),green:Number(this.newButton.backgroundColor.green),blue:Number(this.newButton.backgroundColor.blue),alpha:100},this.oldButton.backgroundColorMouseOver={red:Number(this.newButton.backgroundColorMouseOver.red),green:Number(this.newButton.backgroundColorMouseOver.green),blue:Number(this.newButton.backgroundColorMouseOver.blue),alpha:100},this.oldButton.borderColor={red:Number(this.newButton.borderColor.red),green:Number(this.newButton.borderColor.green),blue:Number(this.newButton.borderColor.blue),alpha:100},this.oldButton.borderColorMouseOver={red:Number(this.newButton.borderColorMouseOver.red),green:Number(this.newButton.borderColorMouseOver.green),blue:Number(this.newButton.borderColorMouseOver.blue),alpha:100},this.oldButton.textColor={red:Number(this.newButton.textColor.red),green:Number(this.newButton.textColor.green),blue:Number(this.newButton.textColor.blue),alpha:100},this.oldButton=null,this.newButton=null},e.prototype.addLevelVariable=function(e){null==this.gameParamsJson.levels[e].levelVariables&&(this.gameParamsJson.levels[e].levelVariables=new Array);var t=new O.default;t.name="variable01",t.initialValue=0,t.type=j.default.NUMBER,this.gameParamsJson.levels[e].levelVariables.push(t)},e.prototype.deleteLevelVariable=function(e,t){this.gameParamsJson.levels[e].levelVariables.splice(t,1)},e.prototype.editLevelVariable=function(e){this.setCurrentScreen("EDIT_LEVEL_VARIABLE"),this.oldLevelVariable=e,this.newLevelVariable=JSON.parse(JSON.stringify(this.oldLevelVariable))},e.prototype.cancelChangesLevelVariable=function(){this.setCurrentTab2("LEVEL_VARIABLES"),this.oldLevelVariable=null,this.newLevelVariable=null},e.prototype.updateLevelVariable=function(){this.setCurrentTab2("LEVEL_VARIABLES"),this.oldLevelVariable.name=this.newLevelVariable.name,this.oldLevelVariable.initialValue=Number(this.newLevelVariable.initialValue),this.oldLevelVariable=null,this.newLevelVariable=null},e.prototype.addLevelText=function(e){null==this.gameParamsJson.levels[e].texts&&(this.gameParamsJson.levels[e].texts=new Array);var t=new B.default;t.uid=this.util.uid(),t.text="Text",t.align="center",t.color=new n.default(0,0,0),t.fontFamily="arial",t.fontSize=32,t.x=300-this.levelPreviewViewModel.levelPreviewRenderer.offsetX,t.y=250-this.levelPreviewViewModel.levelPreviewRenderer.offsetY,this.gameParamsJson.levels[e].texts.push(t),this.levelPreviewViewModel.deselectElements(),this.levelPreviewViewModel.selectedText=t},e.prototype.deleteLevelText=function(e,t){this.gameParamsJson.levels[e].texts.splice(t,1)},e.prototype.editLevelText=function(e){this.setCurrentScreen("EDIT_LEVEL_TEXT"),this.oldLevelText=e,this.newLevelText=JSON.parse(JSON.stringify(this.oldLevelText))},e.prototype.cancelChangesLevelText=function(){this.setCurrentTab2("LEVEL_TEXTS"),this.oldLevelText=null,this.newLevelText=null},e.prototype.updateLevelText=function(){this.setCurrentTab2("LEVEL_TEXTS"),this.oldLevelText.text=this.newLevelText.text,this.oldLevelText.fontFamily=this.newLevelText.fontFamily,this.oldLevelText.align=this.newLevelText.align,this.oldLevelText.x=Number(this.newLevelText.x),this.oldLevelText.y=Number(this.newLevelText.y),this.oldLevelText.fontSize=Number(this.newLevelText.fontSize),this.oldLevelText.color={red:this.newLevelText.color.red,green:this.newLevelText.color.green,blue:this.newLevelText.color.blue,alpha:this.newLevelText.color.alpha},this.oldLevelText=null,this.newLevelText=null},e.prototype.addObjectVariable=function(e){null==this.gameParamsJson.customObjectTypes[e].objectVariables&&(this.gameParamsJson.customObjectTypes[e].objectVariables=new Array);var t=new y.default;t.name="variable01",t.initialValue=0,t.type=j.default.NUMBER,this.gameParamsJson.customObjectTypes[e].objectVariables.push(t)},e.prototype.deleteObjectVariable=function(e,t){this.gameParamsJson.customObjectTypes[e].objectVariables.splice(t,1)},e.prototype.editObjectVariable=function(e){this.setCurrentScreen("EDIT_OBJECT_VARIABLE"),this.oldObjectVariable=e,this.newObjectVariable=JSON.parse(JSON.stringify(this.oldObjectVariable))},e.prototype.cancelChangesObjectVariable=function(){this.setCurrentTab2("CUSTOM_OBJECT_VARIABLES"),this.oldObjectVariable=null,this.newObjectVariable=null},e.prototype.updateObjectVariable=function(){this.setCurrentTab2("CUSTOM_OBJECT_VARIABLES"),this.oldObjectVariable.name=this.newObjectVariable.name,this.oldObjectVariable.initialValue=Number(this.newObjectVariable.initialValue),this.oldObjectVariable=null,this.newObjectVariable=null},e.prototype.addLoop=function(e){var t=new E.default;t.loopVariableName="",t.objectSelectorDefinition=new d.default,t.objectSelectorDefinition.objectType=new m.default,null==this.gameParamsJson.events[e].loops&&(this.gameParamsJson.events[e].loops=[]),this.gameParamsJson.events[e].loops.push(t)},e.prototype.deleteLoop=function(e,t){this.gameParamsJson.events[e].loops.splice(t,1)},e.prototype.editLoop=function(e){this.setCurrentScreen("EDIT_LOOP"),this.oldLoop=e,this.newLoop=JSON.parse(JSON.stringify(this.oldLoop)),null==this.newLoop.objectSelectorDefinition.objectType&&(this.newLoop.objectSelectorDefinition.objectType=new m.default)},e.prototype.cancelChangesLoop=function(){this.setCurrentTab("EVENTS"),this.oldLoop=null,this.newLoop=null},e.prototype.updateLoop=function(){if(this.setCurrentTab("EVENTS"),this.oldLoop.type=this.newLoop.type,this.oldLoop.loopVariableName=this.newLoop.loopVariableName,this.oldLoop.from=Number(this.newLoop.from),this.oldLoop.to=Number(this.newLoop.to),this.oldLoop.increment=Number(this.newLoop.increment),this.newLoop.type==w.default.OBJECT){var e=this.newLoop.objectSelectorDefinition.objectType.uid;this.oldLoop.objectSelectorDefinition=this.newLoop.objectSelectorDefinition,this.oldLoop.objectSelectorDefinition.objectType=this.util.findCustomObjectDefinitionByUid(this.gameParamsJson.customObjectTypes,e)}this.oldLoop=null,this.newLoop=null},e.prototype.fillLoopVariableName=function(){if(null==this.newLoop.loopVariableName||""==this.newLoop.loopVariableName)for(var e=0;e<this.gameParamsJson.customObjectTypes.length;e++)this.gameParamsJson.customObjectTypes[e].uid==this.newLoop.objectSelectorDefinition.objectType.uid&&(this.newLoop.loopVariableName=this.gameParamsJson.customObjectTypes[e].id)},e.prototype.addCustomText=function(){this.gameParamsJson.customTexts.push({text:"text",font:"12px Arial",fillStyle:"#AAAAAA",x:0,y:0,levelIndex:0})},e.prototype.deleteCustomText=function(e){this.gameParamsJson.customTexts.splice(e,1)},e.prototype.editCustomText=function(e){this.setCurrentScreen("EDIT_CUSTOM_TEXT"),this.oldCustomText=e,this.newCustomText=JSON.parse(JSON.stringify(this.oldCustomText))},e.prototype.cancelChangesCustomText=function(){this.setCurrentTab("CUSTOM_TEXTS"),this.oldCustomText=null,this.newCustomText=null},e.prototype.updateCustomText=function(){this.setCurrentTab("CUSTOM_TEXTS"),this.oldCustomText.text=this.newCustomText.text,this.oldCustomText.font=this.newCustomText.font,this.oldCustomText.fillStyle=this.newCustomText.fillStyle,this.oldCustomText.x=Number(this.newCustomText.x),this.oldCustomText.y=Number(this.newCustomText.y),this.oldCustomText.levelIndex=Number(this.newCustomText.levelIndex),this.oldCustomText=null,this.newCustomText=null},e.prototype.addGlobalVariable=function(){var e=new y.default;e.name="globalVariable001",e.initialValue=0,this.gameParamsJson.globalVariables.push(e)},e.prototype.deleteGlobalVariable=function(e){this.gameParamsJson.globalVariables.splice(e,1)},e.prototype.editGlobalVariable=function(e){this.setCurrentScreen("EDIT_GLOBAL_VARIABLE"),this.oldGlobalVariable=e,this.newGlobalVariable=JSON.parse(JSON.stringify(this.oldGlobalVariable))},e.prototype.cancelChangesGlobalVariable=function(){this.setCurrentTab("GLOBAL_VARIABLES"),this.oldGlobalVariable=null,this.newGlobalVariable=null},e.prototype.updateGlobalVariable=function(){this.setCurrentTab("GLOBAL_VARIABLES"),this.oldGlobalVariable.name=this.newGlobalVariable.name,this.oldGlobalVariable.initialValue=Number(this.newGlobalVariable.initialValue),this.oldGlobalVariable=null,this.newGlobalVariable=null},e.prototype.goToAddCustomImage=function(){this.setCurrentScreen("ADD_CUSTOM_IMAGE"),this.newCustomImage=new I.default},e.prototype.addCustomImage=function(){this.newCustomImage.uid=this.util.uid(),this.gameParamsJson.customImages.push(this.newCustomImage),this.setCurrentTab("CUSTOM_IMAGES")},e.prototype.deleteCustomImage=function(e){this.gameParamsJson.customImages.splice(e,1)},e.prototype.editCustomImage=function(e){this.setCurrentScreen("EDIT_CUSTOM_IMAGE"),this.oldCustomImage=e,this.newCustomImage=JSON.parse(JSON.stringify(this.oldCustomImage))},e.prototype.updateCustomImage=function(){this.setCurrentTab("CUSTOM_IMAGES"),this.oldCustomImage.name=this.newCustomImage.name,this.oldCustomImage.imageData=this.newCustomImage.imageData,this.oldCustomImage=null,this.newCustomImage=null},e.prototype.cancelAddCustomImage=function(){this.setCurrentTab("CUSTOM_IMAGES")},e.prototype.addEventCondition=function(e){var t=new p.default;t.uid=this.util.uid(),t.type=A.default.ALWAYS,t.button=new g.default,t.objectSelectorDefinition=new d.default,t.objectSelectorDefinition.objectType=new m.default,this.gameParamsJson.events[e].conditions.push(t)},e.prototype.deleteEventCondition=function(e,t){this.gameParamsJson.events[e].conditions.splice(t,1)},e.prototype.editEventCondition=function(e,t){this.setCurrentScreen("EDIT_EVENT_CONDITION"),this.oldEventCondition=e;var i=JSON.parse(JSON.stringify(this.oldEventCondition));null==i.object1&&(i.object1=new d.default),null==i.object1.objectType&&(i.object1.objectType=new m.default),null==i.object2&&(i.object2=new d.default),null==i.object2.objectType&&(i.object2.objectType=new m.default),null==i.button&&(i.button=new g.default),null==i.objectSelectorDefinition&&(i.objectSelectorDefinition=new d.default),null==i.objectSelectorDefinition.objectType&&(i.objectSelectorDefinition.objectType=new m.default),this.newEventCondition=i,this.loadButtons(),this.loadLoopVariableNames(t),this.currentEventIndex=t},e.prototype.updateEventCondition=function(){this.setCurrentTab("EVENTS"),this.oldEventCondition.type=this.newEventCondition.type,this.oldEventCondition.expression=this.newEventCondition.expression,this.oldEventCondition.keyCode=this.newEventCondition.keyCode,this.oldEventCondition.frames=Number(this.newEventCondition.frames),this.oldEventCondition.seconds=Number(this.newEventCondition.seconds),this.oldEventCondition.x1=this.newEventCondition.x1,this.oldEventCondition.y1=this.newEventCondition.y1,this.oldEventCondition.x2=this.newEventCondition.x2,this.oldEventCondition.y2=this.newEventCondition.y2,this.oldEventCondition.distance=this.newEventCondition.distance,this.oldEventCondition.relation=this.newEventCondition.relation,this.oldEventCondition.objectSelectorDefinition=this.util.buildObjectSelector(this.newEventCondition.objectSelectorDefinition,this.gameParamsJson.customObjectTypes),this.oldEventCondition.object1=this.util.buildObjectSelector(this.newEventCondition.object1,this.gameParamsJson.customObjectTypes),this.oldEventCondition.object2=this.util.buildObjectSelector(this.newEventCondition.object2,this.gameParamsJson.customObjectTypes),null!=this.newEventCondition.button&&(this.oldEventCondition.button=this.util.findElementByUid(this.buttons,this.newEventCondition.button.uid)),this.oldEventCondition=null,this.newEventCondition=null},e.prototype.cancelChangesEventCondition=function(){this.setCurrentTab("EVENTS"),this.oldEventCondition=null,this.newEventCondition=null},e.prototype.showCustomObjectTypeBehaviours=function(e){this.editCustomObjectType(e),this.setCurrentTab2("CUSTOM_OBJECT_TYPE_BEHAVIOURS")},e.prototype.addCustomObjectTypeBehaviour=function(e){this.gameParamsJson.customObjectTypes[e].behaviours.push({type:"KEYBOARD_MOVEMENT"})},e.prototype.deleteCustomObjectTypeBehaviour=function(e,t){this.gameParamsJson.customObjectTypes[this.currentCustomObjectTypeIndex].behaviours.splice(t,1)},e.prototype.editCustomObjectTypeBehaviour=function(e){this.setCurrentScreen("EDIT_CUSTOM_OBJECT_TYPE_BEHAVIOUR"),this.oldCustomObjectTypeBehaviour=e,this.newCustomObjectTypeBehaviour=JSON.parse(JSON.stringify(e))},e.prototype.updateCustomObjectTypeBehaviour=function(){this.setCurrentTab2("CUSTOM_OBJECT_TYPE_BEHAVIOURS"),this.oldCustomObjectTypeBehaviour.type=this.newCustomObjectTypeBehaviour.type,this.oldCustomObjectTypeBehaviour.keyboardMovementType=this.newCustomObjectTypeBehaviour.keyboardMovementType,this.oldCustomObjectTypeBehaviour.mouseMovementType=this.newCustomObjectTypeBehaviour.mouseMovementType,this.oldCustomObjectTypeBehaviour.speedX=Number(this.newCustomObjectTypeBehaviour.speedX),this.oldCustomObjectTypeBehaviour.speedY=Number(this.newCustomObjectTypeBehaviour.speedY),this.oldCustomObjectTypeBehaviour.accelerationX=Number(this.newCustomObjectTypeBehaviour.accelerationX),this.oldCustomObjectTypeBehaviour.accelerationY=Number(this.newCustomObjectTypeBehaviour.accelerationY),this.oldCustomObjectTypeBehaviour.factorX=Number(this.newCustomObjectTypeBehaviour.factorX),this.oldCustomObjectTypeBehaviour.factorY=Number(this.newCustomObjectTypeBehaviour.factorY),this.oldCustomObjectTypeBehaviour.objectSelector=this.newCustomObjectTypeBehaviour.objectSelector,this.oldCustomObjectTypeBehaviour.bounceSpeed=Number(this.newCustomObjectTypeBehaviour.bounceSpeed),this.oldCustomObjectTypeBehaviour.jumpKey=this.newCustomObjectTypeBehaviour.jumpKey,this.oldCustomObjectTypeBehaviour.jumpSpeed=Number(this.newCustomObjectTypeBehaviour.jumpSpeed),this.oldCustomObjectTypeBehaviour=null,this.newCustomObjectTypeBehaviour=null},e.prototype.cancelChangesCustomObjectTypeBehaviour=function(){this.setCurrentTab2("CUSTOM_OBJECT_TYPE_BEHAVIOURS"),this.oldCustomObjectTypeBehaviour=null,this.newCustomObjectTypeBehaviour=null},e.prototype.addCustomObjectType=function(){var e=new m.default;e.uid=this.util.uid(),e.id="ObjectType"+(this.gameParamsJson.customObjectTypes.length+1),e.width=30,e.height=30,e.electricCharge=0,e.mass=0,e.alpha=1,e.applyGravity=!1,e.behaviours=new Array,e.renderType=S.default.IMAGE,e.color=new n.default(255,0,0),e.borderColor=new n.default(0,0,0),e.objectVariables=new Array;var t=new M.default;t.imageSourceType=N.default.LIBRARY,t.imageId="images/asset-packs/kenney/2d/puzzle-2/png/balls/blue/ballBlue_10.png",e.image=t,this.gameParamsJson.customObjectTypes.push(e)},e.prototype.deleteCustomObjectType=function(e){this.gameParamsJson.customObjectTypes.splice(e,1)},e.prototype.editCustomObjectType=function(e){this.setCurrentTab("CUSTOM_OBJECT_TYPES"),this.setCurrentTab2("CUSTOM_OBJECT_TYPE_PROPERTIES");var t=this.gameParamsJson.customObjectTypes[e];this.oldCustomObjectType=t,this.newCustomObjectType=JSON.parse(JSON.stringify(t)),this.currentCustomObjectTypeIndex=e},e.prototype.updateCustomObjectType=function(){this.setCurrentTab("CUSTOM_OBJECT_TYPES"),this.oldCustomObjectType.id=this.newCustomObjectType.id,this.oldCustomObjectType.width=Number(this.newCustomObjectType.width),this.oldCustomObjectType.height=Number(this.newCustomObjectType.height),this.oldCustomObjectType.electricCharge=Number(this.newCustomObjectType.electricCharge),this.oldCustomObjectType.mass=Number(this.newCustomObjectType.mass),this.oldCustomObjectType.alpha=Number(this.newCustomObjectType.alpha),this.oldCustomObjectType.applyGravity=this.newCustomObjectType.applyGravity,this.oldCustomObjectType.renderType=this.newCustomObjectType.renderType,this.oldCustomObjectType.drawType=this.newCustomObjectType.drawType,this.oldCustomObjectType.borderSize=Number(this.newCustomObjectType.borderSize),this.oldCustomObjectType.image.imageSourceType=this.newCustomObjectType.image.imageSourceType,this.oldCustomObjectType.image.imageId=this.newCustomObjectType.image.imageId,this.newCustomObjectType.image.imageSourceType==N.default.UPLOAD?this.oldCustomObjectType.image.customImage=this.util.findElementByUid(this.gameParamsJson.customImages,this.newCustomObjectType.image.customImage.uid):this.oldCustomObjectType.image.customImage=null,null!=this.newCustomObjectType.color&&(this.oldCustomObjectType.color=new n.default(this.newCustomObjectType.color.red,this.newCustomObjectType.color.green,this.newCustomObjectType.color.blue)),null!=this.newCustomObjectType.borderColor&&(this.oldCustomObjectType.borderColor=new n.default(this.newCustomObjectType.borderColor.red,this.newCustomObjectType.borderColor.green,this.newCustomObjectType.borderColor.blue)),this.oldCustomObjectType=null,this.newCustomObjectType=null},e.prototype.cancelChangesCustomObjectType=function(){this.setCurrentTab("CUSTOM_OBJECT_TYPES"),this.oldCustomObjectType=null,this.newCustomObjectType=null},e.prototype.generateSourceCode=function(){var e=new l.default;this.sourceCode=e.generateProcessEventsSourceCode(this.gameParamsJson)},e.prototype.exportDecycled=function(){this.gameParamsJsonDecycled=JSON.stringify(this.util.decycle(this.gameParamsJson,void 0),null,4)},e.prototype.importDecycled=function(){this.loadGameDecycled(this.newGameParamsJson)},e.prototype.loadGameDecycled=function(e){this.gameParamsJson=this.util.retrocycle(JSON.parse(e))},e.prototype.setGame=function(e){this.game=e,this.gameName=e.name.S,this.gameDescription=e.description.S,this.gameThumbnail=e.thumbnail.S,this.gameId=e.id.S,this.loadGameDecycled(e.paramsJson.S)},e.prototype.updateGameParamsJson=function(){this.gameParamsJson=JSON.parse(this.newGameParamsJson)},e.prototype.loadButtons=function(){this.buttons=[];for(var e=0;e<this.gameParamsJson.levels.length;e++)for(var t=this.gameParamsJson.levels[e],i=0;i<t.buttons.length;i++){var o=t.buttons[i];this.buttons.push(o)}},e.prototype.loadLoopVariableNames=function(e){var t=this.gameParamsJson.events[e];this.loopVariableNames1=this.util.getLoopVariableNames(t),this.loopVariableNames2=this.util.getLoopVariableNames(t)},e.prototype.initGame=function(){var e=new c.default;null!=this.gameParamsJson&&(e=this.gameParamsJson);var t=new o.default(null,e,this.ctx,this.resourcesBaseUrl);t.game.updateProcessEventsSourceCode(),this.actionTemplate=t,this.gameDefinition=e,this.isPlayingGame=!0},e.prototype.editGame=function(){this.actionTemplate=null,this.isPlayingGame=!1},e.prototype.removeEventListeners=function(){document.removeEventListener("keydown",this.keydown,!1),document.removeEventListener("keyup",this.keyup,!1)},e.prototype.listImageIds=function(){return this.util.listImageIds(this.gameParamsJson)},e}();t.ActionTemplateController=P},function(e,t,i){"use strict";t.__esModule=!0;var o=i(29),n=i(31),s=i(32),a=i(0),r=function(){function e(e,t,i,r){this.postScore=e,this.postedScore=!1;var l=this;this.game=new o.default(t,i,r),this.game.loadImages((function(){l.play=new s.default(l.game)})),this.ctx=i,this.util=new a.default,this.gameRenderer=new n.default}return e.prototype.getScore=function(){return null==this.play?0:this.play.score},e.prototype.setMousePos=function(e){null!=this.play&&(this.play.mousePos=e)},e.prototype.updateAccelerometer=function(e,t,i){null!=this.play&&(this.play.accelerometer.x=e,this.play.accelerometer.y=t,this.play.accelerometer.z=i)},e.prototype.updateGame=function(){null!=this.play&&this.play.update()},e.prototype.loop=function(){this.ctx;null==this.play||this.play.paused||(this.play.gameOver?this.postedScore||(this.postedScore=!0):(this.play.clearCustomElementsToDraw(),this.updateGame())),null!=this.play?this.gameRenderer.render(this.play.level):this.gameRenderer.renderLoading(this.game)},e.prototype.startNewGame=function(){this.play=new s.default(this.game),this.postedScore=!1},e.prototype.keydown=function(e){if(null!=this.play){var t=this.play;t.game;t.registerKeyDown(e.code),"Enter"==e.code&&t.gameOver&&this.startNewGame(),"KeyP"==e.code&&(t.paused=!t.paused)}},e.prototype.keyup=function(e){if(null!=this.play){var t=this.play;t.game;t.registerKeyUp(e.code)}},e.prototype.click=function(){},e.prototype.mousedown=function(){if(null!=this.play){var e=this.play;e.game;e.mouseDownList.push("mouseDown"),e.isLeftMouseButtonDown=!0}},e.prototype.mouseup=function(){if(null!=this.play){var e=this.play;e.game;e.mouseUpList.push("mouseUp"),e.isLeftMouseButtonDown=!1}},e}();t.default=r},function(e,t,i){"use strict";t.__esModule=!0;var o=i(11),n=i(0),s=function(){function e(e,t,i){this.images=new Map,this.numImagesLoaded=0,this.numImages=null,this.resourcesBaseUrl=null,this.processEvents=new Function("play",""),this.util=new n.default,this.ctx=t,this.gameDefinition=e,this.resourcesBaseUrl=i}return e.prototype.updateProcessEventsSourceCode=function(){var e=(new o.default).generateProcessEventsSourceCode(this.gameDefinition);this.processEvents=new Function("play",e)},e.prototype.loadImages=function(e){var t=this,i=this.util.listImageIds(this.gameDefinition);if(this.numImages=i.size,0!=i.size)for(var o=Array.from(i),n=0;n<o.length;n++){var s=o[n],a=new Image;if(a.onload=function(){t.numImagesLoaded++,t.isImageLoadingCompleted()&&e()},s.startsWith("custom:")){var r=s.substring(7),l=this.util.findElementByUid(this.gameDefinition.customImages,r);a.src=l.imageData}else a.src=this.resourcesBaseUrl+s;this.images.set(s,a)}else e()},e.prototype.getImage=function(e){return this.images.get(e)},e.prototype.isImageLoadingCompleted=function(){return this.numImagesLoaded==this.numImages},e}();t.default=s},function(e,t,i){"use strict";t.__esModule=!0;var o=i(7),n=i(14),s=i(0),a=i(8),r=function(){function e(){this.util=new s.default,this.environment=new n.default,this.regexpEngineVersion=new RegExp("{engineVersion}","g"),this.regexpFps=new RegExp("{fps}","g"),this.regexpScore=new RegExp("{score}","g"),this.regexpRandom=new RegExp("{random}","g"),this.regexpAccelerometerX=new RegExp("{accelerometer.x}","g"),this.regexpAccelerometerY=new RegExp("{accelerometer.y}","g"),this.regexpAccelerometerZ=new RegExp("{accelerometer.z}","g"),this.regexpLastTouchX=new RegExp("{lastTouchX}","g"),this.regexpLastTouchY=new RegExp("{lastTouchY}","g"),this.regexpMousePosX=new RegExp("{mousePosX}","g"),this.regexpMousePosY=new RegExp("{mousePosY}","g"),this.regexpScreenX=new RegExp("{screenX}","g"),this.regexpScreenY=new RegExp("{screenY}","g"),this.regexpLoopCurrentIndex=new RegExp("{loop.currentIndex}","g"),this.regexpLevelName=new RegExp("{levelDefinition.name}","g"),this.regexpCurrentLevelFrame=new RegExp("{level.currentFrame}","g"),this.regexLocalStorageVariable=new RegExp("{localStorage.\\w+}"),this.regexDistanceLoopObjects=new RegExp("{distanceLoopObjects\\(\\w+,\\w+\\)}"),this.regexMap=new Map}return e.prototype.findRegexByString=function(e){var t=this.regexMap.get(e);return null==t&&(t=new RegExp(e,"g"),this.regexMap.set(e,t)),t},e.prototype.initObjectVariablesRegexp=function(e){},e.prototype.evaluateExpression=function(e,t,i,o){if(o&&(e='"'+e+'"'),-1!=(e=this.replaceVariables(e,t,i,o)).indexOf("{"))throw new Error("Invalid expression: "+e);return e},e.prototype.replaceVariables=function(e,t,i,o){var n="",s="";o&&(n='"+',s='+"'),e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=e.replace(this.regexpEngineVersion,this.environment.templateVersion)).replace(this.regexpScore,n+"play.score"+s)).replace(this.regexpRandom,n+"Math.random()"+s)).replace(this.regexpFps,n+"Math.round(100*play.level.fps)/100"+s)).replace(this.regexpAccelerometerX,n+"play.accelerometer.x"+s)).replace(this.regexpAccelerometerY,n+"play.accelerometer.y"+s)).replace(this.regexpAccelerometerZ,n+"play.accelerometer.z"+s)).replace(this.regexpLastTouchX,n+"play.lastTouchX"+s)).replace(this.regexpLastTouchY,n+"play.lastTouchY"+s)).replace(this.regexpMousePosX,n+"(play.mousePos != null ? play.mousePos.x : 0)"+s)).replace(this.regexpMousePosY,n+"(play.mousePos != null ? play.mousePos.y : 0)"+s)).replace(this.regexpScreenX,n+"play.screenX"+s)).replace(this.regexpScreenY,n+"play.screenY"+s)).replace(this.regexpLevelName,n+"play.level.levelDefinition.name"+s)).replace(this.regexpCurrentLevelFrame,n+"play.level.currentFrame"+s);for(var a=0;a<i.loops.length;a++)for(var r=i.loops[a].loopVariableName,l=["x","y","speedX","speedY","width","height","alpha"],u=0;u<l.length;u++){var c=l[u],d=new RegExp("{loopObject.variable."+r+"."+c+"}","g");e=e.replace(d,n+"loopObject_"+r+"."+c+s)}for(a=0;a<i.loops.length;a++)for(r=i.loops[a].loopVariableName,u=0;u<t.customObjectTypes.length;u++){var h=t.customObjectTypes[u];if(null!=h.objectVariables)for(var p=0;p<h.objectVariables.length;p++){var E=h.objectVariables[p].name;d=new RegExp("{loopObject.variable."+r+".variable."+E+"}","g");e=e.replace(d,n+"loopObject_"+r+'.getVariable("'+E+'")'+s)}}for(a=0;a<i.loops.length;a++){r=i.loops[a].loopVariableName,d=new RegExp("{loopObject.variable."+r+"}","g");e=e.replace(d,n+"loopObject_"+r+s)}var f=t.globalVariables;if(null!=f)for(a=0;a<f.length;a++){var v=f[a].name;d=new RegExp("{globalVariable."+v+"}","g");e=e.replace(d,n+'play.globalVariables.get("'+v+'")'+s)}var m=t.levels;for(a=0;a<m.length;a++){var y=m[a].levelVariables;for(u=0;u<y.length;u++){var g=y[u].name;d=new RegExp("{levelVariable."+g+"}","g");e=e.replace(d,n+'play.level.variables.get("'+g+'")'+s)}}return e},e.prototype.replaceVariables_OLD=function(e,t,i){var n=this;e=(e=(e=e.replace(this.regexpScore,""+t.score)).replace(this.regexpRandom,""+Math.random())).replace(this.regexpFps,""+Math.round(100*t.level.fps)/100);var s=t.level.variables;null!=s&&s.forEach((function(t,i){e=e.replace(n.findRegexByString("{levelVariable."+i+"}"),""+t)}));var a=t.globalVariables;return null!=a&&a.forEach((function(t,i){e=e.replace(n.findRegexByString("{globalVariable."+i+"}"),""+t)})),null!=i&&i.variables.forEach((function(t,i){t instanceof o.default?(e=(e=(e=(e=(e=(e=(e=e.replace(n.findRegexByString("{loopObject.variable."+i+".x}"),""+t.x)).replace(n.findRegexByString("{loopObject.variable."+i+".y}"),""+t.y)).replace(n.findRegexByString("{loopObject.variable."+i+".speedX}"),""+t.speedX)).replace(n.findRegexByString("{loopObject.variable."+i+".speedY}"),""+t.speedY)).replace(n.findRegexByString("{loopObject.variable."+i+".width}"),""+2*t.halfWidth)).replace(n.findRegexByString("{loopObject.variable."+i+".height}"),""+2*t.halfHeight)).replace(n.findRegexByString("{loopObject.variable."+i+".alpha}"),""+t.alpha),t.variables.forEach((function(t,o){e=e.replace(n.findRegexByString("{loopObject.variable."+i+".variable."+o+"}"),""+t)}))):"number"==typeof t&&(e=e.replace(n.findRegexByString("{loopObject.variable."+i+"}"),""+t))})),e=(e=(e=(e=(e=t.mousePos?(e=e.replace(this.regexpMousePosX,""+t.mousePos.x)).replace(this.regexpMousePosY,""+t.mousePos.y):(e=e.replace(this.regexpMousePosX,"0")).replace(this.regexpMousePosY,"0")).replace(this.regexpScreenX,""+t.screenX)).replace(this.regexpScreenY,""+t.screenY)).replace(this.regexpLevelName,""+t.level.levelDefinition.name)).replace(this.regexpCurrentLevelFrame,""+t.level.currentFrame),e=this.replaceLevelArrayVariables(e,t,i),e=this.replaceLocalStorageVariables(e,t,i),e=this.replaceDistanceLoopObjects(e,t,i)},e.prototype.replaceLevelArrayVariables=function(e,t,i){for(var o=t.level.levelDefinition.levelVariables,n=0;n<o.length;n++)if(o[n].type==a.default.ARRAY){var s=o[n].name;e=this.replaceLevelArrayVariable(e,t,i,s)}return e},e.prototype.replaceLevelArrayVariable=function(e,t,i,o){for(var n=t.level.variables.get(o),s=new RegExp("{levelVariable."+o+"\\[\\d+\\]}"),a=s.exec(e);a;){var r=new RegExp("\\d+").exec(a[0]),l=parseInt(r[0]);e=e.replace(s,n[l]),a=s.exec(e)}return e},e.prototype.replaceLocalStorageVariables=function(e,t,i){for(var o=this.regexLocalStorageVariable.exec(e);o;){var n=o[0].substring(14,o[0].length-1);e=e.replace(this.regexLocalStorageVariable,localStorage.getItem(n)),o=this.regexLocalStorageVariable.exec(e)}return e},e.prototype.replaceDistanceLoopObjects=function(e,t,i){for(var n=this.regexDistanceLoopObjects.exec(e);n;){var s=n[0].substring(21,n[0].length-2).split(","),a=s[0],r=s[1],l=i.variables.get(a),u=i.variables.get(r),c=0;l instanceof o.default&&u instanceof o.default&&(c=this.util.distanceObjects(l,u)),e=e.replace(this.regexDistanceLoopObjects,"("+c+")"),n=this.regexDistanceLoopObjects.exec(e)}return e},e}();t.default=r},function(e,t,i){"use strict";t.__esModule=!0;var o=i(1),n=i(15),s=i(0),a=i(16),r=i(3),l=i(4),u=i(17),c=function(){function e(){this.expressionEvaluator=new n.default,this.progressBarColor=new o.default(32,32,128,100),this.util=new s.default,this.renderUtil=new u.default}return e.prototype.renderLoading=function(e){var t=e.numImages,i=e.numImagesLoaded,n=100;t>0&&(n=Math.floor(100*i/t));var s=i+" of "+t+" ("+n+"%)",a=e.ctx;a.fillStyle="#dddddd",a.fillRect(0,0,e.gameDefinition.canvasWidth,e.gameDefinition.canvasHeight),a.font="16px sans-serif",a.textAlign="center",a.fillStyle="#000000",a.fillText("Loading... "+s,300,250),a.font="12px sans-serif",a.fillText("made with",300,450),a.font="18px sans-serif",a.fillText("EasyGameMaker",300,470),this.drawPercentageBar(a,100,260,400,10,i,t,!1,1,this.progressBarColor,o.default.WHITE,o.default.BLACK)},e.prototype.render=function(e){var t=e.play,i=t.game,o=t.game.ctx;o.clearRect(0,0,i.gameDefinition.canvasWidth,i.gameDefinition.canvasHeight),this.rotateCanvas(e.canvasAngle,i),this.drawBackground(e);var n=t.level.customObjectArray;if(null!=n)for(var s=0;s<n.length;s++)this.drawCustomObject(n[s],e,o);var a=t.level.levelDefinition.texts;if(null!=a)for(s=0;s<a.length;s++){var r=this.buildFillStyleFromColor(a[s].color),l=a[s].fontSize+"px "+a[s].fontFamily;this.util.drawText(o,a[s].text,a[s].x,a[s].y,l,r,a[s].align,"middle")}this.drawCustomElements(t),this.renderInfo(e),this.renderCustomTexts(e),this.renderDynamicTexts(e),this.rotateCanvas(-e.canvasAngle,i),this.drawButtons(e)},e.prototype.drawButtons=function(e){for(var t=e.play.game.ctx,i=0;i<e.buttonArray.length;i++){var o=e.buttonArray[i];this.drawButton(t,o)}},e.prototype.rotateCanvas=function(e,t){var i=t.ctx;i.translate(t.gameDefinition.canvasWidth/2,t.gameDefinition.canvasHeight/2),i.rotate(e),i.translate(-t.gameDefinition.canvasWidth/2,-t.gameDefinition.canvasHeight/2)},e.prototype.rotateCanvasAt=function(e,t,i,o){var n=t.ctx;n.translate(i,o),n.rotate(e),n.translate(-i,-o)},e.prototype.renderCustomTexts=function(e){var t=e.play,i=t.game.ctx,o=t.game.gameDefinition.customTexts;if(null!=o)for(var n=0;n<o.length;n++){var s=o[n];null!=s.levelIndex&&s.levelIndex!=t.currentLevelIndex||(i.font=s.font,i.fillStyle=s.fillStyle,i.fillText(s.text,s.x,s.y))}},e.prototype.renderDynamicTexts=function(e){var t=e.play,i=t.game.ctx,o=t.game.gameDefinition.dynamicTexts;if(null!=o)for(var n=0;n<o.length;n++){var s=o[n];if(null==s.levelIndex||s.levelIndex==t.currentLevelIndex){var a=this.expressionEvaluator.replaceVariables(s.text,e.play,null);i.font=s.font,i.fillStyle=s.fillStyle,i.fillText(a,s.x,s.y)}}},e.prototype.renderInfo=function(e){var t=e.play,i=t.game.ctx;i.fillStyle="#000000",t.gameOver?(i.font="30px Arial",i.fillText("GAME OVER",t.game.gameDefinition.canvasWidth/2-100,t.game.gameDefinition.canvasHeight/2-60)):t.paused&&(i.font="30px Arial",i.fillText("PAUSED",t.game.gameDefinition.canvasWidth/2-100,t.game.gameDefinition.canvasHeight/2-60)),i.font="10px Arial"},e.prototype.drawPercentageBar=function(e,t,i,o,n,s,a,r,l,u,c,d){var h=this.buildFillStyleFromColor(u),p=this.buildFillStyleFromColor(c),E=this.buildFillStyleFromColor(d);if(this.drawBar(e,t-l,i-l,o+2*l,n+2*l,E),this.drawBar(e,t,i,o,n,p),this.drawBar(e,t,i,o*s/a,n,h),r)for(var f=o/a,v=1;v<a;v++)this.drawBar(e,Math.round(t+f*v-l/2),i,l,n,E)},e.prototype.drawBar=function(e,t,i,o,n,s){e.fillStyle=s,e.beginPath(),e.rect(t,i,o,n),e.closePath(),e.fill()},e.prototype.buildFillStyleFromColor=function(e){return this.util.buildFillStyleFromColor(e)},e.prototype.drawBackground=function(e){var t=e.play;if(e.levelDefinition.backgroundType==l.default.SOLID_COLOR){var i=e.levelDefinition.backgroundColor;t.game.ctx.fillStyle=this.buildFillStyleFromColor(i),t.game.ctx.fillRect(0,0,t.game.gameDefinition.canvasWidth,t.game.gameDefinition.canvasHeight)}else if(e.levelDefinition.backgroundType==l.default.IMAGE){var o=t.game.getImage(e.levelDefinition.backgroundImage.imageId),n=-t.screenX%64,s=-t.screenY%64;s>0&&(s-=64),n>0&&(n-=64);for(var a=this.calculateSafetyMarginX(t),r=this.calculateSafetyMarginY(t),u=n-=a,c=s-=r;c<t.game.gameDefinition.canvasHeight/t.zoom+64+r;){for(;u<t.game.gameDefinition.canvasWidth/t.zoom+64+a;)t.game.ctx.drawImage(o,u*t.zoom,c*t.zoom,64*t.zoom,64*t.zoom),u+=63;u=n,c+=63}}},e.prototype.calculateSafetyMarginX=function(e){var t=Math.sqrt(e.game.gameDefinition.canvasWidth*e.game.gameDefinition.canvasWidth+e.game.gameDefinition.canvasHeight*e.game.gameDefinition.canvasHeight)/2-e.game.gameDefinition.canvasWidth/2;return t/=e.zoom},e.prototype.calculateSafetyMarginY=function(e){var t=Math.sqrt(e.game.gameDefinition.canvasWidth*e.game.gameDefinition.canvasWidth+e.game.gameDefinition.canvasHeight*e.game.gameDefinition.canvasHeight)/2-e.game.gameDefinition.canvasHeight/2;return t/=e.zoom},e.prototype.drawCustomElements=function(e){for(var t=e.game.ctx,i=0;i<e.customElementsToDraw.length;i++){var o=e.customElementsToDraw[i];if("LINE"==o.type)t.strokeStyle=this.buildFillStyleFromColor(o.color),t.lineWidth=o.lineWidth,t.beginPath(),t.moveTo(o.x1,o.y1),t.lineTo(o.x2,o.y2),t.stroke();else if("RECT"==o.type)t.beginPath(),t.rect(o.x,o.y,o.width,o.height),t.closePath(),"FILL"==o.drawType?(t.fillStyle=this.buildFillStyleFromColor(o.color),t.fill()):"STROKE"==o.drawType?(t.strokeStyle=this.buildFillStyleFromColor(o.borderColor),t.lineWidth=o.borderSize,t.stroke()):"FILL_AND_STROKE"==o.drawType&&(t.fillStyle=this.buildFillStyleFromColor(o.color),t.strokeStyle=this.buildFillStyleFromColor(o.borderColor),t.lineWidth=o.borderSize,t.fill(),t.stroke());else if("CIRCLE"==o.type)t.beginPath(),t.arc(o.x,o.y,o.radius,0,2*Math.PI),t.closePath(),"FILL"==o.drawType?(t.fillStyle=this.buildFillStyleFromColor(o.color),t.fill()):"STROKE"==o.drawType?(t.strokeStyle=this.buildFillStyleFromColor(o.borderColor),t.lineWidth=o.borderSize,t.stroke()):"FILL_AND_STROKE"==o.drawType&&(t.fillStyle=this.buildFillStyleFromColor(o.color),t.strokeStyle=this.buildFillStyleFromColor(o.borderColor),t.lineWidth=o.borderSize,t.fill(),t.stroke());else if("TEXT"==o.type)t.font=o.fontSize+"px "+o.fontFamily,t.fillStyle=this.buildFillStyleFromColor(o.color),t.textAlign=o.textAlign,t.fillText(o.text,o.x,o.y);else if("IMAGE"==o.type){var n=e.game.getImage(o.imageId);t.globalAlpha=o.alpha,this.rotateCanvasAt(-o.rotation,e.game,o.x+o.width/2,o.y+o.height/2),t.drawImage(n,o.x,o.y,o.width,o.height),this.rotateCanvasAt(o.rotation,e.game,o.x+o.width/2,o.y+o.height/2),t.globalAlpha=1}else"PERCENTAGE_BAR"==o.type&&(t.globalAlpha=o.alpha,this.drawPercentageBar(t,o.x,o.y,o.width,o.height,o.value,o.maxValue,o.split,o.borderSize,o.color,o.backgroundColor,o.borderColor),t.globalAlpha=1)}},e.prototype.drawCustomObject=function(e,t,i){var o=t.play.game.getImage(e.image.imageId),n=t.play,s=n.zoom;i.save(),i.globalAlpha=e.alpha,this.rotateCanvasAt(-e.imageAngle,n.game,e.x*s-n.screenX*s,e.y*s-n.screenY*s),e.type.renderType==r.default.IMAGE?i.drawImage(o,e.x*s-n.screenX*s-e.halfWidth*s,e.y*s-n.screenY*s-e.halfHeight*s,2*e.halfWidth*s,2*e.halfHeight*s):e.type.renderType==r.default.CIRCLE?(i.beginPath(),i.ellipse(e.x*s-n.screenX*s,e.y*s-n.screenY*s,e.halfWidth*s,e.halfHeight*s,0,0,2*Math.PI),i.closePath(),e.type.drawType==a.default.FILL?(i.fillStyle=this.buildFillStyleFromColor(e.type.color),i.fill()):e.type.drawType==a.default.STROKE?(i.strokeStyle=this.buildFillStyleFromColor(e.type.borderColor),i.lineWidth=e.type.borderSize,i.stroke()):e.type.drawType==a.default.FILL_AND_STROKE&&(i.fillStyle=this.buildFillStyleFromColor(e.type.color),i.strokeStyle=this.buildFillStyleFromColor(e.type.borderColor),i.lineWidth=e.type.borderSize,i.fill(),i.stroke())):e.type.renderType==r.default.RECTANGLE&&(i.beginPath(),i.rect(e.x*s-n.screenX*s-e.halfWidth*s,e.y*s-n.screenY*s-e.halfHeight*s,2*e.halfWidth*s,2*e.halfHeight*s),i.closePath(),e.type.drawType==a.default.FILL?(i.fillStyle=this.buildFillStyleFromColor(e.type.color),i.fill()):e.type.drawType==a.default.STROKE?(i.strokeStyle=this.buildFillStyleFromColor(e.type.borderColor),i.lineWidth=e.type.borderSize,i.stroke()):e.type.drawType==a.default.FILL_AND_STROKE&&(i.fillStyle=this.buildFillStyleFromColor(e.type.color),i.strokeStyle=this.buildFillStyleFromColor(e.type.borderColor),i.lineWidth=e.type.borderSize,i.fill(),i.stroke())),this.rotateCanvasAt(e.imageAngle,n.game,e.x*s-n.screenX*s,e.y*s-n.screenY*s),i.restore()},e.prototype.drawButton=function(e,t){e.fillStyle=this.buildFillStyleFromColor(t.backgroundColor),e.strokeStyle=this.buildFillStyleFromColor(t.borderColor),e.lineWidth=t.borderSize;var i=t.borderRadius,o=t.fontSize+"px Arial",n=this.buildFillStyleFromColor(t.textColor);this.renderUtil.drawRoundRect(e,t.x-t.width/2,t.y-t.height/2,t.width,t.height,i,!0,!0),this.util.drawText(e,t.text,t.x,t.y+1,o,n,"center","middle")},e}();t.default=c},function(e,t,i){"use strict";t.__esModule=!0;var o=i(33),n=i(18),s=i(34),a=i(36),r=i(19),l=i(0),u=i(20),c=i(21),d=function(){function e(e){this.gameOver=!1,this.paused=!1,this.mousePos=null,this.lastTouchX=0,this.lastTouchY=0,this.accelerometer={x:0,y:0,z:0},this.isLeftMouseButtonDown=!1,this.util=new l.default,this.zoom=1,this.globalVariables=new Map,this.objectTypesMap=new Map,this.eventHandler=null,this.keyDownCodes=new Array,this.keyUpCodes=new Array,this.isKeyDownCodes=new Map,this.mouseDownList=new Array,this.mouseUpList=new Array,this.customElementsToDraw=new Array,this.touchStartList=new Array,this.touchMoveList=new Array,this.touchEndList=new Array,this.game=e,this.screenX=0,this.screenY=0,this.score=0,this.gameOver=!1,this.mousePos=null;new l.default;this.eventHandler=new o.default,this.eventHandler.initObjectVariablesRegexp(this);var t=this.game.gameDefinition.globalVariables;if(null!=t)for(var i=0;i<t.length;i++)this.globalVariables.set(t[i].name,t[i].initialValue);var n=this.game.gameDefinition.customObjectTypes;for(i=0;i<n.length;i++)this.objectTypesMap.set(n[i].uid,n[i]);this.currentLevelIndex=0;var r=e.gameDefinition.levels[this.currentLevelIndex];this.level=new s.default(this,r),this.levelBuilder=new a.default(this.level)}return e.prototype.setGlobalVariable=function(e,t){this.globalVariables.set(e,t)},e.prototype.addToGlobalVariable=function(e,t){var i=this.globalVariables.get(e);this.globalVariables.set(e,i+t)},e.prototype.clearCustomElementsToDraw=function(){this.customElementsToDraw=new Array},e.prototype.goToLevelIndex=function(e){this.currentLevelIndex=e,this.screenX=0,this.screenY=0;var t=this.game.gameDefinition.levels[this.currentLevelIndex];this.level=new s.default(this,t)},e.prototype.goToLevel=function(e){for(var t=0;t<this.game.gameDefinition.levels.length;t++){this.game.gameDefinition.levels[t].uid==e.uid&&(this.currentLevelIndex=t)}this.screenX=0,this.screenY=0,this.level=new s.default(this,e)},e.prototype.goToLevelUid=function(e){var t=this.findLevelByUid(e);this.goToLevel(t)},e.prototype.findLevelByUid=function(e){for(var t=0;t<this.game.gameDefinition.levels.length;t++){var i=this.game.gameDefinition.levels[t];if(i.uid==e)return i}},e.prototype.goToNextLevel=function(){this.goToLevelIndex(this.currentLevelIndex+1)},e.prototype.goToPreviousLevel=function(){this.goToLevelIndex(this.currentLevelIndex-1)},e.prototype.update=function(){this.util;if(this.level.update(),this.updateLevel(),1==this.level.levelDefinition.centerCameraAtObject)for(var e=this.level.customObjectArray,t=0;t<e.length;t++){var i=e[t];i.type.id==this.level.levelDefinition.centerCameraAtObjectTypeId&&(this.setCameraCenterX(i.x),this.setCameraCenterY(i.y))}this.game.processEvents(this),this.keyUpCodes=new Array,this.keyDownCodes=new Array,this.mouseDownList=new Array,this.mouseUpList=new Array,this.touchStartList=new Array,this.touchMoveList=new Array,this.touchEndList=new Array,this.level.currentFrame++},e.prototype.setCameraCenterX=function(e){this.screenX=e-this.game.gameDefinition.canvasWidth/2/this.zoom},e.prototype.setCameraCenterY=function(e){this.screenY=e-this.game.gameDefinition.canvasHeight/2/this.zoom},e.prototype.muliplyZoom=function(e){this.setZoom(this.zoom*e)},e.prototype.setZoom=function(e){var t=this.game.gameDefinition.canvasWidth/this.zoom,i=this.game.gameDefinition.canvasWidth/e-t,o=this.game.gameDefinition.canvasHeight/this.zoom,n=this.game.gameDefinition.canvasHeight/e-o;this.zoom=e,this.screenX-=i/2,this.screenY-=n/2},e.prototype.updateLevel=function(){this.game,this.util},e.prototype.registerKeyDown=function(e){this.keyDownCodes.push(e),this.isKeyDownCodes.set(e,!0)},e.prototype.registerKeyUp=function(e){this.keyUpCodes.push(e),this.isKeyDownCodes.set(e,!1)},e.prototype.isKeyDown=function(e){var t=this.isKeyDownCodes.get(e);return null!=t&&t},e.prototype.onKeyDown=function(e){for(var t=0;t<this.keyDownCodes.length;t++)if(this.keyDownCodes[t]==e)return!0;return!1},e.prototype.onKeyUp=function(e){for(var t=0;t<this.keyUpCodes.length;t++)if(this.keyUpCodes[t]==e)return!0;return!1},e.prototype.checkEveryXSeconds=function(e,t){var i=this.eventHandler.secondsCounterMap.get(e);return null==i&&(i=new r.default(t,this.level.currentFrame,Date.now()),this.eventHandler.secondsCounterMap.set(e,i)),i.evaluateCondition(this.level.currentFrame,Date.now())},e.prototype.checkEveryXFrames=function(e,t){var i=this.eventHandler.frameCounterMap.get(e);return null==i&&(i=new n.default(t,this.level.currentFrame),this.eventHandler.frameCounterMap.set(e,i)),i.evaluateCondition(this.level.currentFrame)},e.prototype.buildImageObject=function(e,t){var i=new u.default;if(i.imageId=t,"UPLOAD"==e)i.imageSourceType=c.default.UPLOAD;else if("LIBRARY"==e){i.imageSourceType=c.default.LIBRARY;var o=t.substring(7);i.customImage=this.util.findElementByUid(this.game.gameDefinition.customImages,o)}return i},e}();t.default=d},function(e,t,i){"use strict";t.__esModule=!0;var o=i(1),n=i(15),s=i(18),a=i(19),r=i(0),l=i(2),u=i(6),c=i(10),d=function(){function e(){this.expressionEvaluator=new n.default,this.frameCounterMap=new Map,this.secondsCounterMap=new Map,this.util=new r.default,this.dynamicSourceCode=!0}return e.prototype.initObjectVariablesRegexp=function(e){this.expressionEvaluator.initObjectVariablesRegexp(e)},e.prototype.evaluateConditions=function(e,t,i){for(var o=0;o<e.length;o++)if(!this.evaluateCondition(e[o],t,i))return!1;return!0},e.prototype.evaluateColorExpression=function(e,t,i){var n=null;if(null!=e&&null!=e.red){var s=this.expressionEvaluator.evaluateExpression(""+e.red,t,i),a=this.expressionEvaluator.evaluateExpression(""+e.green,t,i),r=this.expressionEvaluator.evaluateExpression(""+e.blue,t,i);n=new o.default(s,a,r)}return n},e.prototype.evaluateCondition=function(e,t,i){if(e.type==u.default.COLLISION){if(this.listCollisions(e,t,i).length>0)return!0}else if(e.type==u.default.KEYDOWN){for(var o=0;o<t.keyDownCodes.length;o++)if(t.keyDownCodes[o]==e.keyCode)return!0}else if(e.type==u.default.REPEAT_WHILE_KEY_IS_DOWN){if(t.isKeyDown(e.keyCode))return!0}else if(e.type==u.default.KEYUP){for(o=0;o<t.keyUpCodes.length;o++)if(t.keyUpCodes[o]==e.keyCode)return!0}else{if(e.type==u.default.MOUSEDOWN)return t.mouseDownList.length>0;if(e.type==u.default.MOUSEUP)return t.mouseUpList.length>0;if(e.type==u.default.REPEAT_WHILE_MOUSE_IS_DOWN)return t.isLeftMouseButtonDown;if(e.type==u.default.ALWAYS)return!0;if(e.type==u.default.EXPRESSION)return this.expressionEvaluator.evaluateExpression(e.expression,t,i);if(e.type==u.default.ON_LEVEL_START)return 0==t.level.currentFrame;if(e.type==u.default.ON_BUTTON_CLICK){if(t.mouseDownList.length>0)for(var n=0;n<t.level.buttonArray.length;n++){if((l=t.level.buttonArray[n]).uid==e.button.uid)return l.isInsideButton(t.mousePos.x,t.mousePos.y)}}else if(e.type==u.default.MOUSE_OVER_BUTTON)for(var r=0;r<t.level.buttonArray.length;r++){var l;if((l=t.level.buttonArray[r]).uid==e.button.uid)if(null!=t.mousePos)return l.isInsideButton(t.mousePos.x,t.mousePos.y)}else{if(e.type==u.default.MOUSE_OVER_OBJECT){if(null==t.mousePos)return!1;for(var d=this.getObjectsByObjectSelector(e.objectSelectorDefinition,t,i),h=0;h<d.length;h++){var p=d[h];if(this.util.isInsideObject(t.mousePos.x,t.mousePos.y,p))return!0}return!1}if(e.type==u.default.CLICK_ON_OBJECT){if(!(t.mouseDownList.length>0))return!1;if(null==t.mousePos)return!1;d=this.getObjectsByObjectSelector(e.objectSelectorDefinition,t,i);for(var E=0;E<d.length;E++){p=d[E];if(this.util.isInsideObject(t.mousePos.x,t.mousePos.y,p))return!0}return!1}var f;if(e.type==u.default.EVERY_X_FRAMES)return null==(f=this.frameCounterMap.get(e.uid))&&(f=new s.default(e.frames,t.level.currentFrame),this.frameCounterMap.set(e.uid,f)),f.evaluateCondition(t.level.currentFrame);if(e.type==u.default.EVERY_X_SECONDS)return null==(f=this.secondsCounterMap.get(e.uid))&&(f=new a.default(e.seconds,t.level.currentFrame,Date.now()),this.secondsCounterMap.set(e.uid,f)),f.evaluateCondition(t.level.currentFrame,Date.now());if(e.type==u.default.DISTANCE_BETWEEN){var v=this.expressionEvaluator.evaluateExpression(e.x1,t,i),m=this.expressionEvaluator.evaluateExpression(e.y1,t,i),y=this.expressionEvaluator.evaluateExpression(e.x2,t,i),g=this.expressionEvaluator.evaluateExpression(e.y2,t,i),b=this.expressionEvaluator.evaluateExpression(e.distance,t,i),O=this.util.distance(v,m,y,g);if(e.relation==c.default.EQUAL)return O==b;if(e.relation==c.default.GREATER)return O>b;if(e.relation==c.default.SMALLER)return O<b;if(e.relation==c.default.GREATER_OR_EQUAL)return O>=b;if(e.relation==c.default.SMALLER_OR_EQUAL)return O<=b;if(e.relation==c.default.DIFFERENT)return O!=b}}}return!1},e.prototype.listCollisions=function(e,t,i){for(var o=this.getObjectsByObjectSelector(e.object1,t,i),n=this.getObjectsByObjectSelector(e.object2,t,i),s=[],a=0;a<o.length;a++)for(var r=0;r<n.length;r++)this.util.testCollision(o[a],n[r])&&(s.push(o[a]),s.push(n[r]));return s},e.prototype.getObjectsByObjectSelector=function(e,t,i){var o=new Array;if(e.type==l.default.ALL_OBJECTS)o=t.level.customObjectArray;else if(e.type==l.default.LOOP_OBJECT){var n=e.loopVariableName;o.push(i.variables.get(n))}else if(e.type==l.default.ALL_OBJECTS_OF_TYPE)for(var s=0;s<t.level.customObjectArray.length;s++)t.level.customObjectArray[s].type.uid==e.objectType.uid&&o.push(t.level.customObjectArray[s]);return o},e.prototype.getObjectsFromType=function(e,t,i){var o=[],n=e.split(":");if(1==n.length)"customObject"==e&&(o=t.level.customObjectArray);else if(2==n.length){if("loopObject"==n[0]){var s=n[1];o.push(i.variables.get(s))}}else if(3==n.length&&"customObject"==n[0]&&"typeId"==n[1])for(var a=0;a<t.level.customObjectArray.length;a++)t.level.customObjectArray[a].type.id==n[2]&&o.push(t.level.customObjectArray[a]);return o},e}();t.default=d},function(e,t,i){"use strict";t.__esModule=!0;var o=i(35),n=i(7),s=i(0),a=function(){function e(e,t){this.variables=new Map,this.canvasAngle=0,this.currentFrame=0,this.fps=0,this.fpsFrames=0,this.fpsLastTime=performance.now(),this.play=e,this.levelDefinition=t,this.customObjectArray=[],this.buttonArray=[];var i=this.levelDefinition.levelVariables;if(null!=i)for(var o=0;o<i.length;o++)this.variables.set(i[o].name,i[o].initialValue);this.variables.set("testeArray",[111,222,333,444,555]),this.util=new s.default,this.initialize()}return e.prototype.initialize=function(){var e=this.levelDefinition.initialObjects;if(null!=e)for(var t=0;t<e.length;t++){var i=e[t],n=i.repeatTimes;null!=n&&0!=n||(n=1);var s=i.repeatTimes2;null!=s&&0!=s||(s=1);for(var a=0;a<n;a++)for(var r=0;r<s;r++)this.addCustomObject(i.objectType,i.x+a*this.util.zeroIfNull(i.dx)+r*this.util.zeroIfNull(i.dx2),i.y+a*this.util.zeroIfNull(i.dy)+r*this.util.zeroIfNull(i.dy2))}for(t=0;t<this.levelDefinition.buttons.length;t++){var l=this.levelDefinition.buttons[t],u=new o.default;u.definition=l,u.uid=l.uid,u.x=l.x,u.y=l.y,u.width=l.width,u.height=l.height,u.borderSize=l.borderSize,u.borderRadius=l.borderRadius,u.fontSize=l.fontSize,u.text=l.text,u.name=l.name,u.backgroundColor=l.backgroundColor,u.borderColor=l.borderColor,u.textColor=l.textColor,this.buttonArray.push(u)}},e.prototype.getVariable=function(e){var t=this.variables.get(e);return null==t?(this.variables.set(e,0),0):t},e.prototype.setVariable=function(e,t){this.variables.set(e,t)},e.prototype.addToVariable=function(e,t){var i=this.variables.get(e);null==i?this.variables.set(e,t):this.variables.set(e,i+t)},e.prototype.addCustomObject=function(e,t,i){var o=new n.default(t,i,this,e);return this.customObjectArray.push(o),o},e.prototype.update=function(){this.updateCustomObjects(),this.updateButtons(),this.updateFps()},e.prototype.updateFps=function(){this.fpsFrames++;var e=performance.now(),t=e-this.fpsLastTime;t>100&&(this.fps=1e3*this.fpsFrames/t,this.fpsFrames=0,this.fpsLastTime=e)},e.prototype.updateButtons=function(){for(var e=0;e<this.buttonArray.length;e++){var t=this.buttonArray[e];null!=this.play.mousePos&&t.isInsideButton(this.play.mousePos.x,this.play.mousePos.y)?(t.backgroundColor=t.definition.backgroundColorMouseOver,t.borderColor=t.definition.borderColorMouseOver,t.borderSize=t.definition.borderSizeMouseOver):(t.backgroundColor=t.definition.backgroundColor,t.borderColor=t.definition.borderColor,t.borderSize=t.definition.borderSize)}},e.prototype.updateCustomObjects=function(){for(var e=0;e<this.customObjectArray.length;e++)this.customObjectArray[e].update();if(0!=this.levelDefinition.electricConstant)for(var t=0;t<this.customObjectArray.length;t++)for(var i=0;i<this.customObjectArray.length;i++){var o=this.customObjectArray[t],n=this.customObjectArray[i];if(null!=o.electricCharge&&null!=n.electricCharge){var s=n.x-o.x,a=n.y-o.y;if((E=Math.sqrt(Math.pow(s,2)+Math.pow(a,2)))>10){var r=this.levelDefinition.electricConstant,l=o.electricCharge,u=n.electricCharge,c=-1*r*l*u*s/Math.pow(E,3),d=-1*r*l*u*a/Math.pow(E,3);o.speedX+=c/o.mass,o.speedY+=d/o.mass}}}if(this.levelDefinition.applyGravitationalForceBetweenObjects&&0!=this.levelDefinition.gravitationalConstant)for(var h=this.levelDefinition.gravitationalConstant,p=0;p<this.customObjectArray.length;p++)for(i=0;i<this.customObjectArray.length;i++){o=this.customObjectArray[p],n=this.customObjectArray[i];if(0!=o.mass&&0!=n.mass){var E;s=n.x-o.x,a=n.y-o.y;if((E=Math.sqrt(Math.pow(s,2)+Math.pow(a,2)))>3){c=h*o.mass*n.mass*s/Math.pow(E,3),d=h*o.mass*n.mass*a/Math.pow(E,3);o.speedX+=c/o.mass,o.speedY+=d/o.mass}}}this.removeObjectsMarkedToRemove()},e.prototype.removeObjectsMarkedToRemove=function(){for(var e=this.customObjectArray.length-1;e>=0;e--)this.customObjectArray[e].markedToRemove&&this.customObjectArray.splice(e,1)},e}();t.default=a},function(e,t,i){"use strict";t.__esModule=!0;var o=function(){function e(){}return e.prototype.isInsideButton=function(e,t){return null!=e&&(null!=t&&(!(e<this.x-this.width/2)&&(!(e>this.x+this.width/2)&&(!(t<this.y-this.height/2)&&!(t>this.y+this.height/2)))))},e}();t.default=o},function(e,t,i){"use strict";t.__esModule=!0;var o=i(0),n=function(e){this.level=e,this.x=400,this.util=new o.default};t.default=n},function(e,t,i){"use strict";t.__esModule=!0;var o=function(e,t,i,o){void 0===o&&(o="100"),this.red=e,this.green=t,this.blue=i,this.alpha=o};t.default=o},function(e,t,i){"use strict";t.__esModule=!0;var o=i(16),n=i(22),s=i(5),a=i(6),r=i(23),l=i(9),u=i(3),c=function(){function e(){}return e.prototype.getKeyboardKeys=function(){return[{code:"ArrowUp",name:"ArrowUp"},{code:"ArrowDown",name:"ArrowDown"},{code:"ArrowLeft",name:"ArrowLeft"},{code:"ArrowRight",name:"ArrowRight"},{code:"Space",name:"Space"},{code:"Enter",name:"Enter"},{code:"ShiftLeft",name:"ShiftLeft"},{code:"ShiftRight",name:"ShiftRight"},{code:"ControlLeft",name:"ControlLeft"},{code:"ControlRight",name:"ControlRight"},{code:"Escape",name:"Escape"},{code:"Backspace",name:"Backspace"},{code:"AltLeft",name:"AltLeft"},{code:"AltRight",name:"AltRight"},{code:"CapsLock",name:"CapsLock"},{code:"Tab",name:"Tab"},{code:"Insert",name:"Insert"},{code:"Delete",name:"Delete"},{code:"Home",name:"Home"},{code:"End",name:"End"},{code:"PageUp",name:"PageUp"},{code:"PageDown",name:"PageDown"},{code:"Digit1",name:"Digit1"},{code:"Digit2",name:"Digit2"},{code:"Digit3",name:"Digit3"},{code:"Digit4",name:"Digit4"},{code:"Digit5",name:"Digit5"},{code:"Digit6",name:"Digit6"},{code:"Digit7",name:"Digit7"},{code:"Digit8",name:"Digit8"},{code:"Digit9",name:"Digit9"},{code:"Digit0",name:"Digit0"},{code:"Numpad1",name:"Numpad1"},{code:"Numpad2",name:"Numpad2"},{code:"Numpad3",name:"Numpad3"},{code:"Numpad4",name:"Numpad4"},{code:"Numpad5",name:"Numpad5"},{code:"Numpad6",name:"Numpad6"},{code:"Numpad7",name:"Numpad7"},{code:"Numpad8",name:"Numpad8"},{code:"Numpad9",name:"Numpad9"},{code:"Numpad0",name:"Numpad0"},{code:"NumLock",name:"NumLock"},{code:"NumpadDivide",name:"NumpadDivide"},{code:"NumpadMultiply",name:"NumpadMultiply"},{code:"NumpadSubtract",name:"NumpadSubtract"},{code:"NumpadAdd",name:"NumpadAdd"},{code:"NumpadEnter",name:"NumpadEnter"},{code:"NumpadDecimal",name:"NumpadDecimal"},{code:"KeyA",name:"KeyA"},{code:"KeyB",name:"KeyB"},{code:"KeyC",name:"KeyC"},{code:"KeyD",name:"KeyD"},{code:"KeyE",name:"KeyE"},{code:"KeyF",name:"KeyF"},{code:"KeyG",name:"KeyG"},{code:"KeyH",name:"KeyH"},{code:"KeyI",name:"KeyI"},{code:"KeyJ",name:"KeyJ"},{code:"KeyK",name:"KeyK"},{code:"KeyL",name:"KeyL"},{code:"KeyM",name:"KeyM"},{code:"KeyN",name:"KeyN"},{code:"KeyO",name:"KeyO"},{code:"KeyP",name:"KeyP"},{code:"KeyQ",name:"KeyQ"},{code:"KeyR",name:"KeyR"},{code:"KeyS",name:"KeyS"},{code:"KeyT",name:"KeyT"},{code:"KeyU",name:"KeyU"},{code:"KeyV",name:"KeyV"},{code:"KeyW",name:"KeyW"},{code:"KeyX",name:"KeyX"},{code:"KeyY",name:"KeyY"},{code:"KeyZ",name:"KeyZ"},{code:"F1",name:"F1"},{code:"F2",name:"F2"},{code:"F3",name:"F3"},{code:"F4",name:"F4"},{code:"F5",name:"F5"},{code:"F6",name:"F6"},{code:"F7",name:"F7"},{code:"F8",name:"F8"},{code:"F9",name:"F9"},{code:"F10",name:"F10"},{code:"F11",name:"F11"},{code:"F12",name:"F12"},{code:"IntlBackslash",name:"IntlBackslash"},{code:"OSLeft",name:"OSLeft"},{code:"Minus",name:"Minus"},{code:"Equal",name:"Equal"},{code:"Backquote",name:"Backquote"},{code:"BracketLeft",name:"BracketLeft"},{code:"BracketRight",name:"BracketRight"},{code:"Semicolon",name:"Semicolon"},{code:"Quote",name:"Quote"},{code:"Backslash",name:"Backslash"},{code:"Comma",name:"Comma"},{code:"Period",name:"Period"},{code:"Slash",name:"Slash"}]},e.prototype.getEventActionCategories=function(){return[{code:n.default.ALL},{code:n.default.OBJECT},{code:n.default.LEVEL},{code:n.default.GAME},{code:n.default.STORAGE},{code:n.default.BUTTON},{code:n.default.DRAWING},{code:n.default.OTHERS}]},e.prototype.getEventActionTypesByCategory=function(e){var t=this.getEventActionTypes();if(e==n.default.ALL)return t;for(var i=new Array,o=0;o<t.length;o++)t[o].category==e&&i.push(t[o]);return i},e.prototype.getEventActionTypes=function(){return[{code:"GO_TO_NEXT_LEVEL",category:n.default.LEVEL},{code:"GO_TO_PREVIOUS_LEVEL",category:n.default.LEVEL},{code:"GO_TO_LEVEL",category:n.default.LEVEL},{code:"GAME_OVER",category:n.default.GAME},{code:"CREATE_CUSTOM_OBJECT",category:n.default.OBJECT},{code:"ADD_TO_SCORE",category:n.default.GAME},{code:"SET_SCORE",category:n.default.GAME},{code:"ADD_TO_CUSTOM_OBJECT_ATTRIBUTE",category:n.default.OBJECT},{code:"SET_CUSTOM_OBJECT_ATTRIBUTE",category:n.default.OBJECT},{code:"SET_CUSTOM_OBJECT_SPEED_AND_ANGLE",category:n.default.OBJECT},{code:s.default.SET_OBJECT_SPEED_AND_TARGET,category:n.default.OBJECT},{code:s.default.APPLY_FORCE_TO_OBJECT,category:n.default.OBJECT},{code:s.default.SET_OBJECT_IMAGE_ANGLE,category:n.default.OBJECT},{code:s.default.SET_OBJECT_IMAGE,category:n.default.OBJECT},{code:"SET_BUTTON_ATTRIBUTE",category:n.default.BUTTON},{code:"SET_OBJECT_VARIABLE",category:n.default.OBJECT},{code:"ADD_TO_LEVEL_VARIABLE",category:n.default.LEVEL},{code:"SET_LEVEL_VARIABLE",category:n.default.LEVEL},{code:s.default.SET_GLOBAL_VARIABLE,category:n.default.GAME},{code:s.default.ADD_TO_GLOBAL_VARIABLE,category:n.default.GAME},{code:"REMOVE_OBJECT",category:n.default.OBJECT},{code:"CONSOLE_LOG",category:n.default.OTHERS},{code:"SET_CAMERA_CENTER_X",category:n.default.LEVEL},{code:"SET_CAMERA_CENTER_Y",category:n.default.LEVEL},{code:"SHOOT_OBJECT",category:n.default.OBJECT},{code:"SET_ZOOM",category:n.default.LEVEL},{code:"MULTIPLY_ZOOM",category:n.default.LEVEL},{code:"SET_CANVAS_ANGLE",category:n.default.LEVEL},{code:s.default.SET_LOCAL_STORAGE_VARIABLE,category:n.default.STORAGE},{code:s.default.REQUEST_FULLSCREEN,category:n.default.GAME},{code:s.default.DRAW_LINE,category:n.default.DRAWING},{code:s.default.DRAW_CIRCLE,category:n.default.DRAWING},{code:s.default.DRAW_RECT,category:n.default.DRAWING},{code:s.default.DRAW_IMAGE,category:n.default.DRAWING},{code:s.default.DRAW_TEXT,category:n.default.DRAWING},{code:s.default.DRAW_PERCENTAGE_BAR,category:n.default.DRAWING}]},e.prototype.getEventConditionTypes=function(){return[{code:"COLLISION"},{code:"KEYDOWN"},{code:"KEYUP"},{code:"REPEAT_WHILE_KEY_IS_DOWN"},{code:a.default.REPEAT_WHILE_MOUSE_IS_DOWN},{code:"MOUSEDOWN"},{code:"MOUSEUP"},{code:"ALWAYS"},{code:"EVERY_X_FRAMES"},{code:"EVERY_X_SECONDS"},{code:"DISTANCE_BETWEEN"},{code:"ON_LEVEL_START"},{code:"ON_BUTTON_CLICK"},{code:"MOUSE_OVER_BUTTON"},{code:"MOUSE_OVER_OBJECT"},{code:"CLICK_ON_OBJECT"},{code:a.default.ON_TOUCH_START},{code:a.default.ON_TOUCH_MOVE},{code:a.default.ON_TOUCH_END},{code:a.default.TOUCH_ON_BUTTON},{code:a.default.TOUCH_ON_OBJECT},{code:"EXPRESSION"}]},e.prototype.getLoopTypes=function(){return[{code:l.default.OBJECT,name:"Object"},{code:l.default.NUMBER,name:"Number"}]},e.prototype.getRenderTypes=function(){return[{code:u.default.IMAGE,name:"IMAGE"},{code:u.default.CIRCLE,name:"CIRCLE"},{code:u.default.RECTANGLE,name:"RECTANGLE"}]},e.prototype.getDrawTypes=function(){return[{code:o.default.FILL,name:"FILL"},{code:o.default.STROKE,name:"STROKE"},{code:o.default.FILL_AND_STROKE,name:"FILL_AND_STROKE"}]},e.prototype.getExpressionTypes=function(){return[{code:r.default.SCORE,name:"SCORE"},{code:r.default.RANDOM,name:"RANDOM"},{code:r.default.MOUSE_POS_X,name:"MOUSE_POS_X"},{code:r.default.MOUSE_POS_Y,name:"MOUSE_POS_Y"},{code:r.default.SCREEN_X,name:"SCREEN_X"},{code:r.default.SCREEN_Y,name:"SCREEN_Y"},{code:r.default.CURRENT_LOOP_INDEX,name:"CURRENT_LOOP_INDEX"},{code:r.default.GLOBAL_VARIABLE,name:"GLOBAL_VARIABLE"},{code:r.default.LEVEL_VARIABLE,name:"LEVEL_VARIABLE"},{code:r.default.ARRAY_LEVEL_VARIABLE,name:"ARRAY_LEVEL_VARIABLE"},{code:r.default.LOOP_OBJECT_ATTRIBUTE,name:"LOOP_OBJECT_ATTRIBUTE"},{code:r.default.LOOP_OBJECT_VARIABLE,name:"LOOP_OBJECT_VARIABLE"},{code:r.default.LOOP_NUMBER,name:"LOOP_NUMBER"},{code:r.default.LEVEL_NAME,name:"LEVEL_NAME"},{code:r.default.CURRENT_LEVEL_FRAME,name:"CURRENT_LEVEL_FRAME"},{code:r.default.DISTANCE_BETWEEN_LOOP_OBJECTS,name:"DISTANCE_BETWEEN_LOOP_OBJECTS"},{code:r.default.LOCAL_STORAGE_VARIABLE,name:"LOCAL_STORAGE_VARIABLE"},{code:r.default.FPS,name:"FPS"},{code:r.default.LAST_TOUCH_X,name:"LAST_TOUCH_X"},{code:r.default.LAST_TOUCH_Y,name:"LAST_TOUCH_Y"},{code:r.default.ACCELEROMETER_X,name:"ACCELEROMETER_X"},{code:r.default.ACCELEROMETER_Y,name:"ACCELEROMETER_Y"},{code:r.default.ACCELEROMETER_Z,name:"ACCELEROMETER_Z"}]},e}();t.default=c},function(e,t,i){"use strict";t.__esModule=!0;var o=function(){};t.default=o},function(e,t,i){"use strict";t.__esModule=!0;var o=function(){};t.default=o},function(e,t,i){"use strict";t.__esModule=!0;var o=function(){};t.default=o},function(e,t,i){"use strict";t.__esModule=!0;var o=function(){};t.default=o},function(e,t,i){"use strict";t.__esModule=!0;var o=function(){};t.default=o},function(e,t,i){"use strict";t.__esModule=!0;var o=function(){};t.default=o},function(e,t,i){"use strict";t.__esModule=!0;var o=function(){};t.default=o},function(e,t,i){"use strict";t.__esModule=!0;var o=function(){};t.default=o},function(e,t,i){"use strict";t.__esModule=!0;var o=function(){};t.default=o},function(e,t,i){"use strict";t.__esModule=!0;var o=i(49),n=i(25),s=i(26),a=i(0),r=i(51),l=i(1),u=i(24),c=function(){function e(e,t){this.vm=null,this.resourcesBaseUrl=null,this.util=new a.default,this.previewCanvas=document.getElementById("previewCanvas"),this.ctxPreview=null,this.levelPreviewRenderer=null,this.currentPreviewCanvasDragObject=null,this.currentPreviewCanvasDragText=null,this.currentPreviewCanvasDragButton=null,this.selectedObject=null,this.selectedText=null,this.selectedButton=null,this.dragOffsetX=0,this.dragOffsetY=0,this.lastDragX=0,this.lastDragY=0,this.draggingBackground=!1,this.previewCanvasMouseX=0,this.previewCanvasMouseY=0,this.gridConfig=new r.default,this.newGridConfig=null,this.vm=e,this.resourcesBaseUrl=t,this.levelPreviewRenderer=new o.default(t,e),null!=this.previewCanvas&&(this.ctxPreview=this.previewCanvas.getContext("2d"))}return e.prototype.deselectElements=function(){this.selectedObject=null,this.selectedText=null,this.selectedButton=null},e.prototype.editGridConfig=function(){this.newGridConfig=new r.default,this.newGridConfig.gridWidth=this.gridConfig.gridWidth,this.newGridConfig.gridHeight=this.gridConfig.gridHeight,this.newGridConfig.gridOriginX=this.gridConfig.gridOriginX,this.newGridConfig.gridOriginY=this.gridConfig.gridOriginY,this.newGridConfig.drawGrid=this.gridConfig.drawGrid,this.newGridConfig.snapToGrid=this.gridConfig.snapToGrid},e.prototype.updateGridConfig=function(){this.gridConfig=new r.default,this.gridConfig.gridWidth=Math.max(2,Number(this.newGridConfig.gridWidth)),this.gridConfig.gridHeight=Math.max(2,Number(this.newGridConfig.gridHeight)),this.gridConfig.gridOriginX=Number(this.newGridConfig.gridOriginX),this.gridConfig.gridOriginY=Number(this.newGridConfig.gridOriginY),this.gridConfig.drawGrid=this.newGridConfig.drawGrid,this.gridConfig.snapToGrid=this.newGridConfig.snapToGrid},e.prototype.updatePreviewCanvas=function(e,t){this.levelPreviewRenderer.currentMousePos=t},e.prototype.previewCanvasMouseMove=function(e){var t=this.vm.gameParamsJson,i=t.canvasWidth,o=t.canvasHeight,n=this.util.getMousePos(this.previewCanvas,e,i,o);if(null!=this.currentPreviewCanvasDragObject){var s=n.x-this.dragOffsetX,a=n.y-this.dragOffsetY;this.gridConfig.snapToGrid&&(s=this.util.snapToGrid(s,this.gridConfig.gridWidth,this.gridConfig.gridOriginX),a=this.util.snapToGrid(a,this.gridConfig.gridHeight,this.gridConfig.gridOriginY)),this.currentPreviewCanvasDragObject.x=s,this.currentPreviewCanvasDragObject.y=a}if(null!=this.currentPreviewCanvasDragText){s=n.x-this.dragOffsetX,a=n.y-this.dragOffsetY;this.gridConfig.snapToGrid&&(s=this.util.snapToGrid(s,this.gridConfig.gridWidth,this.gridConfig.gridOriginX),a=this.util.snapToGrid(a,this.gridConfig.gridHeight,this.gridConfig.gridOriginY)),this.currentPreviewCanvasDragText.x=s,this.currentPreviewCanvasDragText.y=a}if(null!=this.currentPreviewCanvasDragButton){s=n.x-this.dragOffsetX,a=n.y-this.dragOffsetY;this.gridConfig.snapToGrid&&(s=this.util.snapToGrid(s,this.gridConfig.gridWidth,this.gridConfig.gridOriginX),a=this.util.snapToGrid(a,this.gridConfig.gridHeight,this.gridConfig.gridOriginY)),this.currentPreviewCanvasDragButton.x=s,this.currentPreviewCanvasDragButton.y=a}this.draggingBackground&&(this.levelPreviewRenderer.offsetX+=n.x-this.lastDragX,this.levelPreviewRenderer.offsetY+=n.y-this.lastDragY,this.lastDragX=n.x,this.lastDragY=n.y),this.updatePreviewCanvas(e,n),this.previewCanvasMouseX=Math.floor(n.x-this.levelPreviewRenderer.offsetX),this.previewCanvasMouseY=Math.floor(n.y-this.levelPreviewRenderer.offsetY)},e.prototype.previewCanvasMouseUp=function(e){this.currentPreviewCanvasDragObject=null,this.currentPreviewCanvasDragText=null,this.currentPreviewCanvasDragButton=null,this.draggingBackground=!1},e.prototype.previewCanvasMouseDown=function(e){this.selectedObject=null,this.selectedText=null,this.selectedButton=null;for(var t=this.vm.gameParamsJson,i=t.canvasWidth,o=t.canvasHeight,n=this.util.getMousePos(this.previewCanvas,e,i,o),s=this.vm.gameParamsJson.levels[this.vm.currentLevelIndex],a=0;a<s.initialObjects.length;a++){var r=s.initialObjects[a];this.util.isInsideInitialObject(r,n.x-this.levelPreviewRenderer.offsetX,n.y-this.levelPreviewRenderer.offsetY)&&(this.currentPreviewCanvasDragObject=r,this.selectedObject=r,this.dragOffsetX=n.x-r.x,this.dragOffsetY=n.y-r.y)}for(a=0;a<s.texts.length;a++){var l=s.texts[a];this.util.isInside(n.x-this.levelPreviewRenderer.offsetX,n.y-this.levelPreviewRenderer.offsetY,this.util.getTextLeftX(l,this.ctxPreview),l.y-l.fontSize/2,this.util.measureText(l,this.ctxPreview),l.fontSize)&&(this.currentPreviewCanvasDragText=l,this.selectedText=l,this.currentPreviewCanvasDragObject=null,this.selectedObject=null,this.dragOffsetX=n.x-l.x,this.dragOffsetY=n.y-l.y)}for(a=0;a<s.buttons.length;a++){var u=s.buttons[a],c=u.x-u.width/2,d=u.y-u.height/2,h=u.width,p=u.height;this.util.isInside(n.x-this.levelPreviewRenderer.offsetX,n.y-this.levelPreviewRenderer.offsetY,c,d,h,p)&&(this.currentPreviewCanvasDragButton=u,this.selectedButton=u,this.dragOffsetX=n.x-u.x,this.dragOffsetY=n.y-u.y)}null==this.currentPreviewCanvasDragObject&&null==this.currentPreviewCanvasDragText&&null==this.currentPreviewCanvasDragButton&&(this.draggingBackground=!0,this.lastDragX=n.x,this.lastDragY=n.y)},e.prototype.editSelectedElement=function(){null!=this.selectedObject&&this.vm.editCustomObject(this.selectedObject),null!=this.selectedText&&this.vm.editLevelText(this.selectedText),null!=this.selectedButton&&this.vm.editButton(this.selectedButton)},e.prototype.cloneSelectedObject=function(){var e;null!=this.selectedObject&&((e=new n.default).x=this.selectedObject.x+this.selectedObject.objectType.width,e.y=this.selectedObject.y,e.objectType=this.selectedObject.objectType,this.vm.gameParamsJson.levels[this.vm.currentLevelIndex].initialObjects.push(e),this.selectedObject=e);null!=this.selectedText&&((e=new s.default).uid=this.util.uid(),e.x=this.selectedText.x+this.selectedText.fontSize,e.y=this.selectedText.y+this.selectedText.fontSize,e.align=this.selectedText.align,e.fontFamily=this.selectedText.fontFamily,e.fontSize=this.selectedText.fontSize,e.text=this.selectedText.text,e.color=new l.default(this.selectedText.color.red,this.selectedText.color.green,this.selectedText.color.blue),this.vm.gameParamsJson.levels[this.vm.currentLevelIndex].texts.push(e),this.selectedText=e);null!=this.selectedButton&&((e=new u.default).uid=this.util.uid(),e.x=this.selectedButton.x+this.selectedButton.height,e.y=this.selectedButton.y+this.selectedButton.height,e.name=this.selectedButton.name+"(2)",e.text=this.selectedButton.text,e.borderRadius=this.selectedButton.borderRadius,e.borderSize=this.selectedButton.borderSize,e.borderSizeMouseOver=this.selectedButton.borderSizeMouseOver,e.fontSize=this.selectedButton.fontSize,e.width=this.selectedButton.width,e.height=this.selectedButton.height,e.textColor=this.selectedButton.textColor,e.borderColorMouseOver=this.selectedButton.borderColorMouseOver,e.borderColor=this.selectedButton.borderColor,e.backgroundColorMouseOver=this.selectedButton.backgroundColorMouseOver,e.backgroundColor=this.selectedButton.backgroundColor,this.vm.gameParamsJson.levels[this.vm.currentLevelIndex].buttons.push(e),this.selectedButton=e)},e.prototype.deleteSelectedElement=function(){for(var e=this.vm.gameParamsJson.levels[this.vm.currentLevelIndex],t=0;t<e.initialObjects.length;t++)if(e.initialObjects[t]==this.selectedObject)return e.initialObjects.splice(t,1),void(this.selectedObject=null);for(t=0;t<e.texts.length;t++)if(e.texts[t]==this.selectedText)return e.texts.splice(t,1),void(this.selectedText=null);for(t=0;t<e.buttons.length;t++)if(e.buttons[t]==this.selectedButton)return e.buttons.splice(t,1),void(this.selectedButton=null)},e.prototype.drawPreview=function(){this.previewCanvas=document.getElementById("previewCanvas"),null!=this.previewCanvas&&(this.ctxPreview=this.previewCanvas.getContext("2d")),null!=this.ctxPreview&&this.levelPreviewRenderer.render(this.vm.oldLevel,this.vm.gameParamsJson,this.ctxPreview,this)},e}();t.default=c},function(e,t,i){"use strict";t.__esModule=!0;var o=i(1),n=i(50),s=i(0),a=i(4),r=i(17),l=function(){function e(e,t){this.imageLoader=null,this.util=new s.default,this.renderUtil=new r.default,this.currentMousePos=null,this.offsetX=0,this.offsetY=0,this.imageLoader=new n.default(e,t)}return e.prototype.renderLevelBorder=function(e){e.save(),e.beginPath(),e.rect(this.offsetX,this.offsetY,600,500),e.strokeStyle="#333333",e.lineWidth=3,e.globalAlpha=.5,e.stroke(),e.restore()},e.prototype.renderTextDefinitionBorder=function(e,t){var i=this.util.measureText(e,t),n=e.x-i/2,s=e.y-e.fontSize/2,a=i,r=e.fontSize;"left"==e.align?n+=a/2:"right"==e.align&&(n-=a/2),t.beginPath(),t.rect(n+this.offsetX,s+this.offsetY,a,r),t.closePath(),t.strokeStyle=this.util.buildFillStyleFromColor(new o.default(0,0,255,100)),t.lineWidth=2,t.stroke()},e.prototype.renderTextBorder=function(e,t,i){if(null!=this.currentMousePos){null!=t.selectedText&&this.renderTextDefinitionBorder(t.selectedText,i);for(var n=e.texts,s=0;s<n.length;s++){var a=n[s],r=this.util.measureText(a,i),l=a.x-r/2,u=a.y-a.fontSize/2,c=r,d=a.fontSize;"left"==a.align?l+=c/2:"right"==a.align&&(l-=c/2),this.util.isInside(this.currentMousePos.x-this.offsetX,this.currentMousePos.y-this.offsetY,l,u,c,d)&&(i.beginPath(),i.rect(l+this.offsetX,u+this.offsetY,c,d),i.closePath(),i.strokeStyle=this.util.buildFillStyleFromColor(new o.default(0,0,255,50)),i.lineWidth=2,i.stroke())}}},e.prototype.renderButtonBorder=function(e,t,i){if(null!=this.currentMousePos){if(null!=t.selectedButton){var n=(c=t.selectedButton).x-c.width/2,s=c.y-c.height/2,a=c.width,r=c.height;i.beginPath(),i.rect(n+this.offsetX-2,s+this.offsetY-2,a+4,r+4),i.closePath(),i.strokeStyle=this.util.buildFillStyleFromColor(new o.default(0,0,255,100)),i.lineWidth=2,i.stroke()}for(var l=e.buttons,u=0;u<l.length;u++){var c;n=(c=l[u]).x-c.width/2,s=c.y-c.height/2,a=c.width,r=c.height;this.util.isInside(this.currentMousePos.x-this.offsetX,this.currentMousePos.y-this.offsetY,n,s,a,r)&&(i.beginPath(),i.rect(n+this.offsetX-2,s+this.offsetY-2,a+4,r+4),i.closePath(),i.strokeStyle=this.util.buildFillStyleFromColor(new o.default(0,0,255,50)),i.lineWidth=2,i.stroke())}}},e.prototype.renderObjectBorder=function(e,t,i){if(null!=this.currentMousePos){if(null!=t.selectedObject){var n=t.selectedObject.x-t.selectedObject.objectType.width/2,s=t.selectedObject.y-t.selectedObject.objectType.height/2,a=t.selectedObject.objectType.width,r=t.selectedObject.objectType.height;i.beginPath(),i.rect(n+this.offsetX,s+this.offsetY,a,r),i.closePath(),i.strokeStyle=this.util.buildFillStyleFromColor(new o.default(0,0,255,100)),i.lineWidth=2,i.stroke()}for(var l=e.initialObjects,u=0;u<l.length;u++){var c=l[u],d=c.objectType;if(null!=d){n=c.x-d.width/2,s=c.y-d.height/2,a=d.width,r=d.height;this.util.isInside(this.currentMousePos.x-this.offsetX,this.currentMousePos.y-this.offsetY,n,s,a,r)&&(i.beginPath(),i.rect(n+this.offsetX,s+this.offsetY,a,r),i.closePath(),i.strokeStyle=this.util.buildFillStyleFromColor(new o.default(0,0,255,50)),i.lineWidth=2,i.stroke())}}}},e.prototype.render=function(e,t,i,o){i.clearRect(0,0,600,500),null!=e&&null!=t&&(this.drawBackground(e,i),this.renderLevelBorder(i),this.renderObjects(e,i),this.renderTexts(e,i),this.renderButtons(i,e),this.renderObjectBorder(e,o,i),this.renderTextBorder(e,o,i),this.renderButtonBorder(e,o,i)),o.gridConfig.drawGrid&&this.renderGrid(i,o)},e.prototype.renderTexts=function(e,t){var i=e.texts;if(null!=i)for(var o=0;o<i.length;o++){var n=this.util.buildFillStyleFromColor(i[o].color),s=i[o].fontSize+"px "+i[o].fontFamily;this.util.drawText(t,i[o].text,i[o].x+this.offsetX,i[o].y+this.offsetY,s,n,i[o].align,"middle")}},e.prototype.renderObjects=function(e,t){for(var i=e.initialObjects,o=0;o<i.length;o++){var n=i[o],s=n.objectType;if(null!=s){var a=this.imageLoader.loadAndGetImage(s.image.imageId);null!=a&&t.drawImage(a,n.x-s.width/2+this.offsetX,n.y-s.height/2+this.offsetY,s.width,s.height)}}},e.prototype.renderGrid=function(e,t){e.strokeStyle="#999999",e.lineWidth=1,e.globalAlpha=.5;for(var i=t.gridConfig.gridWidth,o=t.gridConfig.gridHeight,n=(this.offsetX+t.gridConfig.gridOriginX)%i,s=(this.offsetY+t.gridConfig.gridOriginY)%o,a=n+i+600,r=s+o+500,l=n;l<a;l+=i)e.beginPath(),e.moveTo(l+.5,.5),e.lineTo(l+.5,500.5),e.stroke();for(var u=s;u<r;u+=o)e.beginPath(),e.moveTo(.5,u+.5),e.lineTo(600.5,u+.5),e.stroke();e.globalAlpha=1},e.prototype.drawBackground=function(e,t){if(e.backgroundType==a.default.SOLID_COLOR){var i=e.backgroundColor;return t.fillStyle=this.util.buildFillStyleFromColor(i),void t.fillRect(0,0,600,500)}var o=this.imageLoader.loadAndGetImage(e.backgroundImage.imageId);if(null!=o){var n=this.offsetX%64,s=this.offsetY%64;s>0&&(s-=64),n>0&&(n-=64);for(var r=n,l=s;l<564;){for(;r<664;)t.drawImage(o,r,l,64,64),r+=63;r=n,l+=63}}},e.prototype.renderButtons=function(e,t){for(var i=0;i<t.buttons.length;i++){var o=t.buttons[i];this.renderButton(e,o)}},e.prototype.renderButton=function(e,t){e.fillStyle=this.util.buildFillStyleFromColor(t.backgroundColor),e.strokeStyle=this.util.buildFillStyleFromColor(t.borderColor),e.lineWidth=t.borderSize;var i=t.borderRadius,o=t.fontSize+"px Arial",n=this.util.buildFillStyleFromColor(t.textColor);this.renderUtil.drawRoundRect(e,t.x-t.width/2+this.offsetX,t.y-t.height/2+this.offsetY,t.width,t.height,i,!0,!0),this.util.drawText(e,t.text,t.x+this.offsetX,t.y+1+this.offsetY,o,n,"center","middle")},e}();t.default=l},function(e,t,i){"use strict";t.__esModule=!0;var o=i(0),n=function(){function e(e,t){this.imageIds=new Set,this.images=new Map,this.numImagesLoaded=0,this.resourcesBaseUrl=null,this.actionTemplateController=null,this.util=new o.default,this.resourcesBaseUrl=e,this.actionTemplateController=t}return e.prototype.loadImage=function(e,t){if(this.imageIds.has(e))null!=t&&t();else{this.imageIds.add(e);var i=this,o=new Image;if(o.onload=function(){i.numImagesLoaded++,null!=t&&t()},e.startsWith("custom:")){var n=e.substring(7),s=this.util.findElementByUid(this.actionTemplateController.gameParamsJson.customImages,n);o.src=s.imageData}else o.src=this.resourcesBaseUrl+e;this.images.set(e,o)}},e.prototype.loadImages=function(e,t){if(0!=e.size)for(var i=Array.from(e),o=0;o<i.length;o++){var n=i[o];this.loadImage(n,t)}else t()},e.prototype.getImage=function(e){return this.images.get(e)},e.prototype.loadAndGetImage=function(e){return this.loadImage(e,null),this.images.get(e)},e}();t.default=n},function(e,t,i){"use strict";t.__esModule=!0;var o=function(){this.drawGrid=!0,this.snapToGrid=!1,this.gridWidth=20,this.gridHeight=20,this.gridOriginX=0,this.gridOriginY=0};t.default=o},function(e,t,i){"use strict";t.__esModule=!0;var o=function(){};t.default=o}]);